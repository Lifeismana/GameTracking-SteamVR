/*!
 * (c) Valve Corporation. Use is governed by the terms of the Steam Subscriber Agreement http://store.steampowered.com/subscriber_agreement/. 
 * 
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"6YgL":function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var i=n("mrSG"),o=n("q1tI"),s=n("7wIv"),r=n("CzjV"),l=n("EUJ1"),a=n("nAcY"),c=n("hcOo");class d extends o.Component{constructor(){super(...arguments),this.m_ref=o.createRef()}get elem(){return this.m_ref.current}onClick(e){VRHTML.Environment()==l.VRHTMLEnvironment.Overlay&&(p.temporarilySuppressSoundEffect(),r.b.Instance.playSound(r.a.PanoramaButtonClick)),this.props.onClick&&this.props.onClick(e)}onMouseEnter(e){VRHTML.Environment()==l.VRHTMLEnvironment.Overlay&&a.b.Instance.triggerHaptic(a.a.ButtonEnter),this.props.onMouseEnter&&this.props.onMouseEnter(e)}onMouseLeave(e){VRHTML.Environment()==l.VRHTMLEnvironment.Overlay&&a.b.Instance.triggerHaptic(a.a.ButtonLeave),this.props.onMouseLeave&&this.props.onMouseLeave(e)}render(){const e=!1===this.props.enabled;let t=Object.assign({},this.props);return delete t.enabled,t.className=Object(c.a)(t.className,["Disabled",e]),o.cloneElement(o.createElement("div",t,this.props.children),{onClick:e?null:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,ref:this.m_ref})}}Object(i.b)([s.bind],d.prototype,"onClick",null),Object(i.b)([s.bind],d.prototype,"onMouseEnter",null),Object(i.b)([s.bind],d.prototype,"onMouseLeave",null);class p extends o.Component{static temporarilySuppressSoundEffect(){window.clearTimeout(this.s_nPlaySoundEffectTimeout),this.s_nPlaySoundEffectTimeout=0,window.clearTimeout(this.s_nSuppressingSoundEffectsTimeout),this.s_nSuppressingSoundEffectsTimeout=window.setTimeout(this.endSoundEffectSuppression,this.k_nSoundEffectSuppressionPeriod)}static get suppressingSoundEffect(){return this.s_nSuppressingSoundEffectsTimeout>0}onClick(e){p.suppressingSoundEffect||(window.clearTimeout(p.s_nPlaySoundEffectTimeout),p.s_nPlaySoundEffectTimeout=window.setTimeout(p.playSoundEffect,p.k_nSoundEffectDelay)),this.props.onClick&&this.props.onClick(e)}static endSoundEffectSuppression(){window.clearTimeout(this.s_nSuppressingSoundEffectsTimeout),this.s_nSuppressingSoundEffectsTimeout=0}static playSoundEffect(){VRHTML.Environment()===l.VRHTMLEnvironment.Overlay&&r.b.Instance.playSound(r.a.PanoramaSurfaceClick)}render(){return o.cloneElement(o.createElement("div",this.props,this.props.children),{onClick:this.onClick})}}p.k_nSoundEffectSuppressionPeriod=4,p.k_nSoundEffectDelay=2,p.s_nSuppressingSoundEffectsTimeout=0,p.s_nPlaySoundEffectTimeout=0,Object(i.b)([s.bind],p.prototype,"onClick",null),Object(i.b)([s.bind],p,"endSoundEffectSuppression",null),Object(i.b)([s.bind],p,"playSoundEffect",null)},"7uy8":function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"j",(function(){return o})),n.d(t,"n",(function(){return s})),n.d(t,"p",(function(){return r})),n.d(t,"h",(function(){return l})),n.d(t,"k",(function(){return a})),n.d(t,"l",(function(){return c})),n.d(t,"o",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"e",(function(){return u})),n.d(t,"q",(function(){return h})),n.d(t,"r",(function(){return S})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return _})),n.d(t,"g",(function(){return f})),n.d(t,"i",(function(){return y}));const i="openvr.tool.steamvr_environments",o="system.generated.steam.exe",s="steam.app.250820",r="steam.app.330050",l="system.settings",a="valve.steam.bigpicture",c="valve.steam.desktop",d="system.desktop",p="valve.steam",u="/settings/steamvr/enableHomeApp",h="/settings/steamvr/supersampleManualOverride",S="/settings/steamvr/supersampleScale",m="/settings/camera/cameraRoomViewMode",g="/settings/steamvr/backgroundCameraHeight",b="/settings/steamvr/backgroundDomeRadius",_="/settings/steamvr/analogGain",f="/settings/driver_lighthouse/indexHmdColumnCorrection",y="/settings/steamvr/showAdvancedSettings"},CzjV:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),function(e){e[e.PanoramaButtonClick=0]="PanoramaButtonClick",e[e.PanoramaSurfaceClick=1]="PanoramaSurfaceClick",e[e.VolumePreview=2]="VolumePreview"}(i||(i={}));class o{constructor(){this.m_mapSoundElems=new Map}static get Instance(){return o.s_Instance||(o.s_Instance=new o),o.s_Instance}getSoundEffectPath(e){switch(e){case i.PanoramaButtonClick:return"/dashboard/sounds/activation.wav";case i.PanoramaSurfaceClick:return"/dashboard/sounds/activation_change_fail.wav";case i.VolumePreview:return"/dashboard/sounds/volume_change.wav"}}playSound(e){if(!this.m_mapSoundElems.has(e)){let t=document.createElement("audio");t.src=this.getSoundEffectPath(e),this.m_mapSoundElems.set(e,t)}const t=this.m_mapSoundElems.get(e);t.pause(),t.currentTime=0,t.play()}}o.s_Instance=null},DwIg:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var i=n("mrSG"),o=n("q1tI"),s=n("PShe"),r=n.n(s),l=(n("Wmp0"),n("7wIv"));class a{constructor(e,t,n){this.sValue=e,this.sLocalized=t,this.sRequiredLocalized=n}}class c extends o.Component{constructor(e){super(e),this.state={sSelectedOption:this.props.sValueSelectedItem,bVisible:!1}}componentWillMount(){null!=this.props.bShowOptionsOnStart&&this.setState({bVisible:this.props.bShowOptionsOnStart})}componentWillReceiveProps(e){null!=e.bShowOptionsOnStart&&e.bShowOptionsOnStart!=this.props.bShowOptionsOnStart&&this.setState({bVisible:e.bShowOptionsOnStart})}Show(e){this.setState({bVisible:!0}),e.stopPropagation()}Hide(e){this.setState({bVisible:!1}),e&&e.stopPropagation()}OnOptionChanged(e,t){this.setState({sSelectedOption:t}),this.props.fnOptionSelected(t),this.Hide(e)}render(){let e=this.props.vecOptions.map((e,t)=>{if("-"==e.sValue)return o.createElement("div",{key:t,className:"InlineSeparator"});if("-blank"==e.sValue)return o.createElement("div",{key:t,className:"InlineBlankSeparator"},e.sLocalized);if("-nonitem"==e.sValue)return o.createElement("div",{key:t,className:"InlineNonItemSeparator"},e.sLocalized);if("-subHeader"==e.sValue)return o.createElement("div",{key:t,className:"InlineSubHeaderSeparator"},e.sLocalized);{let n,i="InlineDropdownItem";return this.props.sValueSelectedItem==e.sValue&&(i+=" Selected"),null!=e.sRequiredLocalized&&(n=o.createElement("span",{className:"BindingLabelActionRequirement"},e.sRequiredLocalized)),o.createElement("div",{key:t,className:i,onClick:t=>{this.OnOptionChanged(t,e.sValue)}},e.sLocalized,n)}}),t="InlineDropdownLabel "+(null==this.props.sHeaderClass?"":this.props.sHeaderClass),n="InlineOptionsDropDownRodal "+(null==this.props.sModalClass?"":this.props.sModalClass);let i=this.props.sLocalizedSelectedItem;!i&&this.state.sSelectedOption&&this.props.vecOptions.forEach(e=>{e.sValue==this.state.sSelectedOption&&(i=e.sLocalized)});let s=this.props.bReadOnly?()=>{}:this.Show;return o.createElement("div",{className:t,onClick:s},i&&o.createElement("div",{className:this.props.sMainButtonClass},i),o.createElement(r.a,{visible:this.state.bVisible,onClose:this.Hide,customStyles:{width:"60%",height:"fit-content",maxHeight:"90%",display:"flex"},showCloseButton:!1,animation:"fade",className:n,closeOnEsc:!0},this.state.bVisible&&o.createElement("div",{className:"FlexColumn InlineDropdownModalWrapper"},this.props.sModalTitleString&&o.createElement("div",{className:"Label ModalHeader"},this.props.sModalTitleString),o.createElement("div",{className:"FlexColumn InlineDropdownItemWrapper"},e))))}}Object(i.b)([l.bind],c.prototype,"Show",null),Object(i.b)([l.bind],c.prototype,"Hide",null),Object(i.b)([l.bind],c.prototype,"OnOptionChanged",null)},GXif:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return a}));n("q1tI");var i=n("vDqi"),o=n.n(i);class s{constructor(){this.m_mapTokens=new Map,this.m_mapFallbackTokens=new Map}InitFromObjects(e,t,n,i){this.m_mapTokens.clear();let o=[t,e,i,n];for(let e in o){let t=o[e];for(let e in t){let n=t[e];for(let e in n){let t=e.toLowerCase();this.m_mapTokens.has(t)||this.m_mapTokens.set(t,n[e])}}}}LocalizeString(e){if(!e||0==e.length||"#"!=e.charAt(0))return"";let t=this.m_mapTokens.get(e.substring(1).toLowerCase());return void 0===t?"":t}LocalizeStringFromFallback(e){if(!e||0==e.length||"#"!=e.charAt(0))return"";let t=this.m_mapFallbackTokens.get(e.substring(1).toLowerCase());return void 0===t?"":t}static GetLocale(){const e=navigator.languages[0];try{const t=VRHTML.IsAvailable()?VRHTML.GetSystemLocale():null;if(null==t)return e;s.s_Date.toLocaleTimeString(t);return t}catch(t){return e}}}function r(e,...t){let n=l.LocalizeString(e);return n?(t.length>0&&(n=n.replace(/%(\d+)\$s/g,(function(e,n){return void 0!==t[n-1]?String(t[n-1]):e}))),n):e}s.s_Date=new Date;const l=new s;function a(e,t){null==t&&(t=function(){let e=new Map([["en","english"],["de","german"],["fr","french"],["it","italian"],["ko","korean"],["es-419","latam"],["es","spanish"],["zh-CN","schinese"],["zh-TW","tchinese"],["ru","russian"],["th","thai"],["ja","japanese"],["pt","portuguese"],["pl","polish"],["da","danish"],["nl","dutch"],["fi","finnish"],["no","norwegian"],["sv","swedish"],["hu","hungarian"],["cs","czech"],["ro","romanian"],["tr","turkish"],["pt-BR","brazilian"],["bg","bulgarian"],["el","greek"],["uk","ukranian"],["vi","vietnamese"]]);for(let t of navigator.languages){let n=t.split("-");if(e.has(t))return e.get(t);if(e.has(n[0]))return e.get(n[0])}return"english"}());let n=[],i=(e,t,n)=>{let i,s=Date.now().toString();return i="webhelper"==e?`/dashboard/localization/${e}_${t}.json?t=${s}`:`localization/${e}_${t}.json?t=${s}`,o.a.get(i).then(e=>{n(e.data)}).catch(()=>{})},s=[],r=[],a=[],c=[];for(let o of e)n.push(i(o,t,e=>{s.push(e)})),"english"!=t&&n.push(i(o,"english",e=>{a.push(e)}));for(let e of["webhelper"])n.push(i(e,t,e=>{r.push(e)})),"english"!=t&&n.push(i(e,"english",e=>{c.push(e)}));return Promise.all(n).then(()=>{l.InitFromObjects(s,r,a,c)})}window.LocalizationManager=l},GxMB:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var i=n("mrSG"),o=n("q1tI"),s=n("i8i4"),r=n("6YgL"),l=n("hcOo"),a=n("7wIv"),c=n.n(a),d=n("2vnA"),p=n("GXif");class u extends o.Component{constructor(e){super(e),this.m_elemBoundingParent=window.document.body,this.m_elemDropdownsContainer=null,this.m_elemDropdownPortal=null,this.m_refButton=o.createRef(),this.m_refPopover=o.createRef(),this.m_refSelectedButton=o.createRef(),this.m_rScrollableParents=[],this.state={bShowingOptions:!1},this.m_elemDropdownPortal=document.createElement("div"),this.m_elemDropdownPortal.classList.add(u.ELEM_CLASS)}get dropdownsContainer(){return this.m_refButton.current?(null===this.m_elemDropdownsContainer&&(this.m_elemDropdownsContainer=Object(l.b)(["body",".SettingsMain","vsg-app","vsg-mountable","vsg-panel"],this.m_refButton.current.elem)),this.m_elemDropdownsContainer):null}componentDidMount(){this.m_elemBoundingParent=Object(l.b)(["body","vsg-panel",".SettingsSidebarPageContainer"],this.m_refButton.current.elem),this.dropdownsContainer.appendChild(this.m_elemDropdownPortal),window.addEventListener("keydown",this.onWindowKeyDown),window.addEventListener("click",this.onWindowClick)}componentWillUnmount(){this.dropdownsContainer.removeChild(this.m_elemDropdownPortal),window.removeEventListener("keydown",this.onWindowKeyDown),window.removeEventListener("click",this.onWindowClick);for(let e of this.m_rScrollableParents)e.removeEventListener("scroll",this.onParentScroll)}componentDidUpdate(e,t){if(this.state.bShowingOptions&&!t.bShowingOptions){this.updateScrollableParents();const e=this.m_refButton.current.elem.getBoundingClientRect();let t=e.left,n=e.top;const i=this.m_refPopover.current.getBoundingClientRect(),o=this.m_elemBoundingParent.getBoundingClientRect(),s=o.left+u.POPOVER_BOUNDS_MARGIN,r=o.right-u.POPOVER_BOUNDS_MARGIN,l=o.top+u.POPOVER_BOUNDS_MARGIN,a=o.bottom-u.POPOVER_BOUNDS_MARGIN;if(this.m_refSelectedButton.current){n-=this.m_refSelectedButton.current.elem.getBoundingClientRect().top-i.top}const c=n;t<s&&(t=s),t+i.width>r&&(t=r-i.width),n<l&&(n=l),n+i.height>a&&(n=a-i.height),t=Math.round(t),n=Math.round(n),this.m_refPopover.current.scrollTop=n-c,this.m_refPopover.current.style.transform="translateX("+t+"px) translateY("+n+"px)",u.currentDropdown=this}else!this.state.bShowingOptions&&t.bShowingOptions&&u.currentDropdown==this&&(u.currentDropdown=null)}onWindowKeyDown(e){"Escape"==e.key&&this.hideDropdown()}onWindowClick(e){!this.m_refPopover.current||this.m_refPopover.current.contains(e.target)||this.m_refButton.current.elem.contains(e.target)||this.hideDropdown()}updateScrollableParents(){for(let e of this.m_rScrollableParents)e.removeEventListener("scroll",this.onParentScroll);this.m_rScrollableParents=Object(l.d)(this.m_refButton.current.elem);for(let e of this.m_rScrollableParents)e.addEventListener("scroll",this.onParentScroll)}onParentScroll(){this.hideDropdown()}setValue(e){this.props.onChange&&this.props.onChange(e),this.hideDropdown()}get value(){return void 0!==this.props.value?this.props.value:null}get selectedItem(){const e=this.value;for(let t of this.props.items)if(t.value==e)return t;return null}showDropdown(){this.setState({bShowingOptions:!0})}hideDropdown(){this.setState({bShowingOptions:!1})}render(){const e=this.selectedItem,t=void 0!==this.props.defaultLabel?this.props.defaultLabel:Object(p.c)("#Settings_SelectAnOption"),n=e?e.sLabel:t,i=this.m_refButton.current?this.m_refButton.current.elem.clientWidth:0,a=this.m_elemBoundingParent.getBoundingClientRect();return o.createElement(o.Fragment,null,o.createElement(r.a,{ref:this.m_refButton,className:"ButtonControl Dropdown",onClick:this.showDropdown,style:{pointerEvents:this.state.bShowingOptions?"none":"initial"}},o.createElement("span",null,n)),this.state.bShowingOptions&&s.createPortal(o.createElement("div",{ref:this.m_refPopover,className:"Dropdown Popover",style:{minWidth:i,maxWidth:a.width-2*u.POPOVER_BOUNDS_MARGIN,maxHeight:a.height-2*u.POPOVER_BOUNDS_MARGIN}},this.props.items.map(e=>o.createElement(r.a,{key:e.value.toString(),ref:e==this.selectedItem?this.m_refSelectedButton:null,className:Object(l.a)("DropdownPopoverButton",["Selected",e==this.selectedItem]),onClick:()=>this.setValue(e.value)},e.sLabel))),this.m_elemDropdownPortal))}}u.currentDropdown=null,u.ELEM_CLASS="v-dropdown-portal",u.POPOVER_BOUNDS_MARGIN=10,Object(i.b)([c.a],u.prototype,"onWindowKeyDown",null),Object(i.b)([c.a],u.prototype,"onWindowClick",null),Object(i.b)([c.a],u.prototype,"onParentScroll",null),Object(i.b)([c.a],u.prototype,"setValue",null),Object(i.b)([d.f],u.prototype,"value",null),Object(i.b)([d.f],u.prototype,"selectedItem",null),Object(i.b)([c.a],u.prototype,"showDropdown",null),Object(i.b)([c.a],u.prototype,"hideDropdown",null),Object(i.b)([d.m],u,"currentDropdown",void 0);class h extends o.Component{constructor(e){super(e),this.state={value:void 0===e.value?null:e.value}}onChange(e){this.setState({value:e}),this.props.onChange&&this.props.onChange(e)}render(){let e=Object.assign({},this.props);return e.onChange=this.onChange,e.value=this.state.value,o.createElement(u,Object.assign({},e))}}Object(i.b)([c.a],h.prototype,"onChange",null)},Kysl:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA");class a{constructor(){this.m_Applications=l.m.map(),this.m_sceneApplicationStateChangedEventHandle=null}Init(){return Object(i.a)(this,void 0,void 0,(function*(){VRHTML.IsAvailable()&&(this.m_sceneApplicationStateChangedEventHandle=VRHTML.RegisterForSceneApplicationStateChangedEvents(this.onSceneApplicationStateChanged)),yield this.UpdateApplications()}))}onSceneApplicationStateChanged(){this.UpdateApplications()}SetApplicationMap(e){this.m_Applications.clear(),e.apps.forEach(e=>{this.m_Applications.set(e.key,e)})}UpdateApplications(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.QueryApplications().then(e=>{this.SetApplicationMap(e)})}))}QueryApplications(){return new Promise((function(e,t){r.a.get("/app/list.json").then(t=>{e(t.data)}).catch(e=>{t(e)})}))}GetAppImageURL(e){let t="/app/image?app_key="+e;return VRHTML.IsAvailable()&&(t+="&version="+VRHTML.SteamVRVersion()),t}GetApp(e){return this.m_Applications.has(e)?this.m_Applications.get(e):void 0}GetRecentApps(){let e=[];return this.m_Applications.forEach(t=>{t.is_internal||e.push(t)}),e.sort((e,t)=>e.last_launch<t.last_launch?1:e.last_launch>t.last_launch?-1:e.name<t.name?1:e.name>t.name?-1:0),e}GetCurrentSceneProcess(){let e=void 0;return this.m_Applications.forEach(t=>{t.current_scene_process&&!t.is_internal&&(e=t)}),e}IsAppAllowedPrivateInputs(e){return"openvr.component.vrcompositor"==e}ShouldShowBindingFailureForApp(e){if(null==e||""==e)return!1;if("openvr.component.vrcompositor"==e)return!0;if(null==this.GetApp(e))return!1;let t=this.GetCurrentSceneProcess();return null!=t&&t.key==e}}Object(i.b)([l.m],a.prototype,"m_Applications",void 0),Object(i.b)([o.bind],a.prototype,"onSceneApplicationStateChanged",null),Object(i.b)([l.d],a.prototype,"SetApplicationMap",null),Object(i.b)([o.bind],a.prototype,"QueryApplications",null),Object(i.b)([o.bind],a.prototype,"GetAppImageURL",null),Object(i.b)([o.bind],a.prototype,"GetApp",null),Object(i.b)([o.bind],a.prototype,"GetRecentApps",null),Object(i.b)([o.bind],a.prototype,"GetCurrentSceneProcess",null),Object(i.b)([o.bind],a.prototype,"IsAppAllowedPrivateInputs",null),Object(i.b)([o.bind],a.prototype,"ShouldShowBindingFailureForApp",null);const c=new a;window.applications=c},MYgy:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return v})),n.d(t,"f",(function(){return I})),n.d(t,"d",(function(){return k})),n.d(t,"e",(function(){return B})),n.d(t,"a",(function(){return P}));var i,o,s,r=n("mrSG"),l=n("7wIv"),a=n("vDqi"),c=n.n(a),d=n("2vnA"),p=n("GXif"),u=n("EUJ1"),h=n.n(u),S=n("pYJh"),m=n("Kysl"),g=n("uFkT");class b{}Object(r.b)([d.m],b.prototype,"path",void 0),Object(r.b)([d.m],b.prototype,"mode",void 0),Object(r.b)([d.m],b.prototype,"parameters",void 0),Object(r.b)([d.m],b.prototype,"inputs",void 0);class _{}Object(r.b)([d.m],_.prototype,"path",void 0),Object(r.b)([d.m],_.prototype,"output",void 0);class f{}Object(r.b)([d.m],f.prototype,"path",void 0),Object(r.b)([d.m],f.prototype,"output",void 0);class y{}Object(r.b)([d.m],y.prototype,"path",void 0),Object(r.b)([d.m],y.prototype,"output",void 0);class O{}Object(r.b)([d.m],O.prototype,"output",void 0),Object(r.b)([d.m],O.prototype,"inputs",void 0);class A{}Object(r.b)([d.m],A.prototype,"chords",void 0),Object(r.b)([d.m],A.prototype,"poses",void 0),Object(r.b)([d.m],A.prototype,"haptics",void 0),Object(r.b)([d.m],A.prototype,"sources",void 0),Object(r.b)([d.m],A.prototype,"skeleton",void 0),function(e){e[e.eButtonSide_None=0]="eButtonSide_None",e[e.eButtonSide_Left=1]="eButtonSide_Left",e[e.eButtonSide_Right=2]="eButtonSide_Right"}(i||(i={})),function(e){e.eTrackPadInvert_None="",e.eTrackPadInvert_X="x",e.eTrackPadInvert_Y="y",e.eTrackPadInvert_XY="xy"}(o||(o={}));class v{constructor(){this.vecRequired=[],this.vecSuggested=[]}}class w{}Object(r.b)([d.m],w.prototype,"device_path_string",void 0),Object(r.b)([d.m],w.prototype,"device_path_handle",void 0),Object(r.b)([d.m],w.prototype,"role",void 0),Object(r.b)([d.m],w.prototype,"controller_role",void 0);class C{}function I(e){return new Promise((function(t,n){c.a.get("/input/getactions.json?app_key="+e).then(n=>{console.log("Loaded action manifest for ",e),t(n.data)}).catch(e=>{n(e)})}))}function k(e,t,n){return Object(r.a)(this,void 0,void 0,(function*(){let i=(yield c.a.get("/input/loadbindingfromurl.json?binding_url="+encodeURI(n)+"&controller_type="+encodeURI(t)+"&app_key="+encodeURI(e))).data;if(i.success)return i;throw new Error(i.error)}))}Object(r.b)([d.m],C.prototype,"trackers",void 0),Object(r.b)([d.m],C.prototype,"valid_roles",void 0);class B{constructor(e,t){this.x=e,this.y=t,this.toString.bind(this)}toString(){return this.x+","+this.y}}class j{constructor(e,t,n,i,o){this.m_BindingUISource=void 0,this.m_ControllerProfile=void 0,this.m_sDeviceInputPath=void 0,this.m_eButtonSide=void 0,this.m_sInputPath=void 0,this.m_sActionSet=void 0,this.m_BindingStoreObserverDisposer=void 0,this.m_iNewSourceEntry=-1,this.m_sDeviceInputPath=e,this.m_ControllerProfile=t,this.m_eButtonSide=n,this.m_sInputPath=i,this.m_sActionSet=o,this.m_BindingStoreObserverDisposer=Object(d.n)(P,e=>{"m_LoadedBinding"==e.name&&this.UpdateBindingSource()}),this.UpdateBindingSource(),P.RegisterBindingWatcher(this.UpdateBindingSource.bind(this))}cancelWatcher(){this.m_BindingStoreObserverDisposer(),P.UnregisterBindingWatcher(this.UpdateBindingSource)}UpdateBindingSource(){this.m_BindingUISource=P.GetActionBinding(this.GetFullInputPath,this.m_sActionSet)}get GetFullInputPath(){let e=this.m_sDeviceInputPath+this.m_sInputPath;return e=e.replace(/([^:]\/)\/+/g,"$1")}GetSVGEndPoint(){return new B(this.m_ControllerProfile.input_source[this.m_sInputPath].binding_image_point[0],this.m_ControllerProfile.input_source[this.m_sInputPath].binding_image_point[1])}get GetButtonSide(){return this.m_eButtonSide}get GetNumModes(){return this.m_BindingUISource?this.m_BindingUISource.length:0}GetActionForInputType(e,t){if(this.m_BindingUISource&&this.m_BindingUISource[e].inputs&&this.m_BindingUISource[e].inputs.has(t)){let n=this.m_BindingUISource[e].inputs.get(t).output,i=P.GetActionByName(n);if(!i){let e=P.GetSimulatedActionByPath(n);e&&(i=P.CreateActionDefinitionForSimulatedAction(e))}let o=P.GetAliasInfo(n);return i&&o&&o.alias_name&&((i=Object.assign({},i)).localized_name=o.alias_name),i}}GetClickAction(e){return this.GetActionForInputType(e,"click")}GetTouchAction(e){return this.GetActionForInputType(e,"touch")}GetPositionAction(e){return this.GetActionForInputType(e,"position")}GetHeldAction(e){return this.GetActionForInputType(e,"held")}GetLongAction(e){return this.GetActionForInputType(e,"long")}GetSingleAction(e){return this.GetActionForInputType(e,"single")}GetDoubleAction(e){return this.GetActionForInputType(e,"double")}GetNorthAction(e){return this.GetActionForInputType(e,"north")}GetEastAction(e){return this.GetActionForInputType(e,"east")}GetSouthAction(e){return this.GetActionForInputType(e,"south")}GetWestAction(e){return this.GetActionForInputType(e,"west")}GetCenterAction(e){return this.GetActionForInputType(e,"center")}GetScrollAction(e){return this.GetActionForInputType(e,"scroll")}GetPullAction(e){return this.GetActionForInputType(e,"pull")}GetForceAction(e){return this.GetActionForInputType(e,"force")}GetGrabAction(e){return this.GetActionForInputType(e,"grab")}GetValueAction(e){return this.GetActionForInputType(e,"value")}get GetControllerInputName(){return g.a.LocalizeDriverString(this.m_ControllerProfile.resource_root,this.m_sInputPath)}get GetModes(){return this.m_BindingUISource?this.m_BindingUISource:[]}GetMode(e){return this.m_BindingUISource&&e>=0&&e<this.m_BindingUISource.length?this.m_BindingUISource[e].mode:"none"}get GetInputSourceType(){return this.m_ControllerProfile.input_source[this.m_sInputPath].type}get GetInputSource(){return this.m_ControllerProfile.input_source[this.m_sInputPath]}get GetInputSourceClickSupport(){return!(this.m_ControllerProfile.input_source[this.m_sInputPath].force&&!this.m_ControllerProfile.input_source[this.m_sInputPath].click)&&(("knuckles"!=this.m_ControllerProfile.controller_type||"/input/trackpad"!=this.m_sInputPath)&&(!(!this.m_ControllerProfile.input_source[this.m_sInputPath].click&&!this.m_ControllerProfile.input_source[this.m_sInputPath].touch)&&(this.m_ControllerProfile.input_source[this.m_sInputPath].click||this.m_ControllerProfile.input_source[this.m_sInputPath].touch)))}get GetInputSourceTouchSupport(){return!(!this.m_ControllerProfile.input_source[this.m_sInputPath].touch&&!this.m_ControllerProfile.input_source[this.m_sInputPath].proximity)&&(this.m_ControllerProfile.input_source[this.m_sInputPath].touch||this.m_ControllerProfile.input_source[this.m_sInputPath].proximity)}get GetInputSourceForceSupport(){return!!this.m_ControllerProfile.input_source[this.m_sInputPath].force&&this.m_ControllerProfile.input_source[this.m_sInputPath].force}get GetInputSourceDefaultDeadzone(){return this.m_ControllerProfile.input_source[this.m_sInputPath].default_dead_zone_pct?this.m_ControllerProfile.input_source[this.m_sInputPath].default_dead_zone_pct:0}SetInputMode(e,t){!this.m_BindingUISource||t<0||t>=this.m_BindingUISource.length?console.error("SetInputMode: Invalid mode index for new mode"):(this.ClearNewModeIfSet(t),P.SetInputModeForInputSource(this.GetFullInputPath,t,e))}AddInputMode(e){this.m_iNewSourceEntry=P.AddInputModeForSource(this.GetFullInputPath,e)}DeleteInputMode(e){!this.m_BindingUISource||e<0||e>=this.m_BindingUISource.length?console.error("SetInputMode: Invalid mode index for new mode"):P.DeleteInputModeForSource(this.GetFullInputPath,e)}ClearNewModeIfSet(e){-1!=this.m_iNewSourceEntry&&this.m_iNewSourceEntry==e&&(this.m_iNewSourceEntry=-1)}BHasModeSelectionPending(e){return-1!=this.m_iNewSourceEntry&&this.m_iNewSourceEntry==e}SetClickAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"click",t,["button","trackpad","joystick","trigger","toggle_button","complex_button"])}SetTouchAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"touch",t,["button","trackpad","joystick","trigger","toggle_button","complex_button"])}SetHeldAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"held",t,["button","complex_button"])}SetLongAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"long",t,["button","complex_button"])}SetSingleAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"single",t,["button","complex_button"])}SetDoubleAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"double",t,["button","complex_button"])}SetPositionAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"position",t,["trackpad","joystick"])}SetNorthAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"north",t,["dpad","dpad_click","dpad_touch"])}SetEastAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"east",t,["dpad","dpad_click","dpad_touch"])}SetSouthAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"south",t,["dpad","dpad_click","dpad_touch"])}SetWestAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"west",t,["dpad","dpad_click","dpad_touch"])}SetCenterAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"center",t,["dpad","dpad_click","dpad_touch"])}SetScrollAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"scroll",t,["scroll"])}SetPullAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"pull",t,["trigger"])}SetForceAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"force",t,["force_sensor"])}SetGrabAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"grab",t,["grab"])}SetValueAction(e,t){P.SetActionForInputModeType(this.GetFullInputPath,e,"value",t,["scalar_constant"])}CopyActions(e){P.ClearModesForInputPath(this.GetFullInputPath),e.GetModes.map((e,t)=>{P.AddInputModeForSource(this.GetFullInputPath,e.mode),e.inputs.forEach((e,n)=>{P.SetActionForInputModeType(this.GetFullInputPath,t,n,e.output,[])})})}BindingsMatch(e){let t=e.GetModes;if(this.GetModes.length!=t.length)return!1;for(let e=0;e<t.length;e++){let n=t[e],i=this.GetModes.filter(e=>e.mode==n.mode);if(i.length>0){let e=!0;return i[0].inputs.forEach((t,i)=>{n.inputs.has(i)&&n.inputs.get(i).output==t.output||(e=!1)}),e}return!1}return!0}SetClickParameter(e,t,n){P.SetParameterForInputModeType(this.GetFullInputPath,e,"click",t,n)}SetTouchParameter(e,t,n){P.SetParameterForInputModeType(this.GetFullInputPath,e,"touch",t,n)}SetParameter(e,t,n,i){P.SetParameterForInputModeType(this.GetFullInputPath,e,t,n,i)}GetClickParameter(e,t){return P.GetParameterForInputModeType(this.GetFullInputPath,e,"click",t)}GetTouchParameter(e,t){return P.GetParameterForInputModeType(this.GetFullInputPath,e,"touch",t)}GetParameter(e,t,n){return P.GetParameterForInputModeType(this.GetFullInputPath,e,t,n)}GetTrackpadInvertState(e){switch(P.GetParameterForInputModeType(this.GetFullInputPath,e,"trackpad","invert")){case"x":return o.eTrackPadInvert_X;case"y":return o.eTrackPadInvert_Y;case"xy":return o.eTrackPadInvert_XY;default:return o.eTrackPadInvert_None}}SetTrackpadInvertState(e,t){let n="";switch(t){case o.eTrackPadInvert_X:n="x";break;case o.eTrackPadInvert_Y:n="y";break;case o.eTrackPadInvert_XY:n="xy"}P.SetParameterForInputModeType(this.GetFullInputPath,e,"trackpad","invert",n)}}Object(r.b)([d.m],j.prototype,"m_BindingUISource",void 0),Object(r.b)([d.m],j.prototype,"m_ControllerProfile",void 0),Object(r.b)([d.m],j.prototype,"m_sDeviceInputPath",void 0),Object(r.b)([d.m],j.prototype,"m_eButtonSide",void 0),Object(r.b)([d.m],j.prototype,"m_sInputPath",void 0),Object(r.b)([d.m],j.prototype,"m_sActionSet",void 0),Object(r.b)([l.bind],j.prototype,"cancelWatcher",null),Object(r.b)([d.d],j.prototype,"UpdateBindingSource",null),Object(r.b)([d.f],j.prototype,"GetFullInputPath",null),Object(r.b)([l.bind],j.prototype,"GetSVGEndPoint",null),Object(r.b)([d.f],j.prototype,"GetButtonSide",null),Object(r.b)([d.f],j.prototype,"GetNumModes",null),Object(r.b)([l.bind],j.prototype,"GetActionForInputType",null),Object(r.b)([l.bind],j.prototype,"GetClickAction",null),Object(r.b)([l.bind],j.prototype,"GetTouchAction",null),Object(r.b)([l.bind],j.prototype,"GetPositionAction",null),Object(r.b)([l.bind],j.prototype,"GetHeldAction",null),Object(r.b)([l.bind],j.prototype,"GetLongAction",null),Object(r.b)([l.bind],j.prototype,"GetSingleAction",null),Object(r.b)([l.bind],j.prototype,"GetDoubleAction",null),Object(r.b)([l.bind],j.prototype,"GetNorthAction",null),Object(r.b)([l.bind],j.prototype,"GetEastAction",null),Object(r.b)([l.bind],j.prototype,"GetSouthAction",null),Object(r.b)([l.bind],j.prototype,"GetWestAction",null),Object(r.b)([l.bind],j.prototype,"GetCenterAction",null),Object(r.b)([l.bind],j.prototype,"GetScrollAction",null),Object(r.b)([l.bind],j.prototype,"GetPullAction",null),Object(r.b)([l.bind],j.prototype,"GetForceAction",null),Object(r.b)([l.bind],j.prototype,"GetGrabAction",null),Object(r.b)([l.bind],j.prototype,"GetValueAction",null),Object(r.b)([d.f],j.prototype,"GetControllerInputName",null),Object(r.b)([d.f],j.prototype,"GetModes",null),Object(r.b)([l.bind],j.prototype,"GetMode",null),Object(r.b)([d.f],j.prototype,"GetInputSourceType",null),Object(r.b)([d.f],j.prototype,"GetInputSource",null),Object(r.b)([d.f],j.prototype,"GetInputSourceClickSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceTouchSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceForceSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceDefaultDeadzone",null),Object(r.b)([d.d],j.prototype,"SetInputMode",null),Object(r.b)([d.d],j.prototype,"AddInputMode",null),Object(r.b)([d.d],j.prototype,"DeleteInputMode",null),Object(r.b)([l.bind],j.prototype,"ClearNewModeIfSet",null),Object(r.b)([l.bind],j.prototype,"BHasModeSelectionPending",null),Object(r.b)([d.d],j.prototype,"SetClickAction",null),Object(r.b)([d.d],j.prototype,"SetTouchAction",null),Object(r.b)([d.d],j.prototype,"SetHeldAction",null),Object(r.b)([d.d],j.prototype,"SetLongAction",null),Object(r.b)([d.d],j.prototype,"SetSingleAction",null),Object(r.b)([d.d],j.prototype,"SetDoubleAction",null),Object(r.b)([d.d],j.prototype,"SetPositionAction",null),Object(r.b)([d.d],j.prototype,"SetNorthAction",null),Object(r.b)([d.d],j.prototype,"SetEastAction",null),Object(r.b)([d.d],j.prototype,"SetSouthAction",null),Object(r.b)([d.d],j.prototype,"SetWestAction",null),Object(r.b)([d.d],j.prototype,"SetCenterAction",null),Object(r.b)([d.d],j.prototype,"SetScrollAction",null),Object(r.b)([d.d],j.prototype,"SetPullAction",null),Object(r.b)([d.d],j.prototype,"SetForceAction",null),Object(r.b)([d.d],j.prototype,"SetGrabAction",null),Object(r.b)([d.d],j.prototype,"SetValueAction",null),Object(r.b)([d.d],j.prototype,"CopyActions",null),Object(r.b)([l.bind],j.prototype,"BindingsMatch",null),Object(r.b)([d.d],j.prototype,"SetClickParameter",null),Object(r.b)([d.d],j.prototype,"SetTouchParameter",null),Object(r.b)([d.d],j.prototype,"SetParameter",null),Object(r.b)([d.d],j.prototype,"GetClickParameter",null),Object(r.b)([d.d],j.prototype,"GetTouchParameter",null),Object(r.b)([d.d],j.prototype,"GetParameter",null),Object(r.b)([l.bind],j.prototype,"GetTrackpadInvertState",null),Object(r.b)([d.d],j.prototype,"SetTrackpadInvertState",null);class M{constructor(e,t,n){this.m_sSaveType=e,this.m_OutstandingSaveBindingResolve=t,this.m_OutstandingSaveBindingReject=n}resolve(e){this.m_OutstandingSaveBindingResolve(e)}reject(e){this.m_OutstandingSaveBindingReject(e)}get SaveType(){return this.m_sSaveType}}Object(r.b)([l.bind],M.prototype,"resolve",null),Object(r.b)([l.bind],M.prototype,"reject",null),function(e){e[e.eWebSocketState_Unknown=0]="eWebSocketState_Unknown",e[e.eWebSocketState_Disconnected=1]="eWebSocketState_Disconnected",e[e.eWebSocketState_Connecting=2]="eWebSocketState_Connecting",e[e.eWebSocketState_Connected=3]="eWebSocketState_Connected"}(s||(s={}));class T{constructor(){this.m_wsWebSocketToServer=void 0,this.m_eWebSocketState=s.eWebSocketState_Unknown,this.m_timerWebSocket=void 0,this.m_dateStartTime=new Date,this.m_sLoadedBindingURI=void 0,this.m_LoadedBinding=void 0,this.m_ModifiedBindingSet=d.m.map(),this.m_ModifiedOptions=d.m.map(),this.m_ModifiedAliases=d.m.map(),this.m_sName=void 0,this.m_sDescription=void 0,this.m_SelectedApp=void 0,this.m_SelectedAppActions=void 0,this.m_sSelectedActionSet=void 0,this.m_sSelectedControllerType=void 0,this.m_TrackerBindingSetup=void 0,this.m_bControllerTypeSelectedByUser=!1,this.m_OutstandingSaveBindingCalls=[],this.m_vecBindingSetWatchers=Array(),this.m_mapUnoundActions=new Map,this.m_bIsMissingRequiredActions=!1,this.m_rKnownFailedBindingUris=[],this.m_ControllerWatchers=new Map,this.m_ModifiedSimulatedActions=d.m.map(),this.m_nNextSimulatedActionId=1,this.m_nBindingSubscriptionChangedCanary=1}OpenWebSocketToHost(){return new Promise((e,t)=>{this.m_eWebSocketState!=s.eWebSocketState_Connecting&&this.m_eWebSocketState!=s.eWebSocketState_Connected&&(this.m_wsWebSocketToServer&&delete this.m_wsWebSocketToServer,this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",t=>{this.OnWebSocketOpen(t),e()}),this.m_wsWebSocketToServer.addEventListener("message",e=>{this.OnWebSocketMessage(e)}),this.m_wsWebSocketToServer.addEventListener("close",e=>{this.OnWebSocketClose(e)}),this.m_eWebSocketState=s.eWebSocketState_Connecting),this.m_timerWebSocket||(this.m_timerWebSocket=window.setTimeout(this.OpenWebSocketToHost,1e3))})}Init(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.OpenWebSocketToHost(),yield this.RefreshInputState()}))}CountDevicesWithControllerType(e){let t=0;return g.a.ConnectedDevices.forEach(n=>{n.controller_type==e&&t++}),t}ComputeControllerTypeScore(e){let t=this.CountDevicesWithControllerType(e.controller_type),n=(h.a.HasHMD()?h.a.VRProperties.GetStringProperty("/user/head",u.ETrackedDeviceProperty.Prop_ExpectedControllerType_String):void 0)==e.controller_type?2:1;return 1e3*(999-e.priority)+10*t+n}GetBestControllerType(){let e,t=0;return g.a.ControllerTypes.forEach(n=>{let i=this.ComputeControllerTypeScore(n);i>t&&(e=n,t=i)}),e}RefreshInputState(){return Object(r.a)(this,void 0,void 0,(function*(){let e=g.a.KnownControllerTypes.size;return g.a.GetInputState().then(()=>{this.m_SelectedApp&&e!=g.a.KnownControllerTypes.size&&this.ReloadCurrentApp();let t=!1;const n=this.GetBestControllerType();let i=g.a.FindDeviceClassForControllerType(this.m_sSelectedControllerType);if(null!=n&&this.m_sSelectedControllerType!=n.controller_type&&!this.m_bControllerTypeSelectedByUser){let e=g.a.FindDeviceClassForControllerType(n.controller_type);S.a.IsSafeToResetControllerType(i,e)&&(this.m_sSelectedControllerType=n.controller_type,t=!0,null!=i&&S.a.RefreshBindingList())}return t?this.ReloadControllerConfiguration():null})}))}get SteamVRUnavailable(){return this.m_eWebSocketState==s.eWebSocketState_Connecting||this.m_eWebSocketState==s.eWebSocketState_Unknown?Date.now()-this.m_dateStartTime.getTime()>1e4:this.m_eWebSocketState!=s.eWebSocketState_Connected}get ActionSets(){if(null==this.m_SelectedAppActions||null==this.m_SelectedAppActions.action_sets)return[];let e=[];return this.m_SelectedAppActions.action_sets.forEach(t=>{if("hidden"!=t.usage){let n=!0;t.required_options&&t.required_options.forEach(e=>{this.GetOptionValue(e)||(n=!1)});let i=!1;t.forbidden_options&&t.forbidden_options.forEach(e=>{this.GetOptionValue(e)&&(i=!0)}),n&&!i&&e.push(t)}}),e}get ManifestOptions(){return null==this.m_SelectedAppActions||null==this.m_SelectedAppActions.action_sets||null==this.m_SelectedAppActions.options?[]:this.m_SelectedAppActions.options}get SecondaryControllerOptions(){return[{name:"returnBindingsWithLeftHand",localized_name:Object(p.c)("#SecondaryController_ReturnWithLeftHand"),type:"bool",default:!1},{name:"returnBindingsWithRightHand",localized_name:Object(p.c)("#SecondaryController_ReturnWithRightHand"),type:"bool",default:!1},{name:"returnBindingsWithHead",localized_name:Object(p.c)("#SecondaryController_ReturnWithHead"),type:"bool",default:!1}]}GetOptionDefault(e){let t=!1;return this.ManifestOptions.forEach(n=>{n.name==e&&(t=n.default)}),t}GetOptionValue(e){return this.m_ModifiedOptions.has(e)?this.m_ModifiedOptions.get(e):void 0}SetOptionValue(e,t){this.m_ModifiedOptions.set(e,t),this.NotifyWatchersOfChange()}GetAliasInfo(e){return this.m_ModifiedAliases.has(e)?this.m_ModifiedAliases.get(e):null}SetAliasName(e,t){if(this.m_ModifiedAliases.has(e)){let n=this.m_ModifiedAliases.get(e);n.alias_name=t,this.m_ModifiedAliases.set(e,n),this.NotifyWatchersOfChange()}else{let n={alias_name:t,hidden:!1};this.m_ModifiedAliases.set(e,n),this.NotifyWatchersOfChange()}}SetAliasHidden(e,t){if(this.m_ModifiedAliases.has(e)){let n=this.m_ModifiedAliases.get(e);n.hidden=t,this.m_ModifiedAliases.set(e,n),this.NotifyWatchersOfChange()}else{let n={alias_name:"",hidden:t};this.m_ModifiedAliases.set(e,n),this.NotifyWatchersOfChange()}}ComputeSimulatedActionPathFromId(e){return"/simactions/"+e}GetSimulatedActionByPath(e){return this.m_ModifiedSimulatedActions.has(e)?this.m_ModifiedSimulatedActions.get(e):void 0}SetSimulatedActionByPath(e,t){this.m_ModifiedSimulatedActions.set(e,t),this.NotifyWatchersOfChange()}AddSimulatedAction(e){let t={name:"",type:e,id:this.m_nNextSimulatedActionId++,output:""},n=this.ComputeSimulatedActionPathFromId(t.id);this.m_ModifiedSimulatedActions.set(n,t),this.NotifyWatchersOfChange()}DeleteSimulatedActionByPath(e){this.m_ModifiedSimulatedActions.delete(e),this.NotifyWatchersOfChange()}get SimulatedActions(){return Array.from(this.m_ModifiedSimulatedActions.values())}get SelectedApp(){return this.m_SelectedApp?this.m_SelectedApp.key:void 0}get SelectedAppActions(){return this.m_SelectedAppActions}get CurrentAppCanAccessPrivateInputs(){return m.a.IsAppAllowedPrivateInputs(this.m_SelectedApp.key)||g.a.ShouldSendSystemButtonToAllApps}get SelectedControllerTypeInfo(){if(g.a.IsValid&&null!=this.m_sSelectedControllerType)return g.a.GetControllerTypeInfo(this.m_sSelectedControllerType)}DeviceForControllerType(e,t){let n=g.a.GetControllerTypeInfo(e);if(!n)return;let o=!1,s=g.a.ConnectedDevices.find(s=>{if(s.controller_type==e){if(o=!0,!t)return!0;if("controller_handed"!=n.input_bindingui_mode)return!0;let e=t==i.eButtonSide_Left?"/left":"/right";if(s.root_path&&s.root_path.indexOf(e)>=0)return!0}return!1});return s||(o?g.a.ConnectedDevices.find(t=>t.controller_type==e):void 0)}get CurrentBindingSaveType(){if(null!=this.m_LoadedBinding)return"developer"==this.m_LoadedBinding.save_type&&P.SelectedBindingIsLegacy?"developer_legacy":this.m_LoadedBinding.save_type}get CurrentBindingActionManifestVersion(){return this.m_LoadedBinding&&this.m_LoadedBinding.binding_config&&this.m_LoadedBinding.binding_config.action_manifest_version?this.m_LoadedBinding.binding_config.action_manifest_version:0}get SelectedActionSet(){return this.m_sSelectedActionSet}get SelectedActionSetDetails(){if(null!=this.m_SelectedAppActions&&null!=this.m_sSelectedActionSet)return this.m_SelectedAppActions.action_sets.find(e=>e.name==this.m_sSelectedActionSet)}get SelectedActionSetActions(){return this.GetActionSetActions(this.m_sSelectedActionSet)}GetSelectedAppDefaultBinding(e){if(null!=this.m_SelectedAppActions)return this.m_SelectedAppActions.default_bindings&&this.m_SelectedAppActions.default_bindings.hasOwnProperty(e)?this.m_SelectedAppActions.default_bindings[e]:void 0}GetActionSetActions(e){if(null==this.m_SelectedAppActions||null==e)return[];let t=this.m_SelectedAppActions.action_sets.find(t=>t.name==e);return t?t.actions:[]}GetActionByName(e){if(null==this.m_SelectedApp||!this.m_SelectedAppActions.action_sets)return;let t=e.toLowerCase(),n=void 0;return this.m_SelectedAppActions.action_sets.forEach(e=>{if(!e.actions)return;let i=e.actions.find(e=>e.name.toLowerCase()==t);i&&(n=i)}),n}get UnboundActions(){this.m_bIsMissingRequiredActions=!1;for(let e of this.ActionSets){let t=[],n=[];if(!e.actions)break;for(let i of e.actions)if("optional"!=i.requirement&&!this.IsActionBound(e,i.name)){let e=this.GetAliasInfo(i.name);if(e){if(e.hidden)continue;e.alias_name&&((i=Object.assign({},i)).localized_name=e.alias_name)}"mandatory"==i.requirement?t.push(i):n.push(i)}if(t.length>0&&(this.m_bIsMissingRequiredActions=!0),this.m_mapUnoundActions.has(e.name)){let i=this.m_mapUnoundActions.get(e.name);i.vecRequired=t,i.vecSuggested=n}else this.m_mapUnoundActions.set(e.name,{vecRequired:t,vecSuggested:n})}let e=this.SelectedControllerTypeInfo;return e&&"TrackedDeviceClass_HMD"==e.device_class&&(this.m_bIsMissingRequiredActions=!1),this.IsSecondaryController&&(this.m_bIsMissingRequiredActions=!1),this.m_mapUnoundActions}get HasUnboundActions(){return this.UnboundActions,this.m_bIsMissingRequiredActions}IsActionBound(e,t){t=t.toLowerCase();let n=this.GetActionSetSources(e.name);if(n)for(let e of n){let n=!1;if(e.inputs.forEach(e=>{e.output.toLowerCase()==t&&(n=!0)}),n)return!0}let i=this.GetActionSetChords(e.name);if(i)for(let e of i)if(e.output&&e.output.toLowerCase()==t)return!0;let o=this.GetActionSetPoses(e.name);if(o)for(let e of o)if(e.output&&e.output.toLowerCase()==t)return!0;let s=this.GetActionSetHaptics(e.name);if(s)for(let e of s)if(e.output&&e.output.toLowerCase()==t)return!0;let r=this.GetActionSetSkeleton(e.name);if(r)for(let e of r)if(e.output&&e.output.toLowerCase()==t)return!0;return!1}GetActionSetPoses(e){return this.m_ModifiedBindingSet.has(e)?this.m_ModifiedBindingSet.get(e).poses:[]}get SelectedActionSetPoses(){return this.GetActionSetPoses(this.m_sSelectedActionSet)}GetActionSetHaptics(e){return this.m_ModifiedBindingSet.has(e)?this.m_ModifiedBindingSet.get(e).haptics:[]}get SelectedActionSetHaptics(){return this.GetActionSetHaptics(this.m_sSelectedActionSet)}GetActionSetSkeleton(e){return this.m_ModifiedBindingSet.has(e)?this.m_ModifiedBindingSet.get(e).skeleton:[]}get SelectedActionSetSkeletons(){return this.GetActionSetSkeleton(this.m_sSelectedActionSet)}GetActionSetChords(e){return this.m_ModifiedBindingSet.has(e)?this.m_ModifiedBindingSet.get(e).chords:[]}get SelectedActionSetChords(){return this.GetActionSetChords(this.m_sSelectedActionSet)}get SelectedActionSetChordCount(){let e=this.SelectedActionSetChords;return e?e.length:0}GetActionSetSources(e){if(null==this.m_ModifiedBindingSet||null==e)return;let t=this.m_ModifiedBindingSet;return t.has(e)?t.get(e).sources:void 0}get SelectedActionSetSources(){return this.GetActionSetSources(this.m_sSelectedActionSet)}get BSelectedActionSetHasPoses(){return null!=this.m_LoadedBinding&&null!=this.m_sSelectedActionSet&&null!=this.SelectedActionSetActions&&this.SelectedActionSetActions.filter(e=>"pose"==e.type).length>0}get BSelectedActionSetHasBoundPoses(){if(!this.BSelectedActionSetHasPoses||!this.SelectedActionSetPoses||null==this.SelectedActionSetActions)return!1;for(let e of this.SelectedActionSetPoses)if(e.output&&"none"!=e.output)return!0;return!1}get BSelectedActionSetHasHaptics(){return null!=this.m_LoadedBinding&&null!=this.m_sSelectedActionSet&&null!=this.SelectedActionSetActions&&this.SelectedActionSetActions.filter(e=>"vibration"==e.type).length>0}get BSelectedActionSetHasBoundHaptics(){if(!this.BSelectedActionSetHasHaptics||!this.SelectedActionSetHaptics||null==this.SelectedActionSetActions)return!1;for(let e of this.SelectedActionSetHaptics)if(e.output&&"none"!=e.output)return!0;return!1}get BSelectedActionSetHasSkeletons(){if(null==this.m_LoadedBinding||null==this.m_sSelectedActionSet||null==this.SelectedActionSetActions)return!1;if(0==this.SelectedActionSetActions.filter(e=>"skeleton"==e.type).length)return!1;return null!=this.SelectedControllerTypeInfo&&!!this.GetFirstInputSourceOfType("skeleton")}get BSelectedActionSetHasBoundSkeletons(){if(!this.BSelectedActionSetHasSkeletons||!this.SelectedActionSetSkeletons||null==this.SelectedActionSetActions)return!1;for(let e of this.SelectedActionSetSkeletons)if(e.output&&"none"!=e.output)return!0;return!1}SetSelectedApp(e,t){if(null==this.m_SelectedApp||e!=this.m_SelectedApp.key){this.m_rKnownFailedBindingUris=[],this.m_ControllerWatchers.clear();let n=m.a.GetApp(e);n&&(this.m_SelectedApp=n,t||this.ReloadCurrentApp())}}ReloadCurrentApp(){return Object(r.a)(this,void 0,void 0,(function*(){this.m_sLoadedBindingURI=void 0,this.m_sSelectedActionSet=void 0,yield this.LoadActionManifest();let e=this.ActionSets;e.length>0&&(null==this.m_sSelectedActionSet||!this.m_SelectedAppActions.action_sets.hasOwnProperty(this.m_sSelectedActionSet))&&(this.m_sSelectedActionSet=e[0].name),yield this.ReloadControllerConfiguration()}))}SetSelectedController(e,t){if(e!=this.m_sSelectedControllerType){let n=g.a.GetControllerTypeInfo(e);n&&(this.m_ControllerWatchers.clear(),this.m_sSelectedControllerType=n.controller_type,this.m_bControllerTypeSelectedByUser=!0,this.m_sLoadedBindingURI=void 0,t||this.ReloadControllerConfiguration())}}SetSelectedActionSet(e){e!=this.m_sSelectedActionSet&&(this.m_sSelectedActionSet=e)}LocalizeStringForSelectedControllerType(e){let t=this.SelectedControllerTypeInfo;return t&&t.resource_root?g.a.LocalizeDriverString(t.resource_root,e):e}LocalizePathNameForSelectedControllerType(e){let t=void 0;return["/user/hand/secondary","/user/hand/primary","/user/hand/left","/user/hand/right","/user/head"].forEach(n=>{0!=e.indexOf(n)||(t=n)}),t?Object(p.c)("#"+t)+" "+this.LocalizeStringForSelectedControllerType(e.replace(t,"")):e}get SelectedControllerTypeLocalizedName(){let e=this.SelectedControllerTypeInfo;return e?e.resource_root?g.a.LocalizeDriverString(e.resource_root,e.controller_type):e.controller_type:""}RegisterBindingWatcher(e){null==this.m_vecBindingSetWatchers.find(t=>t==e)&&this.m_vecBindingSetWatchers.push(e)}UnregisterBindingWatcher(e){let t=this.m_vecBindingSetWatchers.indexOf(e);t>=0&&this.m_vecBindingSetWatchers.splice(t,1)}GetActionBinding(e,t){if(null==this.m_ModifiedBindingSet)return;let n=this.m_ModifiedBindingSet;if(n.has(t)){let i=n.get(t).sources;if(i){let t=i.filter(t=>t.path==e);if(t)return t}}}GetInputModesForSourceType(e,t){let n=[];switch(e){case"button":n=["button","-","toggle_button","scalar_constant"];break;case"trackpad":n=["trackpad","dpad","-","scroll","radial","button","toggle_button"];break;case"trigger":n=["trigger","button","-","toggle_button","scalar_constant"];break;case"joystick":n=["joystick","dpad","-","scroll","radial","button","toggle_button"];break;case"pinch":n=["grab"];break;default:n=[]}return t&&(n.push("force_sensor"),"trigger"==e&&n.push("grab")),n}GetBooleanInputOptionsForMode(e){switch(e){case"button":case"toggle_button":return["click","touch"];case"button":return["single","double","held","long","click","touch"];case"trackpad":return["click","touch"];case"dpad_click":case"dpad_touch":case"dpad":return["west","east","north","south","center"];case"trackpad_scroll":return[];case"trigger":return["click","touch"];case"grab":return["grab"];case"force_sensor":default:return[]}}GetActionBindingsOfType(e,t){if(null==this.m_SelectedApp||null==this.m_sSelectedActionSet||null==this.m_SelectedAppActions.action_sets)return[];let n=this.SelectedActionSetDetails;if(!n)return[];if(null==n.actions)return[];let i=[];return n.actions.forEach(n=>{let o=this.m_ModifiedAliases.get(n.name);if(n.type==e&&(!o||!o.hidden||t))if(o&&o.alias_name){let e=Object.assign({},n);e.localized_name=o.alias_name,i.push(e)}else i.push(n)}),t||this.m_ModifiedSimulatedActions.forEach(t=>{if(this.GetActionTypeFromSimulatedActionType(t.type)==e){this.ComputeSimulatedActionPathFromId(t.id),t.name?t.name:(Object(p.c)("UnnamedSimAction"),t.id);i.push(this.CreateActionDefinitionForSimulatedAction(t))}}),i}GetActionTypeFromSimulatedActionType(e){switch(e){case"fake_trigger":case"fake_trackpad_click":return"boolean";default:return"unknown"}}CreateActionDefinitionForSimulatedAction(e){return{name:this.ComputeSimulatedActionPathFromId(e.id),localized_name:e.name?e.name:Object(p.c)("UnnamedSimAction")+e.id,type:this.GetActionTypeFromSimulatedActionType(e.type)}}get GetBooleanActionBindings(){return this.GetActionBindingsOfType("boolean")}get GetVector1ActionBindings(){return this.GetActionBindingsOfType("vector1")}get GetLiteralVector1ActionBindings(){return this.GetActionBindingsOfType("vector1",!0)}get GetVector2ActionBindings(){return this.GetActionBindingsOfType("vector2")}get GetVector3ActionBindings(){return this.GetActionBindingsOfType("vector3")}get GetPoseActionBindings(){return this.GetActionBindingsOfType("pose")}get GetHapticsActionBindings(){return this.GetActionBindingsOfType("vibration")}get GetSkeletonActionBindings(){return this.GetActionBindingsOfType("skeleton")}get ConfigName(){return this.m_sName}get ConfigDescription(){return this.m_sDescription}GetPoseAction(e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses;if(null==t)return;let n=t.filter(t=>t.output.toLowerCase()==e.toLowerCase());return n.length?n:void 0}GetPoseActionByPath(e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses;if(null==t)return;let n=t.filter(t=>t.path.toLowerCase()==e.toLowerCase());return n.length?n:void 0}GetHapticsAction(e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics;if(null==t)return;let n=t.filter(t=>t.output.toLowerCase()==e.toLowerCase());return n.length?n:void 0}GetHapticsActionByPath(e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics;if(null==t)return;let n=t.filter(t=>t.path.toLowerCase()==e.toLowerCase());return n.length?n:void 0}GetSkeletonAction(e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton;if(null==t)return;let n=t.filter(t=>t.output.toLowerCase()==e.toLowerCase());return n.length?n:void 0}GetSkeletonActionByPath(e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton;if(null==t)return;let n=t.filter(t=>t.path.toLowerCase()==e.toLowerCase());return n.length?n:void 0}NotifyWatchersOfChange(){console.log("Binding file changed"),this.m_vecBindingSetWatchers.forEach(e=>{e()}),this.AutosaveBinding()}SetActionForInputModeType(e,t,n,i,o){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForInputModeType: Invalid action set specified");class s{constructor(e,t){this.mode=e,this.sourceIdx=t}}let r=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((t,n)=>{t.path==e&&r.push(new s(t,n))}),r.length<=t)return void console.warn("Invalid mode index (",t,") for path ",e);let l=r[t].sourceIdx;if(l>=0){let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[l];if(e.inputs&&e.inputs.has(n)&&e.inputs.get(n).output==i)return void console.log("Trying to set new action to old action for type",n," action is ",i);if(o.length>0&&!o.find(t=>t==e.mode))return void console.log("Trying to set invalid input type of ",n," for current mode ",e.mode);e.inputs||(e.inputs=d.m.map()),"none"==i?e.inputs.has(n)&&e.inputs.delete(n):e.inputs.has(n)?e.inputs.get(n).output=i:e.inputs.set(n,{output:i}),this.NotifyWatchersOfChange()}}SetParameterForInputModeType(e,t,n,i,o){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetParameterForInputModeType: Invalid action set specified");let s=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((t,n)=>{t.path==e&&s.push(n)}),s.length<=t)return void console.warn("Invalid mode index (",t,") for path ",e);let r=s[t];if(r>=0){let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[r];if(!e.inputs)return void console.log("SetParameterForInputModeType: Trying to set parameter for missing input type of ",n," for current mode ",e.mode);e.parameters||(e.parameters=d.m.map()),e.parameters.get(i)!=o&&(null==o?e.parameters.delete(i):e.parameters.set(i,o),this.NotifyWatchersOfChange())}}GetParameterForInputModeType(e,t,n,i){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return console.error("SetParameterForInputModeType: Invalid action set specified"),null;let o=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((t,n)=>{t.path==e&&o.push(n)}),o.length<=t)return console.warn("Invalid mode index (",t,") for path ",e),null;let s=o[t];if(s>=0){let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[s];return e.inputs?e.parameters&&e.parameters.has(i)?e.parameters.get(i):null:(console.log("GetParameterForInputModeType: Trying to get parameter for missing input type of ",n," for current mode ",e.mode),null)}return null}AddActionSetIfRequired(){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet)){let e=new A;e.sources=[],this.m_ModifiedBindingSet.set(this.m_sSelectedActionSet,e)}}AddInputModeForSource(e,t){this.AddActionSetIfRequired();let n=new b;return n.mode=t,n.path=e,n.inputs=d.m.map(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.push(n),this.NotifyWatchersOfChange(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter(t=>t.path.toLowerCase()==e.toLowerCase()).length-1}DeleteInputModeForSource(e,t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("AddInputModeForType: Invalid action set specified");let n=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((t,i)=>{t.path.toLowerCase()==e.toLowerCase()&&n.push(i)}),n.length<=t)return void console.warn("Invalid mode index (",t,") for path ",e);let i=n[t];-1!=i?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.splice(i,1),this.NotifyWatchersOfChange()):console.error("DeleteInputModeForSource: Mode not found for source")}SetInputModeForInputSource(e,t,n){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForInputModeType: Invalid action set specified");let i=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((t,n)=>{t.path.toLowerCase()==e.toLowerCase()&&i.push(n)}),i.length<=t)return void console.warn("Invalid mode index (",t,") for path ",e);let o=i[t];if(-1!=o){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[o];if(t.path==e){if(t.mode==n)return void console.log("Trying to set new input mode to old mode!");let i=JSON.parse(JSON.stringify(t)),s=new b;switch(s.mode=n,s.path=e,s.inputs=d.m.map(),n){case"button":case"toggle_button":switch(i.mode){case"complex_button":i.inputs.single&&(s.inputs.set("single",i.inputs.single),s.inputs.set("click",i.inputs.single)),i.inputs.long&&s.inputs.set("long",i.inputs.long),i.inputs.press&&s.inputs.set("press",i.inputs.press),i.inputs.double&&s.inputs.set("double",i.inputs.double),i.inputs.touch&&s.inputs.set("touch",i.inputs.touch);break;case"button":case"toggle_button":case"trackpad":case"trigger":i.inputs.click&&s.inputs.set("click",i.inputs.click),i.inputs.touch&&s.inputs.set("touch",i.inputs.touch)}break;case"complex_button":switch(i.mode){case"toggle_button":case"button":i.inputs.click&&s.inputs.set("single",i.inputs.click);break;case"trackpad":case"trigger":i.inputs.click&&s.inputs.set("single",i.inputs.click)}break;case"trackpad":switch(i.mode){case"complex_button":i.inputs.single&&s.inputs.set("click",i.inputs.single);break;case"toggle_button":case"button":case"trigger":i.inputs.click&&s.inputs.set("click",i.inputs.click),i.inputs.touch&&s.inputs.set("touch",i.inputs.touch)}break;case"trigger":switch(i.mode){case"complex_button":i.inputs.single&&s.inputs.set("click",i.inputs.single);break;case"toggle_button":case"trackpad":case"button":i.inputs.click&&s.inputs.set("click",i.inputs.click),i.inputs.touch&&s.inputs.set("touch",i.inputs.touch)}}return this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[o]=s,void this.NotifyWatchersOfChange()}}else console.error("SetActionForInputModeType: trying to change a mode for a source that we don't have already")}ClearModesForInputPath(e){this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet)?this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter(t=>t.path.toLowerCase()!=e.toLowerCase()):console.error("ClearModesForInputPath: Invalid action set specified")}SetInputPathForPose(e,t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForPose: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.findIndex(t=>t.path.toLowerCase()==e.path.toLowerCase()&&t.output.toLowerCase()==e.output.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].output=e.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].path!=t?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].path=t,this.NotifyWatchersOfChange()):console.log("Trying to set new pose action path to old action path!")}SetPoseForInputPath(e,t){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForPose: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.findIndex(t=>t.path.toLowerCase()==e.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].path=e),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].output!=t?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].output=t,this.NotifyWatchersOfChange()):console.log("Trying to set new pose action path to old action path!")}GetFirstInputSourceOfType(e){let t=this.SelectedControllerTypeInfo;if(null!=t)for(let n of Object.keys(t.input_source)){if(t.input_source[n].type==e)return n}}AddDefaultPose(e,t){if(this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array),null==this.SelectedControllerTypeInfo)return;let n=this.GetFirstInputSourceOfType("pose");if(!n)return;let i=new class{};i.output=e,i.path=n,this.SetInputPathForPose(i,n)}SetInputPathForHaptics(e,t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputPathForHaptics: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.findIndex(t=>t.path.toLowerCase()==e.path.toLowerCase()&&t.output.toLowerCase()==e.output.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.push(new f)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].output=e.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].path!=t?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].path=t,this.NotifyWatchersOfChange()):console.log("Trying to set new haptics action path to old action path!")}SetHapticsForInputPath(e,t){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetHapticsForInputPath: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.findIndex(t=>t.path.toLowerCase()==e.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].path=e),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].output!=t?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].output=t,this.NotifyWatchersOfChange()):console.log("Trying to set new haptic action path to old action path!")}AddDefaultHaptics(e,t){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let n=this.GetFirstInputSourceOfType("haptic");if(!n)return;let i=t+n;let o=new class{};o.output=e,o.path=i,this.SetInputPathForHaptics(o,i)}SetInputPathForSkeleton(e,t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputPathForSkeleton: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.findIndex(t=>t.path.toLowerCase()==e.path.toLowerCase()&&t.output.toLowerCase()==e.output.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.push(new y)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].output=e.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].path!=t?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].path=t,this.NotifyWatchersOfChange()):console.log("Trying to set new skeleton action path to old action path!")}SetSkeletonForInputPath(e,t){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetSkeletonForInputPath: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.findIndex(t=>t.path.toLowerCase()==e.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].path=e),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].output!=t?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].output=t,this.NotifyWatchersOfChange()):console.log("Trying to set new skeleton action path to old action path!")}AddDefaultSkeleton(e,t){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let n=this.GetFirstInputSourceOfType("skeleton");if(!n)return;let i=t+n;let o=new class{};o.output=e,o.path=i,this.SetInputPathForSkeleton(o,i)}SetActionForChord(e,t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForChord: Invalid action set specified");let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(t=>t==e);-1!=n?this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].output!=t?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].output=t,this.NotifyWatchersOfChange()):console.log("Trying to set new chord action to old action!"):console.error("SetActionForChord: Invalid chord  specified ",e)}DeleteChord(e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("DeleteChordForSource: Invalid action set specified");let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(t=>t==e);-1!=t?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.splice(t,1),this.NotifyWatchersOfChange()):console.error("DeleteChordForSource: Invalid chord  specified ",e)}AddChord(){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords=new Array);this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.push(new O);this.NotifyWatchersOfChange()}DeleteSourceFromChord(e,t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("DeleteSourceFromChord: Invalid action set specified");let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(t=>t==e);if(-1!=n){let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs.findIndex(e=>e[0]==t);-1!=e&&(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs.splice(e,1),this.NotifyWatchersOfChange())}else console.error("DeleteSourceFromChord: Invalid chord  specified ",e)}SetInputTypeForChord(e,t,n){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputsForChord: Invalid action set specified");let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(t=>t==e);if(-1!=i){let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs.findIndex(e=>e[0]==t);if(-1==e)return void console.log("Invalid bounds for new input chord, trying to add type without source");if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[e][1]==n)return void console.log("Trying to set new chord inputs to old inputs!");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[e][1]=n,this.NotifyWatchersOfChange()}else console.error("SetInputsForChord: Invalid chord  specified ",e)}SetInputSourceForChord(e,t,n){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputsForChord: Invalid action set specified");let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(t=>t==e);if(-1!=i){let e=this.GetActionBinding(t,this.SelectedActionSet);if(!e)return void console.log("Failed to find action binding for path");let o="click";if(e.length&&(o=this.GetBooleanInputOptionsForMode(e[0].mode)[0]),null==n)this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs=new Array),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs.push([t,o]);else{let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs.findIndex(e=>e[0]==n);if(-1==e)return void console.log("Trying to set replace chord input path when we didn't have that path!");if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[e][0]==t)return void console.log("Trying to set new chord inputs to old inputs!");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[e][0]=t,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[e][1]=o}this.NotifyWatchersOfChange()}else console.error("SetInputsForChord: Invalid chord  specified ",e)}LoadActionManifest(){return Object(r.a)(this,void 0,void 0,(function*(){return new Promise((e,t)=>{I(this.m_SelectedApp.key).then(t=>{null==t.error?(this.m_SelectedAppActions=t,null==this.m_sLoadedBindingURI&&t.current_binding_url.hasOwnProperty(this.m_sSelectedControllerType)&&(this.m_sLoadedBindingURI=t.current_binding_url[this.m_sSelectedControllerType])):(this.m_SelectedAppActions=void 0,this.m_sLoadedBindingURI=void 0),e()})})}))}get SelectedBindingURL(){return null!=this.m_sSelectedControllerType&&null!=this.m_SelectedAppActions&&null!=this.m_SelectedAppActions.current_binding_url&&this.m_SelectedAppActions.current_binding_url.hasOwnProperty(this.m_sSelectedControllerType)?this.m_SelectedAppActions.current_binding_url[this.m_sSelectedControllerType]:void 0}get LoadedBindingURL(){return this.m_sLoadedBindingURI}get SelectedBindingIsLegacy(){return!this.m_SelectedAppActions||this.m_SelectedAppActions.legacy}get IsSecondaryController(){if(!this.m_sSelectedControllerType)return!1;let e=g.a.FindRootPathForControllerType(this.m_sSelectedControllerType);return"/user/treadmill"==e||"/user/gamepad"==e||"/user/stylus"==e}ReloadControllerConfiguration(){return Object(r.a)(this,void 0,void 0,(function*(){if(!(this.m_SelectedAppActions&&this.m_sLoadedBindingURI&&this.SelectedApp&&this.SelectedControllerTypeInfo))return;let e=yield k(this.m_SelectedApp.key,this.SelectedControllerTypeInfo.controller_type,this.m_sLoadedBindingURI);this.OnBindingConfigLoaded(e)}))}UpdateTrackerBindings(){return Object(r.a)(this,void 0,void 0,(function*(){let e=yield this.GetTrackerBindings();this.m_TrackerBindingSetup=e}))}get TrackerBindings(){return null==this.m_TrackerBindingSetup&&this.UpdateTrackerBindings(),this.m_TrackerBindingSetup}GetTrackerBindings(){return Object(r.a)(this,void 0,void 0,(function*(){return new Promise((function(e,t){c.a.get("/input/gettrackerbindings.json").then(t=>{e(t.data)}).catch(e=>{t(e)})}))}))}GetTrackerBinding(e){for(let t of this.m_TrackerBindingSetup.trackers)if(t.device_path_string==e)return t;return null}SetTrackerBinding(e,t,n){let i={device_path:e,role:t,controller_role:n},o=JSON.stringify(i);console.log("Saving tracker binding "+e),c.a.post("/input/settrackerbinding.action",o).then(e=>{console.log("SetTrackerBinding response: ",e.data),this.UpdateTrackerBindings()}).catch(e=>{})}PulseHaptics(e){let t={path_handle:e},n=JSON.stringify(t);c.a.post("/input/pulsehaptics.action",n).then(e=>{console.log("PulseHaptics response: ",e.data)}).catch(e=>{})}get KnownControllerTypes(){let e=[];return g.a.KnownControllerTypes.forEach(t=>{e.push(t)}),e}PreserveCurrentBindingForUpgrade(){let e=S.a.CurrentBinding;return e&&"autosave"==e.type?this.SaveCurrentBinding(Object(p.c)("#PreservedAutosaveName"),"","personal"):Promise.resolve(null)}GetDefaultBindingNameForSaveType(e){let t=P.SelectedControllerTypeInfo,n=g.a.LocalizeControllerString(t,t?t.controller_type:"");switch(e){default:case"autosave":return Object(p.c)("#BindingUI_SaveDefaultName",this.m_SelectedApp.name,n);case"personal":return Object(p.c)("#BindingUI_SaveDefaultName_Personal",this.m_SelectedApp.name,n);case"public":return Object(p.c)("#BindingUI_SaveDefaultName_Public",g.a.CurrentUserPersonaName)}}AutosaveBinding(){this.m_sName||(this.m_sName=this.GetDefaultBindingNameForSaveType("autosave")),this.SaveCurrentBinding(this.m_sName,this.m_sDescription,"autosave").then(e=>{P.SetBindingURL(e.uri)})}SaveCurrentBinding(e,t,n){return Object(r.a)(this,void 0,void 0,(function*(){if(this.HasUnboundActions)return console.log("Aborting save: Missing at least one required action"),new Promise((e,t)=>{t()});this.m_sName=e,this.m_sDescription=t;let i={app_key:this.SelectedApp,controller_type:this.SelectedControllerTypeInfo.controller_type,save_type:n};i.binding={name:e,description:t,action_manifest_version:this.m_SelectedAppActions.version,category:this.SelectedBindingIsLegacy?"legacy":"steamvr_input",controller_type:this.SelectedControllerTypeInfo.controller_type,bindings:this.m_ModifiedBindingSet,options:this.m_ModifiedOptions,alias_info:this.m_ModifiedAliases,simulated_actions:Array.from(this.m_ModifiedSimulatedActions.values()),app_key:this.SelectedApp};let o=JSON.stringify(i);return console.log("Saving binding "+e+" for app "+this.SelectedApp),new Promise((e,t)=>{let i=new M(n,e,t);this.m_OutstandingSaveBindingCalls.push(i),c.a.post("/input/savebinding.action",o).then(e=>{e.data.error?(console.log("SaveCurrentBinding failed:",e.data.error),t(e.data.error)):console.log("SaveCurrentBinding Successful")}).catch(e=>{t(e)})})}))}PublishBindingToWorkshop(e){return Object(r.a)(this,void 0,void 0,(function*(){let t={app_key:this.SelectedApp,description:e};t.binding={bindings:this.m_ModifiedBindingSet,controller_type:this.SelectedControllerTypeInfo.controller_type};let n=JSON.stringify(t);yield new Promise((function(e,t){c.a.post("/input/submitworkshopbinding.action",n).then(t=>{console.log("PublishBindingToWorkshop response: ",t),e()}).catch(e=>{t(e)})}))}))}OnWebSocketOpen(e){console.log("Websocket connected"),this.m_eWebSocketState=s.eWebSocketState_Connected,this.WebSocketSend("input_open"),this.m_timerWebSocket&&clearTimeout(this.m_timerWebSocket),window.addEventListener("beforeunload",()=>{this.WebSocketSend("input_close")})}OnWebSocketClose(e){console.log("Websocket closed ",e),this.m_eWebSocketState=s.eWebSocketState_Disconnected,this.OpenWebSocketToHost()}WebSocketSend(e){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(e)}OnWorkshopUploadComplete(e){if(console.log("OnWorkshopUploadComplete: ",e),e.app_key!=this.SelectedApp)return void console.log("Ignoring binding load for an app we aren't viewing");if(this.m_OutstandingSaveBindingCalls.length<=0)return void console.log("Got workshop upload result without pending resolve");let t=this.m_OutstandingSaveBindingCalls.shift();e.success?(t.resolve(e),this.LoadActionManifest()):t.reject(e)}OnPendingFileSaved(e){console.log("OnPendingFileSaved: ",e),e.app_key==this.SelectedApp||console.log("Ignoring pending file saved for an app we aren't viewing")}get SaveNoticeText(){if(this.m_OutstandingSaveBindingCalls.length>0){let e=!1;return this.m_OutstandingSaveBindingCalls.forEach(t=>{"personal"!=t.SaveType&&"public"!=t.SaveType||(e=!0)}),e?"#SaveNotice_Uploading":"#SaveNotice_Saving"}}OnBindingConfigLoaded(e){if(console.log("OnBindingConfigLoaded: ",e," selected action set:",this.m_sSelectedActionSet),e.app_key!=this.SelectedApp)return void console.log("Ignoring binding load for an app we aren't viewing");if(e.uri!=this.m_sLoadedBindingURI)return void console.log(`Ignoring binding load for an config url ${e.uri} we aren't viewing ${this.m_sLoadedBindingURI}`);this.m_ControllerWatchers.clear(),this.m_LoadedBinding=e,this.m_ModifiedBindingSet=d.m.map();let t=Object(p.c)("#unknown_application"),n=m.a.GetApp(P.SelectedApp);if(n&&(t=n.name),this.m_sName="",this.m_sDescription="",e.binding_config&&(e.binding_config.hasOwnProperty("name")&&(this.m_sName=e.binding_config.name),e.binding_config.hasOwnProperty("description")&&(this.m_sDescription=e.binding_config.description)),""==this.m_sName){let e=P.SelectedControllerTypeInfo,n=g.a.LocalizeControllerString(e,e?e.controller_type:"");this.m_sName=Object(p.c)("#BindingUI_SaveDefaultName",t,n)}e.binding_config&&e.binding_config.bindings&&(Object.keys(e.binding_config.bindings).forEach(t=>{let n=new A;n.chords=e.binding_config.bindings[t].chords,n.poses=e.binding_config.bindings[t].poses,n.haptics=e.binding_config.bindings[t].haptics,n.skeleton=e.binding_config.bindings[t].skeleton,n.sources=new Array,e.binding_config.bindings[t].sources.forEach(e=>{let t=new b;t.mode=e.mode,t.path=e.path,t.inputs=d.m.map(),e.hasOwnProperty("inputs")&&Object.keys(e.inputs).forEach(n=>{t.inputs.set(n,e.inputs[n])}),null!=e.parameters&&Object.keys(e.parameters).length>0&&(t.parameters=d.m.map(),e.hasOwnProperty("parameters")&&Object.keys(e.parameters).forEach(n=>{t.parameters.set(n,e.parameters[n])})),n.sources.push(t)}),this.m_ModifiedBindingSet.set(t,n)}),this.m_ModifiedOptions.clear(),e.binding_config.options&&(Object.keys(e.binding_config.options).forEach(t=>{this.m_ModifiedOptions.set(t,e.binding_config.options[t])}),this.ManifestOptions.forEach(e=>{this.m_ModifiedOptions.has(e.name)||this.m_ModifiedOptions.set(e.name,e.default)})),this.m_ModifiedAliases.clear(),e.binding_config.alias_info&&Object.keys(e.binding_config.alias_info).forEach(t=>{this.m_ModifiedAliases.set(t,e.binding_config.alias_info[t])}),this.m_ModifiedSimulatedActions.clear(),e.binding_config.simulated_actions&&e.binding_config.simulated_actions.forEach(e=>{let t=this.ComputeSimulatedActionPathFromId(e.id);this.m_ModifiedSimulatedActions.set(t,e),e.id>=this.m_nNextSimulatedActionId&&(this.m_nNextSimulatedActionId=e.id+1)})),this.m_vecBindingSetWatchers.forEach(e=>{e()})}QueryBindingList(e,t){return null!=this.m_OutstandingQueryResolve&&console.warn("About to start second binding list query when one is already pending",this.m_OutstandingQueryResolve),new Promise((n,i)=>{this.m_OutstandingQueryResolve=n,c.a.get(`/input/queryworkshopbindings.json?app_key=${e}&controller_type=${t}`).then(e=>{console.log("QueryBindingList: ajax request successful")}).catch(e=>{i(e)})})}DeleteBinding(e){null!=this.m_OutstandingDeleteResolve&&console.warn("About to start second binding delete when one is already pending",this.m_OutstandingDeleteResolve);let t={url:e},n=JSON.stringify(t);return new Promise((t,i)=>{this.m_OutstandingDeleteResolve=t,this.m_sOutstandingDeleteURL=e,c.a.post("/input/deleteconfig.action",n).then(e=>{console.log("Delete ajax request successful")}).catch(e=>{i(e)})})}OnBindingDeleteComplete(e){null!=this.m_OutstandingDeleteResolve?e.url==this.m_sOutstandingDeleteURL&&(this.m_sOutstandingDeleteURL=void 0,this.m_OutstandingDeleteResolve(e),this.m_OutstandingDeleteResolve=void 0,console.log("OnDeleteComplete: ",e)):console.warn("Missing outstanding query resolve for binding delete")}OnBindingLoadFailed(e){console.log("OnBindingLoadFailed: "+e.app_key+" "+e.controller_type+" "+e.error),m.a.UpdateApplications().then(()=>{if(!m.a.ShouldShowBindingFailureForApp(e.app_key))return;if(!this.ShouldShowBindingFailureForControllerType(e.controller_type))return;if(!S.a.ShouldShowBindingFailure())return;this.m_rKnownFailedBindingUris.push(e.uri),this.SetSelectedApp(e.app_key),this.SetSelectedController(e.controller_type);let t=m.a.GetApp(e.app_key),n=g.a.GetControllerTypeInfo(e.controller_type);if(!n)return;let i=g.a.LocalizeControllerString(n,e.controller_type);S.a.ShowBindingList(Object(p.c)(e.error,t?t.name:Object(p.c)("#unknown_application"),i)),h.a.IsAvailable()&&h.a.ShowBindingUI(!1)})}ShouldShowBindingFailureForControllerType(e){if(null==e||""==e)return!1;let t=g.a.GetControllerTypeInfo(e);return!!t&&!!t.should_show_binding_errors}HasBindingUriFailedToLoad(e){return-1!=this.m_rKnownFailedBindingUris.indexOf(e)}OnQueryResults(e){console.log("OnQueryResults: ",e),null!=this.m_OutstandingQueryResolve?(this.m_OutstandingQueryResolve(e),this.m_OutstandingQueryResolve=void 0):console.warn("Missing outstanding query resolve for binding query")}SelectConfig(e,t,n){if(this.m_sLoadedBindingURI=n,console.log("Selecting config "+n+" for app "+e),this.SelectedBindingURL==n)return console.debug("Selecting the config we already have set",n),new Promise((e,t)=>{e()});let i={app_key:e,controller_type:t,url:n},o=JSON.stringify(i);return null!=this.m_OutstandingSelectConfigResolve&&console.warn("About to start second select config when one is already pending",this.m_OutstandingSelectConfigResolve),new Promise((e,t)=>{this.m_OutstandingSelectConfigResolve=e,c.a.post("/input/selectconfig.action",o).then(e=>{console.log("selectconfig ajax request successful")}).catch(e=>{t(e)})})}OnSelectConfigComplete(e){null!=this.m_OutstandingSelectConfigResolve?(this.m_OutstandingSelectConfigResolve(),this.m_OutstandingSelectConfigResolve=void 0,console.log("OnSelectConfigComplete: ",e)):e.error_to_show?S.a.ShowBindingList(e.error_to_show):console.warn("Missing outstanding query resolve for select config")}OnTrackersBindingChanged(e){this.GetTrackerBindings().then(e=>{this.m_TrackerBindingSetup=e})}OnActionManifestReloaded(e){e.app_key==this.SelectedApp&&this.ReloadCurrentApp()}OnActionManifestLoadFailed(e){S.a.ShowActionManifestLoadFailed(e.app_key,e.error,e.error_param,e.path)}OnShowActionOrigins(e){S.a.ShowActionOrigins(e.app_key,e.action_set,e.origin_to_highlight)}SetBindingURL(e){this.m_sLoadedBindingURI=e}OnActionBindingsReloaded(e){this.RefreshInputState()}GetControllerWatcherForSourceFromControllerType(e,t,n,o){let s=""+e.controller_type+t+n+o;if(!this.m_ControllerWatchers.has(s)){let r="";if("controller_handed"==e.input_bindingui_mode)switch(t){case i.eButtonSide_Left:r="/user/hand/left";break;case i.eButtonSide_Right:r="/user/hand/right"}else{let t=g.a.ConnectedDevices.find(t=>t.controller_type==e.controller_type);t&&t.root_path?r=t.root_path:console.log("Unable to find device path for controller type ",e)}this.m_ControllerWatchers.set(s,new j(r,e,t,n,o))}return this.m_ControllerWatchers.get(s)}OnWebSocketMessage(e){let t=JSON.parse(e.data);if("jsonid"in t&&"vr_input_get_notifications"==t.jsonid)for(let e in t.notifications){let n=t.notifications[e];switch(n.type){case"pending_file_saved":this.OnPendingFileSaved(n);break;case"workshop_upload_complete":this.OnWorkshopUploadComplete(n);break;case"query_results":this.OnQueryResults(n);break;case"action_bindings_reloaded":this.OnActionBindingsReloaded(n);break;case"delete_binding_complete":this.OnBindingDeleteComplete(n);break;case"binding_load_failed":this.OnBindingLoadFailed(n);break;case"select_config_complete":this.OnSelectConfigComplete(n);break;case"trackers_binding_changed":this.OnTrackersBindingChanged(n);break;case"action_manifest_reloaded":this.OnActionManifestReloaded(n);break;case"action_manifest_load_failed":this.OnActionManifestLoadFailed(n);break;case"show_action_origins":this.OnShowActionOrigins(n);break;case"refresh_input_state":this.RefreshInputState();break;case"binding_subscription_changed":this.m_nBindingSubscriptionChangedCanary++}}}get BindingConfig(){return null==this.m_ModifiedBindingSet?"":JSON.stringify(this.m_ModifiedBindingSet,null,"\t")}get BindingSubscriptionChangedCanary(){return this.m_nBindingSubscriptionChangedCanary}}Object(r.b)([d.m],T.prototype,"m_eWebSocketState",void 0),Object(r.b)([d.m],T.prototype,"m_sLoadedBindingURI",void 0),Object(r.b)([d.m],T.prototype,"m_LoadedBinding",void 0),Object(r.b)([d.m],T.prototype,"m_ModifiedBindingSet",void 0),Object(r.b)([d.m],T.prototype,"m_ModifiedOptions",void 0),Object(r.b)([d.m],T.prototype,"m_ModifiedAliases",void 0),Object(r.b)([d.m],T.prototype,"m_sName",void 0),Object(r.b)([d.m],T.prototype,"m_sDescription",void 0),Object(r.b)([d.m],T.prototype,"m_SelectedApp",void 0),Object(r.b)([d.m],T.prototype,"m_SelectedAppActions",void 0),Object(r.b)([d.m],T.prototype,"m_sSelectedActionSet",void 0),Object(r.b)([d.m],T.prototype,"m_sSelectedControllerType",void 0),Object(r.b)([d.m],T.prototype,"m_TrackerBindingSetup",void 0),Object(r.b)([d.m],T.prototype,"m_OutstandingSaveBindingCalls",void 0),Object(r.b)([d.m],T.prototype,"m_ModifiedSimulatedActions",void 0),Object(r.b)([d.m],T.prototype,"m_nBindingSubscriptionChangedCanary",void 0),Object(r.b)([l.bind],T.prototype,"OpenWebSocketToHost",null),Object(r.b)([d.f],T.prototype,"SteamVRUnavailable",null),Object(r.b)([d.f],T.prototype,"ActionSets",null),Object(r.b)([d.f],T.prototype,"ManifestOptions",null),Object(r.b)([d.f],T.prototype,"SecondaryControllerOptions",null),Object(r.b)([d.d],T.prototype,"SetOptionValue",null),Object(r.b)([d.d],T.prototype,"AddSimulatedAction",null),Object(r.b)([d.d],T.prototype,"DeleteSimulatedActionByPath",null),Object(r.b)([d.f],T.prototype,"SelectedApp",null),Object(r.b)([d.f],T.prototype,"SelectedAppActions",null),Object(r.b)([d.f],T.prototype,"CurrentAppCanAccessPrivateInputs",null),Object(r.b)([d.f],T.prototype,"SelectedControllerTypeInfo",null),Object(r.b)([d.f],T.prototype,"CurrentBindingSaveType",null),Object(r.b)([d.f],T.prototype,"CurrentBindingActionManifestVersion",null),Object(r.b)([d.f],T.prototype,"SelectedActionSet",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetDetails",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetActions",null),Object(r.b)([l.bind],T.prototype,"GetSelectedAppDefaultBinding",null),Object(r.b)([l.bind],T.prototype,"GetActionByName",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetPoses",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetHaptics",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetSkeletons",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetChords",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetChordCount",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetSources",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasPoses",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasBoundPoses",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasHaptics",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasBoundHaptics",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasSkeletons",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasBoundSkeletons",null),Object(r.b)([d.d],T.prototype,"SetSelectedApp",null),Object(r.b)([d.d],T.prototype,"SetSelectedController",null),Object(r.b)([d.d],T.prototype,"SetSelectedActionSet",null),Object(r.b)([l.bind],T.prototype,"LocalizeStringForSelectedControllerType",null),Object(r.b)([l.bind],T.prototype,"LocalizePathNameForSelectedControllerType",null),Object(r.b)([d.f],T.prototype,"SelectedControllerTypeLocalizedName",null),Object(r.b)([d.d],T.prototype,"RegisterBindingWatcher",null),Object(r.b)([d.d],T.prototype,"UnregisterBindingWatcher",null),Object(r.b)([d.d],T.prototype,"GetActionBinding",null),Object(r.b)([l.bind],T.prototype,"GetInputModesForSourceType",null),Object(r.b)([l.bind],T.prototype,"GetBooleanInputOptionsForMode",null),Object(r.b)([l.bind],T.prototype,"GetActionBindingsOfType",null),Object(r.b)([d.f],T.prototype,"GetBooleanActionBindings",null),Object(r.b)([d.f],T.prototype,"GetVector1ActionBindings",null),Object(r.b)([d.f],T.prototype,"GetLiteralVector1ActionBindings",null),Object(r.b)([d.f],T.prototype,"GetVector2ActionBindings",null),Object(r.b)([d.f],T.prototype,"GetVector3ActionBindings",null),Object(r.b)([d.f],T.prototype,"GetPoseActionBindings",null),Object(r.b)([d.f],T.prototype,"GetHapticsActionBindings",null),Object(r.b)([d.f],T.prototype,"GetSkeletonActionBindings",null),Object(r.b)([d.f],T.prototype,"ConfigName",null),Object(r.b)([d.f],T.prototype,"ConfigDescription",null),Object(r.b)([l.bind],T.prototype,"GetPoseAction",null),Object(r.b)([l.bind],T.prototype,"GetPoseActionByPath",null),Object(r.b)([l.bind],T.prototype,"GetHapticsAction",null),Object(r.b)([l.bind],T.prototype,"GetHapticsActionByPath",null),Object(r.b)([l.bind],T.prototype,"GetSkeletonAction",null),Object(r.b)([l.bind],T.prototype,"GetSkeletonActionByPath",null),Object(r.b)([l.bind],T.prototype,"NotifyWatchersOfChange",null),Object(r.b)([d.d],T.prototype,"SetActionForInputModeType",null),Object(r.b)([d.d],T.prototype,"SetParameterForInputModeType",null),Object(r.b)([l.bind],T.prototype,"AddActionSetIfRequired",null),Object(r.b)([d.d],T.prototype,"AddInputModeForSource",null),Object(r.b)([d.d],T.prototype,"DeleteInputModeForSource",null),Object(r.b)([d.d],T.prototype,"SetInputModeForInputSource",null),Object(r.b)([d.d],T.prototype,"ClearModesForInputPath",null),Object(r.b)([d.d],T.prototype,"SetInputPathForPose",null),Object(r.b)([d.d],T.prototype,"SetPoseForInputPath",null),Object(r.b)([d.d],T.prototype,"AddDefaultPose",null),Object(r.b)([d.d],T.prototype,"SetInputPathForHaptics",null),Object(r.b)([d.d],T.prototype,"SetHapticsForInputPath",null),Object(r.b)([d.d],T.prototype,"AddDefaultHaptics",null),Object(r.b)([d.d],T.prototype,"SetInputPathForSkeleton",null),Object(r.b)([d.d],T.prototype,"SetSkeletonForInputPath",null),Object(r.b)([d.d],T.prototype,"AddDefaultSkeleton",null),Object(r.b)([d.d],T.prototype,"SetActionForChord",null),Object(r.b)([d.d],T.prototype,"DeleteChord",null),Object(r.b)([d.d],T.prototype,"AddChord",null),Object(r.b)([d.d],T.prototype,"DeleteSourceFromChord",null),Object(r.b)([d.d],T.prototype,"SetInputTypeForChord",null),Object(r.b)([d.d],T.prototype,"SetInputSourceForChord",null),Object(r.b)([d.d],T.prototype,"LoadActionManifest",null),Object(r.b)([d.f],T.prototype,"SelectedBindingURL",null),Object(r.b)([d.f],T.prototype,"LoadedBindingURL",null),Object(r.b)([d.f],T.prototype,"SelectedBindingIsLegacy",null),Object(r.b)([d.f],T.prototype,"IsSecondaryController",null),Object(r.b)([d.f],T.prototype,"TrackerBindings",null),Object(r.b)([d.d],T.prototype,"GetTrackerBindings",null),Object(r.b)([l.bind],T.prototype,"SetTrackerBinding",null),Object(r.b)([l.bind],T.prototype,"PulseHaptics",null),Object(r.b)([d.f],T.prototype,"KnownControllerTypes",null),Object(r.b)([l.bind],T.prototype,"AutosaveBinding",null),Object(r.b)([l.bind],T.prototype,"OnWebSocketOpen",null),Object(r.b)([l.bind],T.prototype,"OnWebSocketClose",null),Object(r.b)([l.bind],T.prototype,"WebSocketSend",null),Object(r.b)([l.bind],T.prototype,"OnWorkshopUploadComplete",null),Object(r.b)([l.bind],T.prototype,"OnPendingFileSaved",null),Object(r.b)([d.f],T.prototype,"SaveNoticeText",null),Object(r.b)([l.bind],T.prototype,"QueryBindingList",null),Object(r.b)([l.bind],T.prototype,"DeleteBinding",null),Object(r.b)([l.bind],T.prototype,"OnBindingDeleteComplete",null),Object(r.b)([l.bind],T.prototype,"OnBindingLoadFailed",null),Object(r.b)([l.bind],T.prototype,"ShouldShowBindingFailureForControllerType",null),Object(r.b)([l.bind],T.prototype,"HasBindingUriFailedToLoad",null),Object(r.b)([l.bind],T.prototype,"OnQueryResults",null),Object(r.b)([l.bind],T.prototype,"SelectConfig",null),Object(r.b)([l.bind],T.prototype,"OnSelectConfigComplete",null),Object(r.b)([l.bind],T.prototype,"OnTrackersBindingChanged",null),Object(r.b)([l.bind],T.prototype,"OnActionManifestReloaded",null),Object(r.b)([l.bind],T.prototype,"OnActionManifestLoadFailed",null),Object(r.b)([l.bind],T.prototype,"OnShowActionOrigins",null),Object(r.b)([l.bind],T.prototype,"SetBindingURL",null),Object(r.b)([l.bind],T.prototype,"OnActionBindingsReloaded",null),Object(r.b)([l.bind],T.prototype,"GetControllerWatcherForSourceFromControllerType",null),Object(r.b)([l.bind],T.prototype,"OnWebSocketMessage",null),Object(r.b)([d.f],T.prototype,"BindingConfig",null),Object(r.b)([d.f],T.prototype,"BindingSubscriptionChangedCanary",null);const P=new T;window.controllerBindingStore=P},"Q+Z6":function(e,t,n){"use strict";n.d(t,"e",(function(){return p})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return S})),n.d(t,"d",(function(){return f}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA"),a=n("EUJ1"),c=n("Gmup"),d=n("7uy8");const p=16,u=.2,h=5,S=.02,m="change_route",g="app_config_changed",b="workshop_state_changed";class _{constructor(){this.m_wsWebSocketToServer=void 0,this.m_mailbox=new a.CVRMailbox,this.showInternalSettings=!1,this.workshopStateChangedCanary=1,this.onRestartRequired=null,this.pendingChanges=new Map,this.route=[],this.m_mapSettingsLastWriteInfo=new Map,this.GetAppList=function(){return new Promise((function(e,t){r.a.get("/app/list.json").then(t=>{e(t.data.apps)}).catch(e=>{t(e)})}))},this.GetSettingsUGC=function(){return new Promise((function(e,t){r.a.get("/settings_getugc").then(t=>{e(t.data)}).catch(e=>{t(e)})}))},this.ReloadSettingsSchema=function(){return new Promise((function(e,t){r.a.get("/settings_reloadschema").then(t=>{e(t.data)}).catch(e=>{t(e)})}))},this.GetSettingsInfo=function(){return new Promise((function(e,t){r.a.get("/settings_getinfo").then(t=>{e(t.data)}).catch(e=>{t(e)})}))}}OpenWebSocketToHost(){return new Promise((e,t)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",t=>{this.OnWebSocketOpen(t),e()}),this.m_wsWebSocketToServer.addEventListener("message",this.OnWebSocketMessage),this.m_wsWebSocketToServer.addEventListener("close",this.OnWebSocketClose)})}Init(){return Object(i.a)(this,void 0,void 0,(function*(){if(this.connected=!1,this.settings=new Map,window.addEventListener("hashchange",this.onHashChanged),this.onHashChanged(),Object(l.e)(()=>{let e=[];if(0!=this.pendingChanges.size){for(const[t,n]of this.pendingChanges.entries())e.push({name:t,value:n});this.pendingChanges.clear(),r.a.post("/settings_set.action",e).then(e=>{}).catch(t=>{console.log("Failed to save settings! This usually happens when type is set incorrectly on one of the keys in the schema. ",e)})}},{delay:300}),VRHTML.IsAvailable()&&VRHTML.RegisterForDisplayModeNotSupportedEvents(this.SetRestartRequired),!this.m_mailbox.connected)try{yield this.m_mailbox.Init(VRHTML.Environment()==a.VRHTMLEnvironment.Overlay?"settings/overlay":"settings/desktop"),this.m_mailbox.RegisterHandler(b,this.OnWorkshopStateChangedMessage),this.m_mailbox.RegisterHandler(m,this.OnChangeRouteMessage),this.m_mailbox.RegisterHandler(g,this.OnAppConfigChangedMessage)}catch(e){console.log("Failed to open display_settings_ui mailbox:"+e)}yield this.OpenWebSocketToHost()}))}OnWorkshopStateChangedMessage(e){this.workshopStateChangedCanary++}OnChangeRouteMessage(e){this.setRoute(e.page,e.section)}OnAppConfigChangedMessage(e){return Object(i.a)(this,void 0,void 0,(function*(){const t=yield this.GetAppSettings(e.app);for(let n=0;n<this.apps.length;n++)if(this.apps[n].key==e.app){!this.apps[n].is_autolaunch&&t.is_autolaunch&&this.SetRestartRequired(),this.apps[n]=Object.assign(Object.assign({},this.apps[n]),t);break}}))}onHashChanged(){const e=window.location.hash;0===e.indexOf("#")?this.route=e.substring(1).split("/"):this.route=[]}get routePage(){return this.route.length>=1?this.route[0]:null}get routePageSection(){return this.route.length>=2?this.route[1]:null}setRoutePage(e){this.setRoute(e)}setRoutePageSection(e){this.setRoute(this.routePage,e)}setRoute(e,t){e=e||"",this.route=t?[e,t]:[e],window.location.hash=this.route.join("/")}SetDashboardFadeSupression(e,t){this.m_mailbox.connected&&this.m_mailbox.SendMessage(c.a.k_sDashboardMailboxName,{type:c.a.k_sSetDashboardFadeSupressionMessage,suppress_dashboard_fade:t,for_id:e})}SetDashboardForceBoundsVisible(e,t,n){this.m_mailbox.connected&&this.m_mailbox.SendMessage(c.a.k_sDashboardMailboxName,{type:c.a.k_sSetDashboardForceBoundsVisible,force_bounds_visible:n,for_overlay_key:e,for_id:t})}SetRestartRequired(){this.onRestartRequired&&this.onRestartRequired()}OnWebSocketOpen(e){this.connected=!0,this.WebSocketSend("settings_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("settings_close")}),f.GetSettingsInfo().then(e=>{this.systemInfo=e}),f.GetAppList().then(e=>{this.apps=e})}OnWebSocketClose(e){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(e){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(e)}OnWebSocketMessage(e){let t=JSON.parse(e.data);switch(t.jsonid){case"vr_settings":this.OnVRSettings(t);break;case"vr_settings_schema":this.OnVRSettingsSchema(t);break;case"vr_audio_devices":this.OnVRAudioDevices(t);break;case"vr_app_list":this.OnVRAppList(t);break;default:t.jsonid?console.log("Received unhandled event: "+t.jsonid):console.log("Received unknown message: ",t)}}OnVRSettings(e){for(let t in e.values){const n=e.values[t];if(this.settings.get(t)!=n||this.m_mapSettingsLastWriteInfo.has(t)){if(this.settingsSchema){const e=this.GetSettingSchema(t);e&&e.requires_restart&&this.SetRestartRequired()}this.SetSettingValueFromServer(t,n)}}}SetSettingValueFromServer(e,t){const n=1e3*_.SERVER_SETTING_MERGE_DEFER_DURATION;if(this.m_mapSettingsLastWriteInfo.has(e)){let i=this.m_mapSettingsLastWriteInfo.get(e);if((new Date).getTime()-i.nLastUserUpdateTime<n)return window.clearTimeout(i.nPendingServerValueUpdateTimeout),void(i.nPendingServerValueUpdateTimeout=window.setTimeout(()=>{this.SetSettingValueFromServer(e,t)},n));window.clearTimeout(i.nPendingServerValueUpdateTimeout),this.m_mapSettingsLastWriteInfo.delete(e)}this.settings.set(e,t)}UpdateLastUserWriteTimeForSetting(e){const t=(new Date).getTime();this.m_mapSettingsLastWriteInfo.has(e)?this.m_mapSettingsLastWriteInfo.get(e).nLastUserUpdateTime=t:this.m_mapSettingsLastWriteInfo.set(e,{nLastUserUpdateTime:t,nPendingServerValueUpdateTimeout:0})}OnVRSettingsSchema(e){null==this.settingsSchema&&(console.log("Got vr settings schema"),this.settingsSchema=e.schema,this.showInternalSettings=e.is_steamvr_main)}OnVRAudioDevices(e){console.log("Got audio devices"),this.audioDevices=e}OnVRAppList(e){this.apps=e.apps}SettingNameMatches(e,t){if(t.endsWith("*")){let n=t.length-1;return e.substr(0,n)==t.substr(0,n)}return e==t}GetSettingSchema(e){for(let t of this.settingsSchema)if(t.values)for(let n of t.values)if(this.SettingNameMatches(e,n.name))return n;return null}ResetSettingsValue(e){this.SetSettingsValue(e,null)}ResetSettingsValues(...e){e.forEach(this.ResetSettingsValue)}SetSettingsValue(e,t){let n=this.GetSettingSchema(e);null!=n?(null!=t&&("int"==n.type?t=parseInt(t):"float"==n.type?t=parseFloat(t):"string"==n.type?t=""+t:"bool"==n.type&&(t=!!t)),n.requires_restart&&this.SetRestartRequired(),this.SetSettingsStringValueWithoutSchema(e,t)):console.log("Tried to set setting "+e+" but it's not in the schema! Aborting")}SetSettingsStringValueWithoutSchema(e,t){if(VRHTML.IsAvailable()){const n=e.split("/");if(4!=n.length||""!=n[0]||"settings"!=n[1])throw new Error("bad settings path "+e);VRHTML.VRSettings.Set(n[2],n[3],t),this.settings.set(e,VRHTML.VRSettings.Get(n[2],n[3]))}else null!=t&&this.settings.set(e,t),this.pendingChanges.set(e,t);this.UpdateLastUserWriteTimeForSetting(e)}GetSettingsValue(e){return Object(i.a)(this,void 0,void 0,(function*(){return new Promise((function(t,n){r.a.get("/settings_get",{params:{name:e}}).then(e=>{t(e.data)}).catch(e=>{n(null)})}))}))}ResetAppSettings(e){return r.a.post("/app/resetsettings",{app:e}).then(t=>this.GetAppSettings(e)).catch(e=>{})}SetAppSettings(e,t){let n=Object.assign(Object.assign({},t),{app:e});r.a.post("/app/setsettings",n);for(let e=0;e<this.apps.length;e++)if(this.apps[e].key==n.app){!this.apps[e].is_autolaunch&&t.is_autolaunch&&this.SetRestartRequired(),this.apps[e]=Object.assign(Object.assign({},this.apps[e]),t);break}}GetAppSettings(e){return Object(i.a)(this,void 0,void 0,(function*(){return new Promise((function(t,n){r.a.get("/app/getsettings",{params:{app:e}}).then(e=>{t(e.data)}).catch(e=>{n(null)})}))}))}get NumSupersamplingSteps(){return Math.floor((h-u+.5*S)/S)}SliderposToSupersample(e){return e>h?h:e<u?u:e}get showAdvancedSettings(){return this.settings.get(d.i)}set showAdvancedSettings(e){this.SetSettingsValue(d.i,e)}showBindingCallouts(e){let t={type:"request_binding_callouts",app_key:e};this.m_mailbox.SendMessage("binding_callouts",t)}}_.SERVER_SETTING_MERGE_DEFER_DURATION=1,Object(i.b)([l.m],_.prototype,"connected",void 0),Object(i.b)([l.m],_.prototype,"settingsSchema",void 0),Object(i.b)([l.m],_.prototype,"settings",void 0),Object(i.b)([l.m],_.prototype,"systemInfo",void 0),Object(i.b)([l.m],_.prototype,"audioDevices",void 0),Object(i.b)([l.m],_.prototype,"apps",void 0),Object(i.b)([l.m],_.prototype,"showInternalSettings",void 0),Object(i.b)([l.m],_.prototype,"workshopStateChangedCanary",void 0),Object(i.b)([l.m],_.prototype,"pendingChanges",void 0),Object(i.b)([l.m],_.prototype,"route",void 0),Object(i.b)([o.bind],_.prototype,"OpenWebSocketToHost",null),Object(i.b)([o.bind],_.prototype,"OnWorkshopStateChangedMessage",null),Object(i.b)([o.bind],_.prototype,"OnChangeRouteMessage",null),Object(i.b)([o.bind],_.prototype,"OnAppConfigChangedMessage",null),Object(i.b)([l.d.bound],_.prototype,"onHashChanged",null),Object(i.b)([l.f],_.prototype,"routePage",null),Object(i.b)([l.f],_.prototype,"routePageSection",null),Object(i.b)([l.d],_.prototype,"setRoutePage",null),Object(i.b)([l.d],_.prototype,"setRoutePageSection",null),Object(i.b)([l.d],_.prototype,"setRoute",null),Object(i.b)([o.bind],_.prototype,"SetDashboardFadeSupression",null),Object(i.b)([o.bind],_.prototype,"SetDashboardForceBoundsVisible",null),Object(i.b)([o.bind],_.prototype,"SetRestartRequired",null),Object(i.b)([o.bind],_.prototype,"OnWebSocketOpen",null),Object(i.b)([o.bind],_.prototype,"OnWebSocketClose",null),Object(i.b)([o.bind],_.prototype,"WebSocketSend",null),Object(i.b)([o.bind],_.prototype,"OnWebSocketMessage",null),Object(i.b)([l.d],_.prototype,"OnVRSettings",null),Object(i.b)([l.d],_.prototype,"SetSettingValueFromServer",null),Object(i.b)([l.d],_.prototype,"OnVRSettingsSchema",null),Object(i.b)([l.d.bound],_.prototype,"ResetSettingsValue",null),Object(i.b)([l.d],_.prototype,"ResetSettingsValues",null),Object(i.b)([l.d],_.prototype,"SetSettingsValue",null),Object(i.b)([l.d],_.prototype,"SetSettingsStringValueWithoutSchema",null),Object(i.b)([l.f],_.prototype,"NumSupersamplingSteps",null);const f=new _;window.VRSettingsState=f},Z0gP:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA");class a{constructor(){this.m_wsWebSocketToServer=void 0,this.IdentifyController=function(e){return e?new Promise((function(t,n){r.a.get("/identify_controller.action?serial="+e).then(e=>{t()}).catch(e=>{n(e)})})):null},this.GetUSBDeviceList=function(){return new Promise((function(e,t){r.a.get("/usb_topology.action").then(t=>{e(t.data)}).catch(e=>{t(e)})}))},this.ToggleRoomOverview=function(e){return new Promise((function(t,n){r.a.get("/toggle_room_overview_feed.action?enabled="+(e?"1":"0")).then(e=>{t()}).catch(e=>{n(e)})}))}}OpenWebSocketToHost(){return new Promise((e,t)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",t=>{this.OnWebSocketOpen(t),e()}),this.m_wsWebSocketToServer.addEventListener("message",this.OnWebSocketMessage),this.m_wsWebSocketToServer.addEventListener("close",this.OnWebSocketClose)})}Init(){return Object(i.a)(this,void 0,void 0,(function*(){this.connected=!1,this.framerate=[],this.status={jsonid:"",startup_info:"",status_string:"",is_main:!1,is_perforce:!1,hostname:"",states:[]},this.roomoverview={jsonid:"",collision:[],playarea:[],devices:[],bounds_visible:!1,compositor_available:!1},yield this.OpenWebSocketToHost()}))}OnWebSocketOpen(e){this.connected=!0,this.WebSocketSend("websocket_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("websocket_close")})}OnWebSocketClose(e){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(e){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(e)}OnWebSocketMessage(e){let t=JSON.parse(e.data);switch(t.jsonid){case"vr_system_status":this.OnSystemStatusMessage(t);break;case"vr_framerate":this.OnFramerateMessage(t);break;case"vr_notifications":this.OnNotificationsMessage(t);break;case"vr_room_overview":this.OnRoomOverviewMessage(t);break;default:t.jsonid?console.log("Received unhandled event: "+t.jsonid):console.log("Received unknown message: ",t)}}OnSystemStatusMessage(e){this.status=e}OnFramerateMessage(e){for(this.framerate.unshift(e);this.framerate.length>60;)this.framerate.pop()}OnNotificationsMessage(e){let t=e.notifications.map((e,t)=>({title:e.sTitle,description:e.sDescription,timestamp:e.sTimeStamp}));this.notifications=t}OnRoomOverviewMessage(e){this.roomoverview=e}LaunchApplication(e){return new Promise((function(t,n){r.a.get("/steamvr_launch_application.action?param1="+e).then(e=>{t()}).catch(e=>{n(e)})}))}TEMP_RegisterPollingWebsocketMessage(e,t){setInterval(()=>{r.a.get(e).then(e=>{this.OnWebSocketMessage({data:JSON.stringify(e.data)})}).catch(e=>{})},t)}}Object(i.b)([l.m],a.prototype,"status",void 0),Object(i.b)([l.m],a.prototype,"framerate",void 0),Object(i.b)([l.m],a.prototype,"notifications",void 0),Object(i.b)([l.m],a.prototype,"roomoverview",void 0),Object(i.b)([l.m],a.prototype,"connected",void 0),Object(i.b)([o.bind],a.prototype,"OpenWebSocketToHost",null),Object(i.b)([o.bind],a.prototype,"OnWebSocketOpen",null),Object(i.b)([o.bind],a.prototype,"OnWebSocketClose",null),Object(i.b)([o.bind],a.prototype,"WebSocketSend",null),Object(i.b)([o.bind],a.prototype,"OnWebSocketMessage",null),Object(i.b)([o.bind],a.prototype,"TEMP_RegisterPollingWebsocketMessage",null);const c=new a;window.VRSystemState=c},dGfu:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var i=n("mrSG"),o=n("7wIv"),s=n("2vnA");class r{constructor(){this.m_wsWebSocketToServer=void 0,this.vecMessageBuffer=s.m.array()}OpenWebSocketToHost(){return new Promise((e,t)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",t=>{this.OnWebSocketOpen(t),e()}),this.m_wsWebSocketToServer.addEventListener("message",e=>{this.OnWebSocketMessage(e)}),this.m_wsWebSocketToServer.addEventListener("close",e=>{this.OnWebSocketClose(e)})})}Init(){return Object(i.a)(this,void 0,void 0,(function*(){this.connected||(this.vecMessages=[],Object(s.e)(()=>{this.vecMessages=this.vecMessages.concat(this.vecMessageBuffer.splice(0,this.vecMessageBuffer.length)).map((e,t)=>({item:e,index:t})).sort((e,t)=>e.item.nTimestamp-t.item.nTimestamp||e.index-t.index).map(({item:e})=>e)},{delay:300}),yield this.OpenWebSocketToHost())}))}OnWebSocketOpen(e){this.connected=!0,this.WebSocketSend("console_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("console_close")})}OnWebSocketClose(e){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(e){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(e)}OnWebSocketMessage(e){let t=JSON.parse(e.data);this.OnConsoleMessage(t)}OnConsoleMessage(e){let t=e.sMessage.indexOf("-");e.sTimestamp=e.sMessage.substr(0,t),e.sMessage=e.sMessage.substr(t+1),this.vecMessageBuffer.push(e)}}Object(i.b)([s.m],r.prototype,"connected",void 0),Object(i.b)([s.m],r.prototype,"vecMessages",void 0),Object(i.b)([o.bind],r.prototype,"OpenWebSocketToHost",null),Object(i.b)([o.bind],r.prototype,"OnWebSocketOpen",null),Object(i.b)([o.bind],r.prototype,"OnWebSocketClose",null),Object(i.b)([o.bind],r.prototype,"WebSocketSend",null),Object(i.b)([o.bind],r.prototype,"OnWebSocketMessage",null);const l=new r;window.VRConsoleState=l},dO2U:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA");class a{constructor(e){this.m_communityData=void 0,this.m_bLoadingData=!1,this.m_sSteamID=void 0,this.m_dateLastUpdate=void 0,this.m_sSteamID=e,e.length>0&&this.EnsureCommunityDataLoaded()}get community_data_ready(){return void 0!==this.m_communityData}get avatar_url(){return this.m_communityData&&this.m_communityData.avatar_url}get persona_name(){return this.m_communityData&&this.m_communityData.persona_name}get player_level(){return this.m_communityData&&this.m_communityData.level}get player_level_class(){return this.m_communityData&&this.m_communityData.level_class}get player_badge(){return this.m_communityData&&this.m_communityData.favorite_badge}get player_in_game(){return this.m_communityData&&this.m_communityData.in_game}EnsureCommunityDataLoaded(){if(void 0===this.m_communityData&&!this.m_bLoadingData){this.m_bLoadingData=!0;let e="https://steamcommunity.com/";r.a.get(e+"miniprofile/s"+this.m_sSteamID+"/json").then(e=>{let t=e.data;t&&t.avatar_url&&(this.m_communityData=t,this.m_dateLastUpdate=new Date),this.m_bLoadingData=!1}).catch(e=>{console.log(e),this.m_bLoadingData=!1})}}}Object(i.b)([l.m],a.prototype,"m_communityData",void 0),Object(i.b)([o.bind],a.prototype,"EnsureCommunityDataLoaded",null);class c{constructor(){this.m_SteamCommunityUsers=l.m.map()}GetUserInformation(e){return this.m_SteamCommunityUsers.has(e)||this.RequestUserInformation(e),this.m_SteamCommunityUsers.get(e)}RequestUserInformation(e){this.m_SteamCommunityUsers.hasOwnProperty(e)||this.m_SteamCommunityUsers.set(e,new a(e))}}Object(i.b)([l.m],c.prototype,"m_SteamCommunityUsers",void 0),Object(i.b)([o.bind],c.prototype,"GetUserInformation",null),Object(i.b)([o.bind],c.prototype,"RequestUserInformation",null);const d=new c;window.steamcommunity=d},hcOo:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return r}));n("q1tI");function i(e){let t=window.location.search.substring(1).split("&");for(let n=0;n<t.length;n++){let i=t[n].split("=");if(decodeURIComponent(i[0]).toUpperCase()==e.toUpperCase())return decodeURIComponent(i[1])}return""}function o(...e){return e.filter(e=>null!=e&&("string"==typeof e||e[1])).map(e=>"string"==typeof e?e:e[0]).join(" ")}function s(e,t){let n=t;for(;n.parentElement&&!e.some(e=>n.matches(e));)n=n.parentElement;return n}function r(e){let t=[],n=e.parentElement;for(;n;){const e=n.scrollWidth>n.clientWidth,i=n.scrollHeight>n.clientHeight;(e||i)&&t.push(n),n=n.parentElement}return t}},lbBr:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var i,o=n("mrSG"),s=n("q1tI"),r=n("i8i4"),l=n("7wIv"),a=n("hcOo"),c=n("GxMB"),d=n("2vnA"),p=n("EUJ1"),u=n("okNM");let h=i=class extends s.Component{constructor(e){super(e),this.m_elemModalContainer=null,this.m_elemModalPortal=null,this.m_ref=s.createRef(),this.state={elemBoundingParent:window.document.body,bInDOM:!1},this.m_elemModalPortal=document.createElement("div"),this.m_elemModalPortal.classList.add(i.ELEM_CLASS)}get modalContainer(){return this.m_ref.current?(null===this.m_elemModalContainer&&(this.m_elemModalContainer=Object(a.b)(["body","vsg-app","vsg-mountable","vsg-panel",...this.allowableParentSelectors],this.m_ref.current)),this.m_elemModalContainer):null}get allowableParentSelectors(){return this.props.allowableParentSelectors?this.props.allowableParentSelectors:[]}componentDidMount(){this.modalContainer.appendChild(this.m_elemModalPortal),window.addEventListener("keydown",this.onWindowKeyDown),this.setState({elemBoundingParent:Object(a.b)(["body","vsg-panel",...this.allowableParentSelectors],this.m_ref.current),bInDOM:!0}),i.modalStack.push(this)}componentWillUnmount(){this.modalContainer.removeChild(this.m_elemModalPortal),window.removeEventListener("keydown",this.onWindowKeyDown),i.modalStack.splice(i.modalStack.indexOf(this))}onWindowKeyDown(e){"Escape"==e.key&&this.props.onDismissRequested&&this.dismiss()}onBackdropClick(){this.props.onDismissRequested&&this.dismiss()}dismiss(){c.a.currentDropdown||i.modalStack.indexOf(this)<i.modalStack.length-1||this.props.onDismissRequested()}render(){if(!this.props.children||!this.m_elemModalPortal)return null;const e=i.modalStack.indexOf(this),t=i.modalStack.length-e-1,n=VRHTML.Environment()==p.VRHTMLEnvironment.Overlay&&t>0,o=this.state.elemBoundingParent.getBoundingClientRect();let l=Object.assign({},this.props);return delete l.onDismissRequested,delete l.backdropClassName,delete l.allowableParentSelectors,s.createElement(s.Fragment,null,s.createElement("div",{className:"ModalAnchor",ref:this.m_ref}),r.createPortal(s.createElement(s.Fragment,null,s.createElement("div",{className:"ModalBackdrop "+(this.props.backdropClassName?this.props.backdropClassName:""),style:{zIndex:3e3+2*e},onClick:this.onBackdropClick}),s.createElement("div",Object.assign({},l,{className:Object(a.a)("Modal",this.props.className,["FadedForModal",n]),style:{maxWidth:o.width-2*i.MODAL_BOUNDS_MARGIN,maxHeight:o.height-2*i.MODAL_BOUNDS_MARGIN,zIndex:3e3+2*e+1}}),this.state.bInDOM&&this.props.children)),this.m_elemModalPortal))}};h.modalStack=d.m.array([]),h.ELEM_CLASS="v-modal-portal",h.MODAL_BOUNDS_MARGIN=10,Object(o.b)([l.bind],h.prototype,"onWindowKeyDown",null),Object(o.b)([l.bind],h.prototype,"onBackdropClick",null),Object(o.b)([l.bind],h.prototype,"dismiss",null),h=i=Object(o.b)([u.a],h)},nAcY:function(e,t,n){"use strict";var i;n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),function(e){e[e.ButtonEnter=0]="ButtonEnter",e[e.ButtonLeave=1]="ButtonLeave",e[e.Snap=2]="Snap",e[e.Sliding=3]="Sliding"}(i||(i={}));class o{constructor(){}static get Instance(){return o.s_Instance||(o.s_Instance=new o),o.s_Instance}triggerHaptic(e){let t=0,n=0,o=0;switch(e){case i.ButtonEnter:t=0,n=1,o=.16;break;case i.ButtonLeave:t=0,n=1,o=.08;break;case i.Snap:t=0,n=1,o=.16;break;case i.Sliding:t=0,n=1,o=.06}o>0&&VRHTML.VROverlay.TriggerLaserMouseHapticVibration(VRHTML.VROverlay.ThisOverlayHandle(),t,n,o)}}o.s_Instance=null},pYJh:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return S}));var i,o=n("mrSG"),s=n("7wIv"),r=n("2vnA"),l=n("EUJ1"),a=n.n(l),c=n("GXif"),d=n("MYgy"),p=n("Kysl"),u=n("tUsp");!function(e){e[e.None=0]="None",e[e.List=1]="List",e[e.ViewBinding=2]="ViewBinding",e[e.EditBinding=3]="EditBinding",e[e.AppSelect=4]="AppSelect",e[e.Debugger=5]="Debugger",e[e.LegacyDebugger=6]="LegacyDebugger",e[e.TrackerEdit=7]="TrackerEdit",e[e.ControllerTester=8]="ControllerTester"}(i||(i={}));class h{constructor(){this.m_State=i.None,this.m_bLoading=!1,this.m_rBindingList=void 0,this.m_bShowBindingListError=!1,this.m_sBindingListError=void 0,this.m_timeoutLoading=void 0,this.m_pathUpdateTimer=void 0,this.m_bShowManifestError=!1,this.m_sManifestError=void 0,this.m_sManifestErrorPath=void 0,this.m_bStandaloneSettingsPage=!1,this.m_bDesktopMode=!1}Init(){window.addEventListener("popstate",this.OnPopState),history.pushState({direction:"back"},"back"),history.pushState({direction:"current"},"current"),history.pushState({direction:"forward"},"forward"),history.back();let e="bindingui/"+l.VRHTMLEnvironment[a.a.Environment()];this.m_mailbox=new l.CVRMailbox,this.m_mailbox.Init(e),this.m_mailbox.RegisterHandler("show_tracker_ui",this.OnShowTrackerUI),this.m_mailbox.RegisterHandler("show_app_select",this.OnShowAppSelect),this.m_mailbox.RegisterHandler("show_app_binding",this.OnShowAppBinding),Object(r.e)(this.UpdateWindowTitle)}ShowOverlayInDashboard(){this.IsRunningInDashboard&&a.a.VROverlay.ShowDashboard("system.vrwebhelper.controllerbinding")}OnShowTrackerUI(e){this.m_bStandaloneSettingsPage=!0,this.ShowTrackerEdit(),this.ShowOverlayInDashboard()}OnShowAppSelect(e){this.m_bStandaloneSettingsPage=!1,this.ShowAppSelect()}OnShowAppBinding(e){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,p.a.UpdateApplications().then(()=>{if(a.a.Environment()==l.VRHTMLEnvironment.Overlay&&this.ShowOverlayInDashboard(),!p.a.GetApp(e.app_key))return console.log("Warning: Could not find app key: "+e.app_key+" showing app select."),void this.ShowAppSelect();d.a.SetSelectedApp(e.app_key,!0),d.a.ReloadCurrentApp().then(()=>{if(e.controller_type)return d.a.SetSelectedController(e.controller_type,!0),void d.a.ReloadControllerConfiguration().then(()=>{e.action_set&&d.a.SetSelectedActionSet(e.action_set),this.Loading=!1,this.EditCurrentBinding()});this.Loading=!1,this.ShowBindingList()})})}OnTrackerBack(){this.m_bStandaloneSettingsPage?(this.ReturnToSettingsUI(),this.ShowAppSelect()):this.ShowBindingList()}SetStandaloneSettingsPage(e){this.m_bStandaloneSettingsPage=e}get ShouldShowTrackerBackButton(){return!this.m_bStandaloneSettingsPage||!this.m_bDesktopMode}SetDesktopMode(e){this.m_bDesktopMode=e}get DesktopMode(){return this.m_bDesktopMode}SetBindingListError(e){this.m_bShowBindingListError=null!=e,this.m_sBindingListError=e}get ShowBindingListError(){return this.m_bShowBindingListError}get BindingListError(){return this.m_sBindingListError}OnPopState(e){let t="";e.state&&e.state.direction&&(t=e.state.direction),"back"==t?(this.m_bStandaloneSettingsPage&&(this.SetStandaloneSettingsPage(!1),this.ReturnToSettingsUI()),this.GoBackPage(),history.forward()):"forward"==t&&(history.back(),this.GoForwardPage())}GoBackPage(){switch(this.m_State){default:case i.None:case i.AppSelect:break;case i.Debugger:case i.LegacyDebugger:case i.ControllerTester:case i.List:this.ShowAppSelect();break;case i.TrackerEdit:case i.EditBinding:case i.ViewBinding:this.ShowBindingList()}}GoForwardPage(){switch(this.m_State){default:case i.None:case i.AppSelect:this.ShowBindingList();break;case i.List:this.CurrentBinding.url==d.a.LoadedBindingURL?this.EditCurrentBinding():this.ViewCurrentBinding();break;case i.EditBinding:case i.ViewBinding:case i.TrackerEdit:}}get GetUIState(){return this.m_State}get BindingQueryResults(){return this.m_rBindingList}get Loading(){return this.m_bLoading}set Loading(e){this.m_bLoading=e,e?(this.m_timeoutLoading&&clearTimeout(this.m_timeoutLoading),this.m_timeoutLoading=window.setTimeout(()=>{this.Loading=!1},1e4)):this.m_timeoutLoading&&clearTimeout(this.m_timeoutLoading)}IsSafeToResetControllerType(e,t){return this.m_State==i.AppSelect||this.m_State==i.None||"TrackedDeviceClass_HMD"==e&&"TrackedDeviceClass_Controller"==t&&this.m_State!=i.TrackerEdit}EditCurrentBinding(){this.m_State=i.EditBinding}ViewCurrentBinding(){this.m_State=i.ViewBinding}ShowBindingList(e){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,this.RefreshBindingList().then(()=>{this.SetBindingListError(e),this.Loading=!1,this.m_State=i.List}).catch(()=>{this.Loading=!1})}get CurrentBinding(){if(this.BindingQueryResults)return S.BindingQueryResults.find(e=>e.url==d.a.SelectedBindingURL)}ReturnToSettingsUI(){this.ShowAppSelect(),this.IsRunningInDashboard&&a.a.ShowSettingsUI()}ShowAppSelect(){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,p.a.UpdateApplications().then(()=>{this.Loading=!1,this.m_State=i.AppSelect}).catch(()=>{this.Loading=!1})}ShowLegacyDebug(){this.m_State=i.LegacyDebugger}ShowControllerTester(){this.m_State=i.ControllerTester}UpdatePathsTimeout(){try{u.a.UpdatePaths().then(()=>{this.m_State==i.Debugger?this.m_pathUpdateTimer=window.setTimeout(this.UpdatePathsTimeout,500):this.m_pathUpdateTimer=void 0})}catch(e){console.log("Stopping debugger timer because",e)}}ShowDebugger(){this.Loading=!0,p.a.UpdateApplications().then(()=>{this.Loading=!1;let e=p.a.GetApp(d.a.SelectedApp);e&&e.client_container_handle&&u.a.AddSubscribedContainer(e.client_container_handle),this.m_State=i.Debugger,this.m_pathUpdateTimer=window.setTimeout(this.UpdatePathsTimeout,500)}).catch(()=>{this.Loading=!1})}ShowTrackerEdit(){this.m_State=i.TrackerEdit}ShouldShowBindingFailure(){return this.m_State!=i.TrackerEdit}RefreshBindingList(){return Object(o.a)(this,void 0,void 0,(function*(){this.Loading=!0,yield new Promise((e,t)=>{let n=d.a.SelectedControllerTypeInfo;d.a.QueryBindingList(d.a.SelectedApp,n?n.controller_type:"").then(t=>{t.success&&(this.m_rBindingList=t.results,this.Loading=!1,e())}).catch(()=>{this.Loading=!1})})}))}get IsRunningInDashboard(){return a.a.Environment()==l.VRHTMLEnvironment.Overlay}ShowActionManifestLoadFailed(e,t,n,i){let o=p.a.GetApp(e);this.m_sManifestError=Object(c.c)(t,o?o.name:e,n),this.m_sManifestErrorPath=i,this.m_bShowManifestError=!0,this.ShowAppSelect()}ManifestLoadErrorClose(){this.m_sManifestError=void 0,this.m_sManifestErrorPath=void 0,this.m_bShowManifestError=!1}get ShowManifestError(){return this.m_bShowManifestError}get ManifestError(){return this.m_sManifestError}get ManifestErrorPath(){return this.m_sManifestErrorPath}ShowActionOrigins(e,t,n){p.a.UpdateApplications().then(()=>{d.a.SetSelectedApp(e),t&&d.a.SetSelectedActionSet(t),S.ViewCurrentBinding(),a.a.ShowBindingUI(!this.IsRunningInDashboard)})}UpdateWindowTitle(){setTimeout(()=>{switch(this.GetUIState){case i.AppSelect:document.title=Object(c.c)("#BindingUI_WindowTitle_ControllerSettings");break;case i.Debugger:case i.EditBinding:case i.List:case i.None:case i.ViewBinding:document.title=Object(c.c)("#BindingUI_WindowTitle_ControllerBinding");break;case i.TrackerEdit:document.title=Object(c.c)("#BindingUI_WindowTitle_ManageTrackers")}},0)}}Object(o.b)([r.m],h.prototype,"m_State",void 0),Object(o.b)([r.m],h.prototype,"m_bLoading",void 0),Object(o.b)([r.m],h.prototype,"m_rBindingList",void 0),Object(o.b)([r.m],h.prototype,"m_bShowBindingListError",void 0),Object(o.b)([r.m],h.prototype,"m_sBindingListError",void 0),Object(o.b)([r.m],h.prototype,"m_bShowManifestError",void 0),Object(o.b)([r.m],h.prototype,"m_sManifestError",void 0),Object(o.b)([r.m],h.prototype,"m_sManifestErrorPath",void 0),Object(o.b)([r.m],h.prototype,"m_bDesktopMode",void 0),Object(o.b)([s.bind],h.prototype,"OnShowTrackerUI",null),Object(o.b)([s.bind],h.prototype,"OnShowAppSelect",null),Object(o.b)([s.bind],h.prototype,"OnShowAppBinding",null),Object(o.b)([s.bind],h.prototype,"OnTrackerBack",null),Object(o.b)([r.f],h.prototype,"ShouldShowTrackerBackButton",null),Object(o.b)([r.f],h.prototype,"DesktopMode",null),Object(o.b)([s.bind],h.prototype,"SetBindingListError",null),Object(o.b)([r.f],h.prototype,"ShowBindingListError",null),Object(o.b)([r.f],h.prototype,"BindingListError",null),Object(o.b)([s.bind],h.prototype,"OnPopState",null),Object(o.b)([s.bind],h.prototype,"GoBackPage",null),Object(o.b)([s.bind],h.prototype,"GoForwardPage",null),Object(o.b)([r.f],h.prototype,"GetUIState",null),Object(o.b)([r.f],h.prototype,"BindingQueryResults",null),Object(o.b)([r.f],h.prototype,"Loading",null),Object(o.b)([s.bind],h.prototype,"IsSafeToResetControllerType",null),Object(o.b)([s.bind],h.prototype,"EditCurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ViewCurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ShowBindingList",null),Object(o.b)([r.f],h.prototype,"CurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ReturnToSettingsUI",null),Object(o.b)([s.bind],h.prototype,"ShowAppSelect",null),Object(o.b)([s.bind],h.prototype,"ShowLegacyDebug",null),Object(o.b)([s.bind],h.prototype,"ShowControllerTester",null),Object(o.b)([s.bind],h.prototype,"UpdatePathsTimeout",null),Object(o.b)([s.bind],h.prototype,"ShowDebugger",null),Object(o.b)([s.bind],h.prototype,"ShowTrackerEdit",null),Object(o.b)([s.bind],h.prototype,"RefreshBindingList",null),Object(o.b)([r.f],h.prototype,"IsRunningInDashboard",null),Object(o.b)([r.d],h.prototype,"ShowActionManifestLoadFailed",null),Object(o.b)([r.d],h.prototype,"ManifestLoadErrorClose",null),Object(o.b)([r.f],h.prototype,"ShowManifestError",null),Object(o.b)([r.f],h.prototype,"ManifestError",null),Object(o.b)([r.f],h.prototype,"ManifestErrorPath",null),Object(o.b)([r.d],h.prototype,"ShowActionOrigins",null),Object(o.b)([s.bind],h.prototype,"UpdateWindowTitle",null);const S=new h;window.inputUI=S},tUsp:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA");class a{constructor(){this.contents=l.m.map()}}Object(i.b)([l.m],a.prototype,"contents",void 0);class c{constructor(){this.m_Containers=l.m.map()}Init(){return Object(i.a)(this,void 0,void 0,(function*(){this.AddSubscribedContainer("25769803776"),yield this.UpdatePaths()}))}AddSubscribedContainer(e){if(!this.m_Containers.has(e)){let t=new a;t.handle=e,this.m_Containers.set(e,t)}}UpdateContainer(e,t){this.AddSubscribedContainer(e);let n=this.m_Containers.get(e);n.contents.clear(),t.entries.forEach(e=>{null!=e.path&&n.contents.set(e.path,e)})}QueryContainer(e){return Object(i.a)(this,void 0,void 0,(function*(){return new Promise((function(t,n){r.a.get("/properties.json?container="+e).then(n=>{t([e,n.data])}).catch(t=>{n([e,t])})}))}))}UpdatePaths(){return Object(i.a)(this,void 0,void 0,(function*(){let e=[];this.m_Containers.forEach(t=>{e.push(this.QueryContainer(t.handle))});try{(yield Promise.all(e)).forEach(e=>{2!=e.length?console.log("Failed to update container. ",e.length,"entries in array"):"string"==typeof e[1]?console.log("Failed to update container ",e[0],":",e[1]):this.UpdateContainer(e[0],e[1])})}catch(e){throw console.log(e),e}}))}GetAllActions(e){if(!this.m_Containers.has(e))return;let t=[];return this.m_Containers.get(e).contents.forEach(e=>{"k_unActionPropertyTag"==e.type&&null!=e.path&&t.push(e.path)}),t}GetActionValue(e,t){if(!this.m_Containers.has(e))return;let n=this.m_Containers.get(e);if(!n.contents.has(t))return;let i=n.contents.get(t);return"k_unActionPropertyTag"==i.type?i.value:void 0}GetAllInputValues(e){if(!this.m_Containers.has(e))return;let t=[];return this.m_Containers.get(e).contents.forEach(e=>{"k_unInputValuePropertyTag"==e.type&&null!=e.path&&t.push(e.path)}),t}GetInputValue(e,t){if(!this.m_Containers.has(e))return;let n=this.m_Containers.get(e);if(!n.contents.has(t))return;let i=n.contents.get(t);if("k_unInputValuePropertyTag"!=i.type)return;let o=i.value;return o.length<1?void 0:o[0]}GetScalarInputValue(e,t){let n=this.GetInputValue(e,t);return null==n||"scalar"!=n.type?0:n.value}GetBooleanInputValue(e,t){let n=this.GetInputValue(e,t);return null!=n&&"boolean"==n.type&&n.value}}Object(i.b)([l.m],c.prototype,"m_Containers",void 0),Object(i.b)([o.bind],c.prototype,"AddSubscribedContainer",null),Object(i.b)([l.d],c.prototype,"UpdateContainer",null),Object(i.b)([o.bind],c.prototype,"GetAllActions",null),Object(i.b)([o.bind],c.prototype,"GetActionValue",null),Object(i.b)([o.bind],c.prototype,"GetAllInputValues",null),Object(i.b)([o.bind],c.prototype,"GetInputValue",null),Object(i.b)([o.bind],c.prototype,"GetScalarInputValue",null),Object(i.b)([o.bind],c.prototype,"GetBooleanInputValue",null);const d=new c;window.paths=d},uFkT:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var i=n("mrSG"),o=n("2vnA"),s=n("vDqi"),r=n.n(s),l=n("7wIv"),a=n("GXif"),c=n("EUJ1");class d{constructor(){this.m_InputState=void 0,this.m_KnownControllerTypes=o.m.map(),this.m_mailbox=new c.CVRMailbox,this.m_bUpdateInputStateOnControllerTypChange=!1}Init(e){return this.m_mailbox.Init("input_state"),this.m_mailbox.RegisterHandler("controller_type_changed",this.OnControllerTypeChanged),null!=e&&(this.m_bUpdateInputStateOnControllerTypChange=e),this.GetInputState()}OnControllerTypeChanged(e){this.UpdateControllerTypes(e.controller_types),this.m_InputState.controller_types=e.controller_types,this.m_bUpdateInputStateOnControllerTypChange&&this.GetInputState()}get ConnectedDevices(){return null==this.m_InputState?Array():this.m_InputState.devices.filter(e=>"TrackedDeviceClass_Controller"==e.class||"TrackedDeviceClass_HMD"==e.class||"TrackedDeviceClass_GenericTracker"==e.class)}get ControllerTypes(){return this.m_InputState.controller_types}get ShouldSendSystemButtonToAllApps(){return this.m_InputState.send_system_button_to_all_apps}get ShowHiddenInputs(){return this.m_InputState.show_hidden_inputs}get IsSteamAvailable(){return!this.m_InputState||this.m_InputState.is_steam_available}get BDevMode(){return this.m_InputState.dev_mode}get IsValid(){return null!=this.m_InputState}get CurrentUserPersonaName(){return this.m_InputState.current_user_persona_name?this.m_InputState.current_user_persona_name:null}GetControllerTypeInfo(e){return this.m_InputState.controller_types.find(t=>t.controller_type==e)}GetDeviceInfo(e){for(let t of this.m_InputState.devices)if(t.root_path==e||t.device_path==e)return t;return null}LocalizeControllerString(e,t){let n=Object(a.c)("#"+t);return n!="#"+t?n:e&&this.m_InputState&&this.m_InputState.localization.hasOwnProperty(e.resource_root)&&this.m_InputState.localization[e.resource_root].hasOwnProperty(t.toLowerCase())?this.m_InputState.localization[e.resource_root][t.toLowerCase()]:t}LocalizeDriverString(e,t){let n=Object(a.c)("#"+t);return n!="#"+t?n:this.m_InputState&&this.m_InputState.localization.hasOwnProperty(e)&&this.m_InputState.localization[e].hasOwnProperty(t.toLowerCase())?this.m_InputState.localization[e][t.toLowerCase()]:t}UpdateControllerTypes(e){this.m_KnownControllerTypes.clear();for(let t of e)this.m_KnownControllerTypes.set(t.controller_type,t)}GetInputState(){return Object(i.a)(this,void 0,void 0,(function*(){yield new Promise((function(e,t){r.a.get("/input/getstate.json").then(t=>{e(t.data)}).catch(e=>{t(e)})})).then(e=>{console.log("GetInputState: ",e);for(let t of e.controller_types)t.controller_type=t.controller_type.toLowerCase();for(let t of e.devices)t.controller_type=t.controller_type.toLowerCase();this.UpdateControllerTypes(e.controller_types),this.m_InputState=e})}))}get KnownControllerTypes(){return this.m_KnownControllerTypes}FindDeviceClassForControllerType(e){let t=this.GetControllerTypeInfo(e);return null==t?void 0:t.device_class}FindRootPathForControllerType(e){for(let t of this.m_InputState.devices)if(t.controller_type==e)return t.root_path;return null}}Object(i.b)([o.m],d.prototype,"m_InputState",void 0),Object(i.b)([o.m],d.prototype,"m_KnownControllerTypes",void 0),Object(i.b)([l.bind],d.prototype,"OnControllerTypeChanged",null),Object(i.b)([o.f],d.prototype,"ConnectedDevices",null),Object(i.b)([o.f],d.prototype,"ControllerTypes",null),Object(i.b)([o.f],d.prototype,"ShouldSendSystemButtonToAllApps",null),Object(i.b)([o.f],d.prototype,"ShowHiddenInputs",null),Object(i.b)([o.f],d.prototype,"IsSteamAvailable",null),Object(i.b)([o.f],d.prototype,"BDevMode",null),Object(i.b)([o.f],d.prototype,"IsValid",null),Object(i.b)([o.f],d.prototype,"CurrentUserPersonaName",null),Object(i.b)([l.bind],d.prototype,"GetControllerTypeInfo",null),Object(i.b)([l.bind],d.prototype,"LocalizeControllerString",null),Object(i.b)([l.bind],d.prototype,"LocalizeDriverString",null),Object(i.b)([o.d],d.prototype,"UpdateControllerTypes",null),Object(i.b)([o.d],d.prototype,"GetInputState",null),Object(i.b)([o.f],d.prototype,"KnownControllerTypes",null),Object(i.b)([l.bind],d.prototype,"FindDeviceClassForControllerType",null);const p=new d;window.inputState=p}}]);
//# sourceMappingURL=vrwebui_shared.js.map?v=17c42c195ba9b94c0590