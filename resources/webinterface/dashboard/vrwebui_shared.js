/*!
 * (c) Valve Corporation. Use is governed by the terms of the Steam Subscriber Agreement http://store.steampowered.com/subscriber_agreement/. 
 * 
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"6YgL":function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return p}));var i=n("mrSG"),o=n("q1tI"),s=n("7wIv"),r=n("CzjV"),l=n("EUJ1"),a=n("nAcY"),c=n("hcOo");class d extends o.Component{constructor(){super(...arguments),this.m_ref=o.createRef()}get elem(){return this.m_ref.current}onClick(t){VRHTML.Environment()==l.VRHTMLEnvironment.Overlay&&(p.temporarilySuppressSoundEffect(),r.b.Instance.playSound(r.a.PanoramaButtonClick)),this.props.onClick&&this.props.onClick(t)}onMouseEnter(t){VRHTML.Environment()==l.VRHTMLEnvironment.Overlay&&a.b.Instance.triggerHaptic(a.a.ButtonEnter),this.props.onMouseEnter&&this.props.onMouseEnter(t)}onMouseLeave(t){VRHTML.Environment()==l.VRHTMLEnvironment.Overlay&&a.b.Instance.triggerHaptic(a.a.ButtonLeave),this.props.onMouseLeave&&this.props.onMouseLeave(t)}render(){const t=!1===this.props.enabled;let e=Object.assign({},this.props);return delete e.enabled,e.className=Object(c.a)(e.className,["Disabled",t]),o.cloneElement(o.createElement("div",e,this.props.children),{onClick:t?null:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,ref:this.m_ref})}}Object(i.b)([s.bind],d.prototype,"onClick",null),Object(i.b)([s.bind],d.prototype,"onMouseEnter",null),Object(i.b)([s.bind],d.prototype,"onMouseLeave",null);class p extends o.Component{static temporarilySuppressSoundEffect(){window.clearTimeout(this.s_nPlaySoundEffectTimeout),this.s_nPlaySoundEffectTimeout=0,window.clearTimeout(this.s_nSuppressingSoundEffectsTimeout),this.s_nSuppressingSoundEffectsTimeout=window.setTimeout(this.endSoundEffectSuppression,this.k_nSoundEffectSuppressionPeriod)}static get suppressingSoundEffect(){return this.s_nSuppressingSoundEffectsTimeout>0}onClick(t){p.suppressingSoundEffect||(window.clearTimeout(p.s_nPlaySoundEffectTimeout),p.s_nPlaySoundEffectTimeout=window.setTimeout(p.playSoundEffect,p.k_nSoundEffectDelay)),this.props.onClick&&this.props.onClick(t)}static endSoundEffectSuppression(){window.clearTimeout(this.s_nSuppressingSoundEffectsTimeout),this.s_nSuppressingSoundEffectsTimeout=0}static playSoundEffect(){VRHTML.Environment()===l.VRHTMLEnvironment.Overlay&&r.b.Instance.playSound(r.a.PanoramaSurfaceClick)}render(){return o.cloneElement(o.createElement("div",this.props,this.props.children),{onClick:this.onClick})}}p.k_nSoundEffectSuppressionPeriod=4,p.k_nSoundEffectDelay=2,p.s_nSuppressingSoundEffectsTimeout=0,p.s_nPlaySoundEffectTimeout=0,Object(i.b)([s.bind],p.prototype,"onClick",null),Object(i.b)([s.bind],p,"endSoundEffectSuppression",null),Object(i.b)([s.bind],p,"playSoundEffect",null)},"7uy8":function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"k",(function(){return o})),n.d(e,"o",(function(){return s})),n.d(e,"q",(function(){return r})),n.d(e,"i",(function(){return l})),n.d(e,"l",(function(){return a})),n.d(e,"m",(function(){return c})),n.d(e,"p",(function(){return d})),n.d(e,"n",(function(){return p})),n.d(e,"e",(function(){return u})),n.d(e,"r",(function(){return h})),n.d(e,"s",(function(){return S})),n.d(e,"f",(function(){return m})),n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return b})),n.d(e,"d",(function(){return _})),n.d(e,"a",(function(){return f})),n.d(e,"h",(function(){return y})),n.d(e,"j",(function(){return O}));const i="openvr.tool.steamvr_environments",o="system.generated.steam.exe",s="steam.app.250820",r="steam.app.330050",l="system.settings",a="valve.steam.bigpicture",c="valve.steam.desktop",d="system.desktop",p="valve.steam",u="/settings/steamvr/enableHomeApp",h="/settings/steamvr/supersampleManualOverride",S="/settings/steamvr/supersampleScale",m="/settings/GpuSpeed/gpuSpeedRenderTargetScale",g="/settings/camera/cameraRoomViewMode",b="/settings/steamvr/backgroundCameraHeight",_="/settings/steamvr/backgroundDomeRadius",f="/settings/steamvr/analogGain",y="/settings/driver_lighthouse/indexHmdColumnCorrection",O="/settings/steamvr/showAdvancedSettings"},CzjV:function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),function(t){t[t.PanoramaButtonClick=0]="PanoramaButtonClick",t[t.PanoramaSurfaceClick=1]="PanoramaSurfaceClick",t[t.VolumePreview=2]="VolumePreview"}(i||(i={}));class o{constructor(){this.m_mapSoundElems=new Map}static get Instance(){return o.s_Instance||(o.s_Instance=new o),o.s_Instance}getSoundEffectPath(t){switch(t){case i.PanoramaButtonClick:return"/dashboard/sounds/activation.wav";case i.PanoramaSurfaceClick:return"/dashboard/sounds/activation_change_fail.wav";case i.VolumePreview:return"/dashboard/sounds/volume_change.wav"}}playSound(t){if(!this.m_mapSoundElems.has(t)){let e=document.createElement("audio");e.src=this.getSoundEffectPath(t),this.m_mapSoundElems.set(t,e)}const e=this.m_mapSoundElems.get(t);e.pause(),e.currentTime=0,e.play()}}o.s_Instance=null},DwIg:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var i=n("mrSG"),o=n("q1tI"),s=n("PShe"),r=n.n(s),l=(n("Wmp0"),n("7wIv"));class a{constructor(t,e,n){this.sValue=t,this.sLocalized=e,this.sRequiredLocalized=n}}class c extends o.Component{constructor(t){super(t),this.state={sSelectedOption:this.props.sValueSelectedItem,bVisible:!1}}componentWillMount(){null!=this.props.bShowOptionsOnStart&&this.setState({bVisible:this.props.bShowOptionsOnStart})}componentWillReceiveProps(t){null!=t.bShowOptionsOnStart&&t.bShowOptionsOnStart!=this.props.bShowOptionsOnStart&&this.setState({bVisible:t.bShowOptionsOnStart})}Show(t){this.setState({bVisible:!0}),t.stopPropagation()}Hide(t){this.setState({bVisible:!1}),t&&t.stopPropagation()}OnOptionChanged(t,e){this.setState({sSelectedOption:e}),this.props.fnOptionSelected(e),this.Hide(t)}render(){let t=this.props.vecOptions.map((t,e)=>{if("-"==t.sValue)return o.createElement("div",{key:e,className:"InlineSeparator"});if("-blank"==t.sValue)return o.createElement("div",{key:e,className:"InlineBlankSeparator"},t.sLocalized);if("-nonitem"==t.sValue)return o.createElement("div",{key:e,className:"InlineNonItemSeparator"},t.sLocalized);if("-subHeader"==t.sValue)return o.createElement("div",{key:e,className:"InlineSubHeaderSeparator"},t.sLocalized);{let n,i="InlineDropdownItem";return this.props.sValueSelectedItem==t.sValue&&(i+=" Selected"),null!=t.sRequiredLocalized&&(n=o.createElement("span",{className:"BindingLabelActionRequirement"},t.sRequiredLocalized)),o.createElement("div",{key:e,className:i,onClick:e=>{this.OnOptionChanged(e,t.sValue)}},t.sLocalized,n)}}),e="InlineDropdownLabel "+(null==this.props.sHeaderClass?"":this.props.sHeaderClass),n="InlineOptionsDropDownRodal "+(null==this.props.sModalClass?"":this.props.sModalClass);let i=this.props.sLocalizedSelectedItem;!i&&this.state.sSelectedOption&&this.props.vecOptions.forEach(t=>{t.sValue==this.state.sSelectedOption&&(i=t.sLocalized)});let s=this.props.bReadOnly?()=>{}:this.Show;return o.createElement("div",{className:e,onClick:s},i&&o.createElement("div",{className:this.props.sMainButtonClass},i),o.createElement(r.a,{visible:this.state.bVisible,onClose:this.Hide,customStyles:{width:"60%",height:"fit-content",maxHeight:"90%",display:"flex"},showCloseButton:!1,animation:"fade",className:n,closeOnEsc:!0},this.state.bVisible&&o.createElement("div",{className:"FlexColumn InlineDropdownModalWrapper"},this.props.sModalTitleString&&o.createElement("div",{className:"Label ModalHeader"},this.props.sModalTitleString),o.createElement("div",{className:"FlexColumn InlineDropdownItemWrapper"},t))))}}Object(i.b)([l.bind],c.prototype,"Show",null),Object(i.b)([l.bind],c.prototype,"Hide",null),Object(i.b)([l.bind],c.prototype,"OnOptionChanged",null)},GXif:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return a}));n("q1tI");var i=n("vDqi"),o=n.n(i);class s{constructor(){this.m_mapTokens=new Map,this.m_mapFallbackTokens=new Map}InitFromObjects(t,e,n,i){this.m_mapTokens.clear();let o=[e,t,i,n];for(let t in o){let e=o[t];for(let t in e){let n=e[t];for(let t in n){let e=t.toLowerCase();this.m_mapTokens.has(e)||this.m_mapTokens.set(e,n[t])}}}}LocalizeString(t){if(!t||0==t.length||"#"!=t.charAt(0))return"";let e=this.m_mapTokens.get(t.substring(1).toLowerCase());return void 0===e?"":e}LocalizeStringFromFallback(t){if(!t||0==t.length||"#"!=t.charAt(0))return"";let e=this.m_mapFallbackTokens.get(t.substring(1).toLowerCase());return void 0===e?"":e}static GetLocale(){const t=navigator.languages[0];try{const e=VRHTML.IsAvailable()?VRHTML.GetSystemLocale():null;if(null==e)return t;s.s_Date.toLocaleTimeString(e);return e}catch(e){return t}}}function r(t,...e){let n=l.LocalizeString(t);return n?(e.length>0&&(n=n.replace(/%(\d+)\$s/g,(function(t,n){return void 0!==e[n-1]?String(e[n-1]):t}))),n):t}s.s_Date=new Date;const l=new s;function a(t,e){null==e&&(e=function(){let t=new Map([["en","english"],["de","german"],["fr","french"],["it","italian"],["ko","korean"],["es-419","latam"],["es","spanish"],["zh-CN","schinese"],["zh-TW","tchinese"],["ru","russian"],["th","thai"],["ja","japanese"],["pt","portuguese"],["pl","polish"],["da","danish"],["nl","dutch"],["fi","finnish"],["no","norwegian"],["sv","swedish"],["hu","hungarian"],["cs","czech"],["ro","romanian"],["tr","turkish"],["pt-BR","brazilian"],["bg","bulgarian"],["el","greek"],["uk","ukranian"],["vi","vietnamese"]]);for(let e of navigator.languages){let n=e.split("-");if(t.has(e))return t.get(e);if(t.has(n[0]))return t.get(n[0])}return"english"}());let n=[],i=(t,e,n)=>{let i,s=Date.now().toString();return i="webhelper"==t?`/dashboard/localization/${t}_${e}.json?t=${s}`:`localization/${t}_${e}.json?t=${s}`,o.a.get(i).then(t=>{n(t.data)}).catch(()=>{})},s=[],r=[],a=[],c=[];for(let o of t)n.push(i(o,e,t=>{s.push(t)})),"english"!=e&&n.push(i(o,"english",t=>{a.push(t)}));for(let t of["webhelper"])n.push(i(t,e,t=>{r.push(t)})),"english"!=e&&n.push(i(t,"english",t=>{c.push(t)}));return Promise.all(n).then(()=>{l.InitFromObjects(s,r,a,c)})}window.LocalizationManager=l},GxMB:function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return h}));var i=n("mrSG"),o=n("q1tI"),s=n("i8i4"),r=n("6YgL"),l=n("hcOo"),a=n("7wIv"),c=n.n(a),d=n("2vnA"),p=n("GXif");class u extends o.Component{constructor(t){super(t),this.m_elemBoundingParent=window.document.body,this.m_elemDropdownsContainer=null,this.m_elemDropdownPortal=null,this.m_refButton=o.createRef(),this.m_refPopover=o.createRef(),this.m_refSelectedButton=o.createRef(),this.m_rScrollableParents=[],this.state={bShowingOptions:!1},this.m_elemDropdownPortal=document.createElement("div"),this.m_elemDropdownPortal.classList.add(u.ELEM_CLASS)}get dropdownsContainer(){return this.m_refButton.current?(null===this.m_elemDropdownsContainer&&(this.m_elemDropdownsContainer=Object(l.b)(["body",".SettingsMain","vsg-app","vsg-mountable","vsg-panel"],this.m_refButton.current.elem)),this.m_elemDropdownsContainer):null}componentDidMount(){this.m_elemBoundingParent=Object(l.b)(["body","vsg-panel",".SettingsSidebarPageContainer"],this.m_refButton.current.elem),this.dropdownsContainer.appendChild(this.m_elemDropdownPortal),window.addEventListener("keydown",this.onWindowKeyDown),window.addEventListener("click",this.onWindowClick)}componentWillUnmount(){this.dropdownsContainer.removeChild(this.m_elemDropdownPortal),window.removeEventListener("keydown",this.onWindowKeyDown),window.removeEventListener("click",this.onWindowClick);for(let t of this.m_rScrollableParents)t.removeEventListener("scroll",this.onParentScroll)}componentDidUpdate(t,e){if(this.state.bShowingOptions&&!e.bShowingOptions){this.updateScrollableParents();const t=this.m_refButton.current.elem.getBoundingClientRect();let e=t.left,n=t.top;const i=this.m_refPopover.current.getBoundingClientRect(),o=this.m_elemBoundingParent.getBoundingClientRect(),s=o.left+u.POPOVER_BOUNDS_MARGIN,r=o.right-u.POPOVER_BOUNDS_MARGIN,l=o.top+u.POPOVER_BOUNDS_MARGIN,a=o.bottom-u.POPOVER_BOUNDS_MARGIN;if(this.m_refSelectedButton.current){n-=this.m_refSelectedButton.current.elem.getBoundingClientRect().top-i.top}const c=n;e<s&&(e=s),e+i.width>r&&(e=r-i.width),n<l&&(n=l),n+i.height>a&&(n=a-i.height),e=Math.round(e),n=Math.round(n),this.m_refPopover.current.scrollTop=n-c,this.m_refPopover.current.style.transform="translateX("+e+"px) translateY("+n+"px)",u.currentDropdown=this}else!this.state.bShowingOptions&&e.bShowingOptions&&u.currentDropdown==this&&(u.currentDropdown=null)}onWindowKeyDown(t){"Escape"==t.key&&this.hideDropdown()}onWindowClick(t){!this.m_refPopover.current||this.m_refPopover.current.contains(t.target)||this.m_refButton.current.elem.contains(t.target)||this.hideDropdown()}updateScrollableParents(){for(let t of this.m_rScrollableParents)t.removeEventListener("scroll",this.onParentScroll);this.m_rScrollableParents=Object(l.d)(this.m_refButton.current.elem);for(let t of this.m_rScrollableParents)t.addEventListener("scroll",this.onParentScroll)}onParentScroll(){this.hideDropdown()}setValue(t){this.props.onChange&&this.props.onChange(t),this.hideDropdown()}get value(){return void 0!==this.props.value?this.props.value:null}get selectedItem(){const t=this.value;for(let e of this.props.items)if(e.value==t)return e;return null}showDropdown(){this.setState({bShowingOptions:!0})}hideDropdown(){this.setState({bShowingOptions:!1})}render(){const t=this.selectedItem,e=void 0!==this.props.defaultLabel?this.props.defaultLabel:Object(p.c)("#Settings_SelectAnOption"),n=t?t.sLabel:e,i=this.m_refButton.current?this.m_refButton.current.elem.clientWidth:0,a=this.m_elemBoundingParent.getBoundingClientRect();return o.createElement(o.Fragment,null,o.createElement(r.a,{ref:this.m_refButton,className:"ButtonControl Dropdown",onClick:this.showDropdown,enabled:this.props.items&&this.props.items.length>1,style:{pointerEvents:this.state.bShowingOptions?"none":"initial"}},o.createElement("span",null,n)),this.state.bShowingOptions&&s.createPortal(o.createElement("div",{ref:this.m_refPopover,className:"Dropdown Popover",style:{minWidth:i,maxWidth:a.width-2*u.POPOVER_BOUNDS_MARGIN,maxHeight:a.height-2*u.POPOVER_BOUNDS_MARGIN}},this.props.items.map(t=>o.createElement(r.a,{key:t.value.toString(),ref:t==this.selectedItem?this.m_refSelectedButton:null,className:Object(l.a)("DropdownPopoverButton",["Selected",t==this.selectedItem]),onClick:()=>this.setValue(t.value)},t.sLabel))),this.m_elemDropdownPortal))}}u.currentDropdown=null,u.ELEM_CLASS="v-dropdown-portal",u.POPOVER_BOUNDS_MARGIN=10,Object(i.b)([c.a],u.prototype,"onWindowKeyDown",null),Object(i.b)([c.a],u.prototype,"onWindowClick",null),Object(i.b)([c.a],u.prototype,"onParentScroll",null),Object(i.b)([c.a],u.prototype,"setValue",null),Object(i.b)([d.f],u.prototype,"value",null),Object(i.b)([d.f],u.prototype,"selectedItem",null),Object(i.b)([c.a],u.prototype,"showDropdown",null),Object(i.b)([c.a],u.prototype,"hideDropdown",null),Object(i.b)([d.m],u,"currentDropdown",void 0);class h extends o.Component{constructor(t){super(t),this.state={value:void 0===t.value?null:t.value}}onChange(t){this.setState({value:t}),this.props.onChange&&this.props.onChange(t)}render(){let t=Object.assign({},this.props);return t.onChange=this.onChange,t.value=this.state.value,o.createElement(u,Object.assign({},t))}}Object(i.b)([c.a],h.prototype,"onChange",null)},Kysl:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA");class a{constructor(){this.m_Applications=l.m.map(),this.m_sceneApplicationStateChangedEventHandle=null}Init(){return Object(i.a)(this,void 0,void 0,(function*(){VRHTML.IsAvailable()&&(this.m_sceneApplicationStateChangedEventHandle=VRHTML.RegisterForSceneApplicationStateChangedEvents(this.onSceneApplicationStateChanged)),yield this.UpdateApplications()}))}onSceneApplicationStateChanged(){this.UpdateApplications()}SetApplicationMap(t){this.m_Applications.clear(),t.apps.forEach(t=>{this.m_Applications.set(t.key,t)})}UpdateApplications(){return Object(i.a)(this,void 0,void 0,(function*(){yield this.QueryApplications().then(t=>{this.SetApplicationMap(t)})}))}QueryApplications(){return new Promise((function(t,e){r.a.get("/app/list.json").then(e=>{t(e.data)}).catch(t=>{e(t)})}))}GetAppImageURL(t){let e="/app/image?app_key="+t;return VRHTML.IsAvailable()&&(e+="&version="+VRHTML.SteamVRVersion()),e}GetApp(t){return this.m_Applications.has(t)?this.m_Applications.get(t):void 0}GetRecentApps(){let t=[];return this.m_Applications.forEach(e=>{e.is_internal||t.push(e)}),t.sort((t,e)=>t.last_launch<e.last_launch?1:t.last_launch>e.last_launch?-1:t.name<e.name?1:t.name>e.name?-1:0),t}GetCurrentSceneProcess(){let t=void 0;return this.m_Applications.forEach(e=>{e.current_scene_process&&!e.is_internal&&(t=e)}),t}IsAppAllowedPrivateInputs(t){return"openvr.component.vrcompositor"==t}ShouldShowBindingFailureForApp(t){if(null==t||""==t)return!1;if("openvr.component.vrcompositor"==t)return!0;if(null==this.GetApp(t))return!1;let e=this.GetCurrentSceneProcess();return null!=e&&e.key==t}}Object(i.b)([l.m],a.prototype,"m_Applications",void 0),Object(i.b)([o.bind],a.prototype,"onSceneApplicationStateChanged",null),Object(i.b)([l.d],a.prototype,"SetApplicationMap",null),Object(i.b)([o.bind],a.prototype,"QueryApplications",null),Object(i.b)([o.bind],a.prototype,"GetAppImageURL",null),Object(i.b)([o.bind],a.prototype,"GetApp",null),Object(i.b)([o.bind],a.prototype,"GetRecentApps",null),Object(i.b)([o.bind],a.prototype,"GetCurrentSceneProcess",null),Object(i.b)([o.bind],a.prototype,"IsAppAllowedPrivateInputs",null),Object(i.b)([o.bind],a.prototype,"ShouldShowBindingFailureForApp",null);const c=new a;window.applications=c},MYgy:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return o})),n.d(e,"g",(function(){return v})),n.d(e,"f",(function(){return I})),n.d(e,"d",(function(){return k})),n.d(e,"e",(function(){return B})),n.d(e,"a",(function(){return P}));var i,o,s,r=n("mrSG"),l=n("7wIv"),a=n("vDqi"),c=n.n(a),d=n("2vnA"),p=n("GXif"),u=n("EUJ1"),h=n.n(u),S=n("pYJh"),m=n("Kysl"),g=n("uFkT");class b{}Object(r.b)([d.m],b.prototype,"path",void 0),Object(r.b)([d.m],b.prototype,"mode",void 0),Object(r.b)([d.m],b.prototype,"parameters",void 0),Object(r.b)([d.m],b.prototype,"inputs",void 0);class _{}Object(r.b)([d.m],_.prototype,"path",void 0),Object(r.b)([d.m],_.prototype,"output",void 0);class f{}Object(r.b)([d.m],f.prototype,"path",void 0),Object(r.b)([d.m],f.prototype,"output",void 0);class y{}Object(r.b)([d.m],y.prototype,"path",void 0),Object(r.b)([d.m],y.prototype,"output",void 0);class O{}Object(r.b)([d.m],O.prototype,"output",void 0),Object(r.b)([d.m],O.prototype,"inputs",void 0);class A{}Object(r.b)([d.m],A.prototype,"chords",void 0),Object(r.b)([d.m],A.prototype,"poses",void 0),Object(r.b)([d.m],A.prototype,"haptics",void 0),Object(r.b)([d.m],A.prototype,"sources",void 0),Object(r.b)([d.m],A.prototype,"skeleton",void 0),function(t){t[t.eButtonSide_None=0]="eButtonSide_None",t[t.eButtonSide_Left=1]="eButtonSide_Left",t[t.eButtonSide_Right=2]="eButtonSide_Right"}(i||(i={})),function(t){t.eTrackPadInvert_None="",t.eTrackPadInvert_X="x",t.eTrackPadInvert_Y="y",t.eTrackPadInvert_XY="xy"}(o||(o={}));class v{constructor(){this.vecRequired=[],this.vecSuggested=[]}}class w{}Object(r.b)([d.m],w.prototype,"device_path_string",void 0),Object(r.b)([d.m],w.prototype,"device_path_handle",void 0),Object(r.b)([d.m],w.prototype,"role",void 0),Object(r.b)([d.m],w.prototype,"controller_role",void 0);class C{}function I(t){return new Promise((function(e,n){c.a.get("/input/getactions.json?app_key="+t).then(n=>{console.log("Loaded action manifest for ",t),e(n.data)}).catch(t=>{n(t)})}))}function k(t,e,n){return Object(r.a)(this,void 0,void 0,(function*(){let i=(yield c.a.get("/input/loadbindingfromurl.json?binding_url="+encodeURI(n)+"&controller_type="+encodeURI(e)+"&app_key="+encodeURI(t))).data;if(i.success)return i;throw new Error(i.error)}))}Object(r.b)([d.m],C.prototype,"trackers",void 0),Object(r.b)([d.m],C.prototype,"valid_roles",void 0);class B{constructor(t,e){this.x=t,this.y=e,this.toString.bind(this)}toString(){return this.x+","+this.y}}class j{constructor(t,e,n,i,o){this.m_BindingUISource=void 0,this.m_ControllerProfile=void 0,this.m_sDeviceInputPath=void 0,this.m_eButtonSide=void 0,this.m_sInputPath=void 0,this.m_sActionSet=void 0,this.m_BindingStoreObserverDisposer=void 0,this.m_iNewSourceEntry=-1,this.m_sDeviceInputPath=t,this.m_ControllerProfile=e,this.m_eButtonSide=n,this.m_sInputPath=i,this.m_sActionSet=o,this.m_BindingStoreObserverDisposer=Object(d.n)(P,t=>{"m_LoadedBinding"==t.name&&this.UpdateBindingSource()}),this.UpdateBindingSource(),P.RegisterBindingWatcher(this.UpdateBindingSource.bind(this))}cancelWatcher(){this.m_BindingStoreObserverDisposer(),P.UnregisterBindingWatcher(this.UpdateBindingSource)}UpdateBindingSource(){this.m_BindingUISource=P.GetActionBinding(this.GetFullInputPath,this.m_sActionSet)}get GetFullInputPath(){let t=this.m_sDeviceInputPath+this.m_sInputPath;return t=t.replace(/([^:]\/)\/+/g,"$1")}GetSVGEndPoint(){return new B(this.m_ControllerProfile.input_source[this.m_sInputPath].binding_image_point[0],this.m_ControllerProfile.input_source[this.m_sInputPath].binding_image_point[1])}get GetButtonSide(){return this.m_eButtonSide}get GetNumModes(){return this.m_BindingUISource?this.m_BindingUISource.length:0}GetActionForInputType(t,e){if(this.m_BindingUISource&&this.m_BindingUISource[t].inputs&&this.m_BindingUISource[t].inputs.has(e)){let n=this.m_BindingUISource[t].inputs.get(e).output,i=P.GetActionByName(n);if(!i){let t=P.GetSimulatedActionByPath(n);t&&(i=P.CreateActionDefinitionForSimulatedAction(t))}let o=P.GetAliasInfo(n);return i&&o&&o.alias_name&&((i=Object.assign({},i)).localized_name=o.alias_name),i}}GetClickAction(t){return this.GetActionForInputType(t,"click")}GetTouchAction(t){return this.GetActionForInputType(t,"touch")}GetPositionAction(t){return this.GetActionForInputType(t,"position")}GetHeldAction(t){return this.GetActionForInputType(t,"held")}GetLongAction(t){return this.GetActionForInputType(t,"long")}GetSingleAction(t){return this.GetActionForInputType(t,"single")}GetDoubleAction(t){return this.GetActionForInputType(t,"double")}GetNorthAction(t){return this.GetActionForInputType(t,"north")}GetEastAction(t){return this.GetActionForInputType(t,"east")}GetSouthAction(t){return this.GetActionForInputType(t,"south")}GetWestAction(t){return this.GetActionForInputType(t,"west")}GetCenterAction(t){return this.GetActionForInputType(t,"center")}GetScrollAction(t){return this.GetActionForInputType(t,"scroll")}GetPullAction(t){return this.GetActionForInputType(t,"pull")}GetForceAction(t){return this.GetActionForInputType(t,"force")}GetGrabAction(t){return this.GetActionForInputType(t,"grab")}GetValueAction(t){return this.GetActionForInputType(t,"value")}get GetControllerInputName(){return g.a.LocalizeDriverString(this.m_ControllerProfile.resource_root,this.m_sInputPath)}get GetModes(){return this.m_BindingUISource?this.m_BindingUISource:[]}GetMode(t){return this.m_BindingUISource&&t>=0&&t<this.m_BindingUISource.length?this.m_BindingUISource[t].mode:"none"}get GetInputSourceType(){return this.m_ControllerProfile.input_source[this.m_sInputPath].type}get GetInputSource(){return this.m_ControllerProfile.input_source[this.m_sInputPath]}get GetInputSourceClickSupport(){return!(this.m_ControllerProfile.input_source[this.m_sInputPath].force&&!this.m_ControllerProfile.input_source[this.m_sInputPath].click)&&(("knuckles"!=this.m_ControllerProfile.controller_type||"/input/trackpad"!=this.m_sInputPath)&&(!(!this.m_ControllerProfile.input_source[this.m_sInputPath].click&&!this.m_ControllerProfile.input_source[this.m_sInputPath].touch)&&(this.m_ControllerProfile.input_source[this.m_sInputPath].click||this.m_ControllerProfile.input_source[this.m_sInputPath].touch)))}get GetInputSourceTouchSupport(){return!(!this.m_ControllerProfile.input_source[this.m_sInputPath].touch&&!this.m_ControllerProfile.input_source[this.m_sInputPath].proximity)&&(this.m_ControllerProfile.input_source[this.m_sInputPath].touch||this.m_ControllerProfile.input_source[this.m_sInputPath].proximity)}get GetInputSourceForceSupport(){return!!this.m_ControllerProfile.input_source[this.m_sInputPath].force&&this.m_ControllerProfile.input_source[this.m_sInputPath].force}get GetInputSourceDefaultDeadzone(){return this.m_ControllerProfile.input_source[this.m_sInputPath].default_dead_zone_pct?this.m_ControllerProfile.input_source[this.m_sInputPath].default_dead_zone_pct:0}SetInputMode(t,e){!this.m_BindingUISource||e<0||e>=this.m_BindingUISource.length?console.error("SetInputMode: Invalid mode index for new mode"):(this.ClearNewModeIfSet(e),P.SetInputModeForInputSource(this.GetFullInputPath,e,t))}AddInputMode(t){this.m_iNewSourceEntry=P.AddInputModeForSource(this.GetFullInputPath,t)}DeleteInputMode(t){!this.m_BindingUISource||t<0||t>=this.m_BindingUISource.length?console.error("SetInputMode: Invalid mode index for new mode"):P.DeleteInputModeForSource(this.GetFullInputPath,t)}ClearNewModeIfSet(t){-1!=this.m_iNewSourceEntry&&this.m_iNewSourceEntry==t&&(this.m_iNewSourceEntry=-1)}BHasModeSelectionPending(t){return-1!=this.m_iNewSourceEntry&&this.m_iNewSourceEntry==t}SetClickAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"click",e,["button","trackpad","joystick","trigger","toggle_button","complex_button"])}SetTouchAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"touch",e,["button","trackpad","joystick","trigger","toggle_button","complex_button"])}SetHeldAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"held",e,["button","complex_button"])}SetLongAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"long",e,["button","complex_button"])}SetSingleAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"single",e,["button","complex_button"])}SetDoubleAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"double",e,["button","complex_button"])}SetPositionAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"position",e,["trackpad","joystick"])}SetNorthAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"north",e,["dpad","dpad_click","dpad_touch"])}SetEastAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"east",e,["dpad","dpad_click","dpad_touch"])}SetSouthAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"south",e,["dpad","dpad_click","dpad_touch"])}SetWestAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"west",e,["dpad","dpad_click","dpad_touch"])}SetCenterAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"center",e,["dpad","dpad_click","dpad_touch"])}SetScrollAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"scroll",e,["scroll"])}SetPullAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"pull",e,["trigger"])}SetForceAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"force",e,["force_sensor"])}SetGrabAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"grab",e,["grab"])}SetValueAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"value",e,["scalar_constant"])}CopyActions(t){P.ClearModesForInputPath(this.GetFullInputPath),t.GetModes.map((t,e)=>{P.AddInputModeForSource(this.GetFullInputPath,t.mode),t.inputs.forEach((t,n)=>{P.SetActionForInputModeType(this.GetFullInputPath,e,n,t.output,[])})})}BindingsMatch(t){let e=t.GetModes;if(this.GetModes.length!=e.length)return!1;for(let t=0;t<e.length;t++){let n=e[t],i=this.GetModes.filter(t=>t.mode==n.mode);if(i.length>0){let t=!0;return i[0].inputs.forEach((e,i)=>{n.inputs.has(i)&&n.inputs.get(i).output==e.output||(t=!1)}),t}return!1}return!0}SetClickParameter(t,e,n){P.SetParameterForInputModeType(this.GetFullInputPath,t,"click",e,n)}SetTouchParameter(t,e,n){P.SetParameterForInputModeType(this.GetFullInputPath,t,"touch",e,n)}SetParameter(t,e,n,i){P.SetParameterForInputModeType(this.GetFullInputPath,t,e,n,i)}GetClickParameter(t,e){return P.GetParameterForInputModeType(this.GetFullInputPath,t,"click",e)}GetTouchParameter(t,e){return P.GetParameterForInputModeType(this.GetFullInputPath,t,"touch",e)}GetParameter(t,e,n){return P.GetParameterForInputModeType(this.GetFullInputPath,t,e,n)}GetTrackpadInvertState(t){switch(P.GetParameterForInputModeType(this.GetFullInputPath,t,"trackpad","invert")){case"x":return o.eTrackPadInvert_X;case"y":return o.eTrackPadInvert_Y;case"xy":return o.eTrackPadInvert_XY;default:return o.eTrackPadInvert_None}}SetTrackpadInvertState(t,e){let n="";switch(e){case o.eTrackPadInvert_X:n="x";break;case o.eTrackPadInvert_Y:n="y";break;case o.eTrackPadInvert_XY:n="xy"}P.SetParameterForInputModeType(this.GetFullInputPath,t,"trackpad","invert",n)}}Object(r.b)([d.m],j.prototype,"m_BindingUISource",void 0),Object(r.b)([d.m],j.prototype,"m_ControllerProfile",void 0),Object(r.b)([d.m],j.prototype,"m_sDeviceInputPath",void 0),Object(r.b)([d.m],j.prototype,"m_eButtonSide",void 0),Object(r.b)([d.m],j.prototype,"m_sInputPath",void 0),Object(r.b)([d.m],j.prototype,"m_sActionSet",void 0),Object(r.b)([l.bind],j.prototype,"cancelWatcher",null),Object(r.b)([d.d],j.prototype,"UpdateBindingSource",null),Object(r.b)([d.f],j.prototype,"GetFullInputPath",null),Object(r.b)([l.bind],j.prototype,"GetSVGEndPoint",null),Object(r.b)([d.f],j.prototype,"GetButtonSide",null),Object(r.b)([d.f],j.prototype,"GetNumModes",null),Object(r.b)([l.bind],j.prototype,"GetActionForInputType",null),Object(r.b)([l.bind],j.prototype,"GetClickAction",null),Object(r.b)([l.bind],j.prototype,"GetTouchAction",null),Object(r.b)([l.bind],j.prototype,"GetPositionAction",null),Object(r.b)([l.bind],j.prototype,"GetHeldAction",null),Object(r.b)([l.bind],j.prototype,"GetLongAction",null),Object(r.b)([l.bind],j.prototype,"GetSingleAction",null),Object(r.b)([l.bind],j.prototype,"GetDoubleAction",null),Object(r.b)([l.bind],j.prototype,"GetNorthAction",null),Object(r.b)([l.bind],j.prototype,"GetEastAction",null),Object(r.b)([l.bind],j.prototype,"GetSouthAction",null),Object(r.b)([l.bind],j.prototype,"GetWestAction",null),Object(r.b)([l.bind],j.prototype,"GetCenterAction",null),Object(r.b)([l.bind],j.prototype,"GetScrollAction",null),Object(r.b)([l.bind],j.prototype,"GetPullAction",null),Object(r.b)([l.bind],j.prototype,"GetForceAction",null),Object(r.b)([l.bind],j.prototype,"GetGrabAction",null),Object(r.b)([l.bind],j.prototype,"GetValueAction",null),Object(r.b)([d.f],j.prototype,"GetControllerInputName",null),Object(r.b)([d.f],j.prototype,"GetModes",null),Object(r.b)([l.bind],j.prototype,"GetMode",null),Object(r.b)([d.f],j.prototype,"GetInputSourceType",null),Object(r.b)([d.f],j.prototype,"GetInputSource",null),Object(r.b)([d.f],j.prototype,"GetInputSourceClickSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceTouchSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceForceSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceDefaultDeadzone",null),Object(r.b)([d.d],j.prototype,"SetInputMode",null),Object(r.b)([d.d],j.prototype,"AddInputMode",null),Object(r.b)([d.d],j.prototype,"DeleteInputMode",null),Object(r.b)([l.bind],j.prototype,"ClearNewModeIfSet",null),Object(r.b)([l.bind],j.prototype,"BHasModeSelectionPending",null),Object(r.b)([d.d],j.prototype,"SetClickAction",null),Object(r.b)([d.d],j.prototype,"SetTouchAction",null),Object(r.b)([d.d],j.prototype,"SetHeldAction",null),Object(r.b)([d.d],j.prototype,"SetLongAction",null),Object(r.b)([d.d],j.prototype,"SetSingleAction",null),Object(r.b)([d.d],j.prototype,"SetDoubleAction",null),Object(r.b)([d.d],j.prototype,"SetPositionAction",null),Object(r.b)([d.d],j.prototype,"SetNorthAction",null),Object(r.b)([d.d],j.prototype,"SetEastAction",null),Object(r.b)([d.d],j.prototype,"SetSouthAction",null),Object(r.b)([d.d],j.prototype,"SetWestAction",null),Object(r.b)([d.d],j.prototype,"SetCenterAction",null),Object(r.b)([d.d],j.prototype,"SetScrollAction",null),Object(r.b)([d.d],j.prototype,"SetPullAction",null),Object(r.b)([d.d],j.prototype,"SetForceAction",null),Object(r.b)([d.d],j.prototype,"SetGrabAction",null),Object(r.b)([d.d],j.prototype,"SetValueAction",null),Object(r.b)([d.d],j.prototype,"CopyActions",null),Object(r.b)([l.bind],j.prototype,"BindingsMatch",null),Object(r.b)([d.d],j.prototype,"SetClickParameter",null),Object(r.b)([d.d],j.prototype,"SetTouchParameter",null),Object(r.b)([d.d],j.prototype,"SetParameter",null),Object(r.b)([d.d],j.prototype,"GetClickParameter",null),Object(r.b)([d.d],j.prototype,"GetTouchParameter",null),Object(r.b)([d.d],j.prototype,"GetParameter",null),Object(r.b)([l.bind],j.prototype,"GetTrackpadInvertState",null),Object(r.b)([d.d],j.prototype,"SetTrackpadInvertState",null);class M{constructor(t,e,n){this.m_sSaveType=t,this.m_OutstandingSaveBindingResolve=e,this.m_OutstandingSaveBindingReject=n}resolve(t){this.m_OutstandingSaveBindingResolve(t)}reject(t){this.m_OutstandingSaveBindingReject(t)}get SaveType(){return this.m_sSaveType}}Object(r.b)([l.bind],M.prototype,"resolve",null),Object(r.b)([l.bind],M.prototype,"reject",null),function(t){t[t.eWebSocketState_Unknown=0]="eWebSocketState_Unknown",t[t.eWebSocketState_Disconnected=1]="eWebSocketState_Disconnected",t[t.eWebSocketState_Connecting=2]="eWebSocketState_Connecting",t[t.eWebSocketState_Connected=3]="eWebSocketState_Connected"}(s||(s={}));class T{constructor(){this.m_wsWebSocketToServer=void 0,this.m_eWebSocketState=s.eWebSocketState_Unknown,this.m_timerWebSocket=void 0,this.m_dateStartTime=new Date,this.m_sLoadedBindingURI=void 0,this.m_LoadedBinding=void 0,this.m_ModifiedBindingSet=d.m.map(),this.m_ModifiedOptions=d.m.map(),this.m_ModifiedAliases=d.m.map(),this.m_sName=void 0,this.m_sDescription=void 0,this.m_SelectedApp=void 0,this.m_SelectedAppActions=void 0,this.m_sSelectedActionSet=void 0,this.m_sSelectedControllerType=void 0,this.m_TrackerBindingSetup=void 0,this.m_bControllerTypeSelectedByUser=!1,this.m_OutstandingSaveBindingCalls=[],this.m_vecBindingSetWatchers=Array(),this.m_mapUnoundActions=new Map,this.m_bIsMissingRequiredActions=!1,this.m_rKnownFailedBindingUris=[],this.m_ControllerWatchers=new Map,this.m_ModifiedSimulatedActions=d.m.map(),this.m_nNextSimulatedActionId=1,this.m_nBindingSubscriptionChangedCanary=1}OpenWebSocketToHost(){return new Promise((t,e)=>{this.m_eWebSocketState!=s.eWebSocketState_Connecting&&this.m_eWebSocketState!=s.eWebSocketState_Connected&&(this.m_wsWebSocketToServer&&delete this.m_wsWebSocketToServer,this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",e=>{this.OnWebSocketOpen(e),t()}),this.m_wsWebSocketToServer.addEventListener("message",t=>{this.OnWebSocketMessage(t)}),this.m_wsWebSocketToServer.addEventListener("close",t=>{this.OnWebSocketClose(t)}),this.m_eWebSocketState=s.eWebSocketState_Connecting),this.m_timerWebSocket||(this.m_timerWebSocket=window.setTimeout(this.OpenWebSocketToHost,1e3))})}Init(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.OpenWebSocketToHost(),yield this.RefreshInputState()}))}CountDevicesWithControllerType(t){let e=0;return g.a.ConnectedDevices.forEach(n=>{n.controller_type==t&&e++}),e}ComputeControllerTypeScore(t){let e=this.CountDevicesWithControllerType(t.controller_type),n=(h.a.HasHMD()?h.a.VRProperties.GetStringProperty("/user/head",u.ETrackedDeviceProperty.Prop_ExpectedControllerType_String):void 0)==t.controller_type?2:1;return 1e3*(999-t.priority)+10*e+n}GetBestControllerType(){let t,e=0;return g.a.ControllerTypes.forEach(n=>{let i=this.ComputeControllerTypeScore(n);i>e&&(t=n,e=i)}),t}RefreshInputState(){return Object(r.a)(this,void 0,void 0,(function*(){let t=g.a.KnownControllerTypes.size;return g.a.GetInputState().then(()=>{this.m_SelectedApp&&t!=g.a.KnownControllerTypes.size&&this.ReloadCurrentApp();let e=!1;const n=this.GetBestControllerType();let i=g.a.FindDeviceClassForControllerType(this.m_sSelectedControllerType);if(null!=n&&this.m_sSelectedControllerType!=n.controller_type&&!this.m_bControllerTypeSelectedByUser){let t=g.a.FindDeviceClassForControllerType(n.controller_type);S.a.IsSafeToResetControllerType(i,t)&&(this.m_sSelectedControllerType=n.controller_type,e=!0,null!=i&&S.a.RefreshBindingList())}return e?this.ReloadControllerConfiguration():null})}))}get SteamVRUnavailable(){return this.m_eWebSocketState==s.eWebSocketState_Connecting||this.m_eWebSocketState==s.eWebSocketState_Unknown?Date.now()-this.m_dateStartTime.getTime()>1e4:this.m_eWebSocketState!=s.eWebSocketState_Connected}get ActionSets(){if(null==this.m_SelectedAppActions||null==this.m_SelectedAppActions.action_sets)return[];let t=[];return this.m_SelectedAppActions.action_sets.forEach(e=>{if("hidden"!=e.usage){let n=!0;e.required_options&&e.required_options.forEach(t=>{this.GetOptionValue(t)||(n=!1)});let i=!1;e.forbidden_options&&e.forbidden_options.forEach(t=>{this.GetOptionValue(t)&&(i=!0)}),n&&!i&&t.push(e)}}),t}get ManifestOptions(){return null==this.m_SelectedAppActions||null==this.m_SelectedAppActions.action_sets||null==this.m_SelectedAppActions.options?[]:this.m_SelectedAppActions.options}get SecondaryControllerOptions(){return[{name:"returnBindingsWithLeftHand",localized_name:Object(p.c)("#SecondaryController_ReturnWithLeftHand"),type:"bool",default:!1},{name:"returnBindingsWithRightHand",localized_name:Object(p.c)("#SecondaryController_ReturnWithRightHand"),type:"bool",default:!1},{name:"returnBindingsWithHead",localized_name:Object(p.c)("#SecondaryController_ReturnWithHead"),type:"bool",default:!1}]}GetOptionDefault(t){let e=!1;return this.ManifestOptions.forEach(n=>{n.name==t&&(e=n.default)}),e}GetOptionValue(t){return this.m_ModifiedOptions.has(t)?this.m_ModifiedOptions.get(t):void 0}SetOptionValue(t,e){this.m_ModifiedOptions.set(t,e),this.NotifyWatchersOfChange()}GetAliasInfo(t){return this.m_ModifiedAliases.has(t)?this.m_ModifiedAliases.get(t):null}SetAliasName(t,e){if(this.m_ModifiedAliases.has(t)){let n=this.m_ModifiedAliases.get(t);n.alias_name=e,this.m_ModifiedAliases.set(t,n),this.NotifyWatchersOfChange()}else{let n={alias_name:e,hidden:!1};this.m_ModifiedAliases.set(t,n),this.NotifyWatchersOfChange()}}SetAliasHidden(t,e){if(this.m_ModifiedAliases.has(t)){let n=this.m_ModifiedAliases.get(t);n.hidden=e,this.m_ModifiedAliases.set(t,n),this.NotifyWatchersOfChange()}else{let n={alias_name:"",hidden:e};this.m_ModifiedAliases.set(t,n),this.NotifyWatchersOfChange()}}ComputeSimulatedActionPathFromId(t){return"/simactions/"+t}GetSimulatedActionByPath(t){return this.m_ModifiedSimulatedActions.has(t)?this.m_ModifiedSimulatedActions.get(t):void 0}SetSimulatedActionByPath(t,e){this.m_ModifiedSimulatedActions.set(t,e),this.NotifyWatchersOfChange()}AddSimulatedAction(t){let e={name:"",type:t,id:this.m_nNextSimulatedActionId++,output:""},n=this.ComputeSimulatedActionPathFromId(e.id);this.m_ModifiedSimulatedActions.set(n,e),this.NotifyWatchersOfChange()}DeleteSimulatedActionByPath(t){this.m_ModifiedSimulatedActions.delete(t),this.NotifyWatchersOfChange()}get SimulatedActions(){return Array.from(this.m_ModifiedSimulatedActions.values())}get SelectedApp(){return this.m_SelectedApp?this.m_SelectedApp.key:void 0}get SelectedAppActions(){return this.m_SelectedAppActions}get CurrentAppCanAccessPrivateInputs(){return m.a.IsAppAllowedPrivateInputs(this.m_SelectedApp.key)||g.a.ShouldSendSystemButtonToAllApps}get SelectedControllerTypeInfo(){if(g.a.IsValid&&null!=this.m_sSelectedControllerType)return g.a.GetControllerTypeInfo(this.m_sSelectedControllerType)}DeviceForControllerType(t,e){let n=g.a.GetControllerTypeInfo(t);if(!n)return;let o=!1,s=g.a.ConnectedDevices.find(s=>{if(s.controller_type==t){if(o=!0,!e)return!0;if("controller_handed"!=n.input_bindingui_mode)return!0;let t=e==i.eButtonSide_Left?"/left":"/right";if(s.root_path&&s.root_path.indexOf(t)>=0)return!0}return!1});return s||(o?g.a.ConnectedDevices.find(e=>e.controller_type==t):void 0)}get CurrentBindingSaveType(){if(null!=this.m_LoadedBinding)return"developer"==this.m_LoadedBinding.save_type&&P.SelectedBindingIsLegacy?"developer_legacy":this.m_LoadedBinding.save_type}get CurrentBindingActionManifestVersion(){return this.m_LoadedBinding&&this.m_LoadedBinding.binding_config&&this.m_LoadedBinding.binding_config.action_manifest_version?this.m_LoadedBinding.binding_config.action_manifest_version:0}get SelectedActionSet(){return this.m_sSelectedActionSet}get SelectedActionSetDetails(){if(null!=this.m_SelectedAppActions&&null!=this.m_sSelectedActionSet)return this.m_SelectedAppActions.action_sets.find(t=>t.name==this.m_sSelectedActionSet)}get SelectedActionSetActions(){return this.GetActionSetActions(this.m_sSelectedActionSet)}GetSelectedAppDefaultBinding(t){if(null!=this.m_SelectedAppActions)return this.m_SelectedAppActions.default_bindings&&this.m_SelectedAppActions.default_bindings.hasOwnProperty(t)?this.m_SelectedAppActions.default_bindings[t]:void 0}GetActionSetActions(t){if(null==this.m_SelectedAppActions||null==t)return[];let e=this.m_SelectedAppActions.action_sets.find(e=>e.name==t);return e?e.actions:[]}GetActionByName(t){if(null==this.m_SelectedApp||!this.m_SelectedAppActions.action_sets)return;let e=t.toLowerCase(),n=void 0;return this.m_SelectedAppActions.action_sets.forEach(t=>{if(!t.actions)return;let i=t.actions.find(t=>t.name.toLowerCase()==e);i&&(n=i)}),n}get UnboundActions(){this.m_bIsMissingRequiredActions=!1;for(let t of this.ActionSets){let e=[],n=[];if(!t.actions)break;for(let i of t.actions)if("optional"!=i.requirement&&!this.IsActionBound(t,i.name)){let t=this.GetAliasInfo(i.name);if(t){if(t.hidden)continue;t.alias_name&&((i=Object.assign({},i)).localized_name=t.alias_name)}"mandatory"==i.requirement?e.push(i):n.push(i)}if(e.length>0&&(this.m_bIsMissingRequiredActions=!0),this.m_mapUnoundActions.has(t.name)){let i=this.m_mapUnoundActions.get(t.name);i.vecRequired=e,i.vecSuggested=n}else this.m_mapUnoundActions.set(t.name,{vecRequired:e,vecSuggested:n})}let t=this.SelectedControllerTypeInfo;return t&&"TrackedDeviceClass_HMD"==t.device_class&&(this.m_bIsMissingRequiredActions=!1),this.IsSecondaryController&&(this.m_bIsMissingRequiredActions=!1),this.m_mapUnoundActions}get HasUnboundActions(){return this.UnboundActions,this.m_bIsMissingRequiredActions}IsActionBound(t,e){e=e.toLowerCase();let n=this.GetActionSetSources(t.name);if(n)for(let t of n){let n=!1;if(t.inputs.forEach(t=>{t.output.toLowerCase()==e&&(n=!0)}),n)return!0}let i=this.GetActionSetChords(t.name);if(i)for(let t of i)if(t.output&&t.output.toLowerCase()==e)return!0;let o=this.GetActionSetPoses(t.name);if(o)for(let t of o)if(t.output&&t.output.toLowerCase()==e)return!0;let s=this.GetActionSetHaptics(t.name);if(s)for(let t of s)if(t.output&&t.output.toLowerCase()==e)return!0;let r=this.GetActionSetSkeleton(t.name);if(r)for(let t of r)if(t.output&&t.output.toLowerCase()==e)return!0;return!1}GetActionSetPoses(t){return this.m_ModifiedBindingSet.has(t)?this.m_ModifiedBindingSet.get(t).poses:[]}get SelectedActionSetPoses(){return this.GetActionSetPoses(this.m_sSelectedActionSet)}GetActionSetHaptics(t){return this.m_ModifiedBindingSet.has(t)?this.m_ModifiedBindingSet.get(t).haptics:[]}get SelectedActionSetHaptics(){return this.GetActionSetHaptics(this.m_sSelectedActionSet)}GetActionSetSkeleton(t){return this.m_ModifiedBindingSet.has(t)?this.m_ModifiedBindingSet.get(t).skeleton:[]}get SelectedActionSetSkeletons(){return this.GetActionSetSkeleton(this.m_sSelectedActionSet)}GetActionSetChords(t){return this.m_ModifiedBindingSet.has(t)?this.m_ModifiedBindingSet.get(t).chords:[]}get SelectedActionSetChords(){return this.GetActionSetChords(this.m_sSelectedActionSet)}get SelectedActionSetChordCount(){let t=this.SelectedActionSetChords;return t?t.length:0}GetActionSetSources(t){if(null==this.m_ModifiedBindingSet||null==t)return;let e=this.m_ModifiedBindingSet;return e.has(t)?e.get(t).sources:void 0}get SelectedActionSetSources(){return this.GetActionSetSources(this.m_sSelectedActionSet)}get BSelectedActionSetHasPoses(){return null!=this.m_LoadedBinding&&null!=this.m_sSelectedActionSet&&null!=this.SelectedActionSetActions&&this.SelectedActionSetActions.filter(t=>"pose"==t.type).length>0}get BSelectedActionSetHasBoundPoses(){if(!this.BSelectedActionSetHasPoses||!this.SelectedActionSetPoses||null==this.SelectedActionSetActions)return!1;for(let t of this.SelectedActionSetPoses)if(t.output&&"none"!=t.output)return!0;return!1}get BSelectedActionSetHasHaptics(){return null!=this.m_LoadedBinding&&null!=this.m_sSelectedActionSet&&null!=this.SelectedActionSetActions&&this.SelectedActionSetActions.filter(t=>"vibration"==t.type).length>0}get BSelectedActionSetHasBoundHaptics(){if(!this.BSelectedActionSetHasHaptics||!this.SelectedActionSetHaptics||null==this.SelectedActionSetActions)return!1;for(let t of this.SelectedActionSetHaptics)if(t.output&&"none"!=t.output)return!0;return!1}get BSelectedActionSetHasSkeletons(){if(null==this.m_LoadedBinding||null==this.m_sSelectedActionSet||null==this.SelectedActionSetActions)return!1;if(0==this.SelectedActionSetActions.filter(t=>"skeleton"==t.type).length)return!1;return null!=this.SelectedControllerTypeInfo&&!!this.GetFirstInputSourceOfType("skeleton")}get BSelectedActionSetHasBoundSkeletons(){if(!this.BSelectedActionSetHasSkeletons||!this.SelectedActionSetSkeletons||null==this.SelectedActionSetActions)return!1;for(let t of this.SelectedActionSetSkeletons)if(t.output&&"none"!=t.output)return!0;return!1}SetSelectedApp(t,e){if(null==this.m_SelectedApp||t!=this.m_SelectedApp.key){this.m_rKnownFailedBindingUris=[],this.m_ControllerWatchers.clear();let n=m.a.GetApp(t);n&&(this.m_SelectedApp=n,e||this.ReloadCurrentApp())}}ReloadCurrentApp(){return Object(r.a)(this,void 0,void 0,(function*(){this.m_sLoadedBindingURI=void 0,this.m_sSelectedActionSet=void 0,yield this.LoadActionManifest();let t=this.ActionSets;t.length>0&&(null==this.m_sSelectedActionSet||!this.m_SelectedAppActions.action_sets.hasOwnProperty(this.m_sSelectedActionSet))&&(this.m_sSelectedActionSet=t[0].name),yield this.ReloadControllerConfiguration()}))}SetSelectedController(t,e){if(t!=this.m_sSelectedControllerType){let n=g.a.GetControllerTypeInfo(t);n&&(this.m_ControllerWatchers.clear(),this.m_sSelectedControllerType=n.controller_type,this.m_bControllerTypeSelectedByUser=!0,this.m_sLoadedBindingURI=void 0,e||this.ReloadControllerConfiguration())}}SetSelectedActionSet(t){t!=this.m_sSelectedActionSet&&(this.m_sSelectedActionSet=t)}LocalizeStringForSelectedControllerType(t){let e=this.SelectedControllerTypeInfo;return e&&e.resource_root?g.a.LocalizeDriverString(e.resource_root,t):t}LocalizePathNameForSelectedControllerType(t){let e=void 0;return["/user/hand/secondary","/user/hand/primary","/user/hand/left","/user/hand/right","/user/head"].forEach(n=>{0!=t.indexOf(n)||(e=n)}),e?Object(p.c)("#"+e)+" "+this.LocalizeStringForSelectedControllerType(t.replace(e,"")):t}get SelectedControllerTypeLocalizedName(){let t=this.SelectedControllerTypeInfo;return t?t.resource_root?g.a.LocalizeDriverString(t.resource_root,t.controller_type):t.controller_type:""}RegisterBindingWatcher(t){null==this.m_vecBindingSetWatchers.find(e=>e==t)&&this.m_vecBindingSetWatchers.push(t)}UnregisterBindingWatcher(t){let e=this.m_vecBindingSetWatchers.indexOf(t);e>=0&&this.m_vecBindingSetWatchers.splice(e,1)}GetActionBinding(t,e){if(null==this.m_ModifiedBindingSet)return;let n=this.m_ModifiedBindingSet;if(n.has(e)){let i=n.get(e).sources;if(i){let e=i.filter(e=>e.path==t);if(e)return e}}}GetInputModesForSourceType(t,e){let n=[];switch(t){case"button":n=["button","-","toggle_button","scalar_constant"];break;case"trackpad":n=["trackpad","dpad","-","scroll","radial","button","toggle_button"];break;case"trigger":n=["trigger","button","-","toggle_button","scalar_constant"];break;case"joystick":n=["joystick","dpad","-","scroll","radial","button","toggle_button"];break;case"pinch":n=["grab"];break;default:n=[]}return e&&(n.push("force_sensor"),"trigger"==t&&n.push("grab")),n}GetBooleanInputOptionsForMode(t){switch(t){case"button":case"toggle_button":return["click","touch"];case"button":return["single","double","held","long","click","touch"];case"trackpad":return["click","touch"];case"dpad_click":case"dpad_touch":case"dpad":return["west","east","north","south","center"];case"trackpad_scroll":return[];case"trigger":return["click","touch"];case"grab":return["grab"];case"force_sensor":default:return[]}}GetActionBindingsOfType(t,e){if(null==this.m_SelectedApp||null==this.m_sSelectedActionSet||null==this.m_SelectedAppActions.action_sets)return[];let n=this.SelectedActionSetDetails;if(!n)return[];if(null==n.actions)return[];let i=[];return n.actions.forEach(n=>{let o=this.m_ModifiedAliases.get(n.name);if(n.type==t&&(!o||!o.hidden||e))if(o&&o.alias_name){let t=Object.assign({},n);t.localized_name=o.alias_name,i.push(t)}else i.push(n)}),e||this.m_ModifiedSimulatedActions.forEach(e=>{if(this.GetActionTypeFromSimulatedActionType(e.type)==t){this.ComputeSimulatedActionPathFromId(e.id),e.name?e.name:(Object(p.c)("UnnamedSimAction"),e.id);i.push(this.CreateActionDefinitionForSimulatedAction(e))}}),i}GetActionTypeFromSimulatedActionType(t){switch(t){case"fake_trigger":case"fake_trackpad_click":return"boolean";default:return"unknown"}}CreateActionDefinitionForSimulatedAction(t){return{name:this.ComputeSimulatedActionPathFromId(t.id),localized_name:t.name?t.name:Object(p.c)("UnnamedSimAction")+t.id,type:this.GetActionTypeFromSimulatedActionType(t.type)}}get GetBooleanActionBindings(){return this.GetActionBindingsOfType("boolean")}get GetVector1ActionBindings(){return this.GetActionBindingsOfType("vector1")}get GetLiteralVector1ActionBindings(){return this.GetActionBindingsOfType("vector1",!0)}get GetVector2ActionBindings(){return this.GetActionBindingsOfType("vector2")}get GetVector3ActionBindings(){return this.GetActionBindingsOfType("vector3")}get GetPoseActionBindings(){return this.GetActionBindingsOfType("pose")}get GetHapticsActionBindings(){return this.GetActionBindingsOfType("vibration")}get GetSkeletonActionBindings(){return this.GetActionBindingsOfType("skeleton")}get ConfigName(){return this.m_sName}get ConfigDescription(){return this.m_sDescription}GetPoseAction(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses;if(null==e)return;let n=e.filter(e=>e.output.toLowerCase()==t.toLowerCase());return n.length?n:void 0}GetPoseActionByPath(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses;if(null==e)return;let n=e.filter(e=>e.path.toLowerCase()==t.toLowerCase());return n.length?n:void 0}GetHapticsAction(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics;if(null==e)return;let n=e.filter(e=>e.output.toLowerCase()==t.toLowerCase());return n.length?n:void 0}GetHapticsActionByPath(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics;if(null==e)return;let n=e.filter(e=>e.path.toLowerCase()==t.toLowerCase());return n.length?n:void 0}GetSkeletonAction(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton;if(null==e)return;let n=e.filter(e=>e.output.toLowerCase()==t.toLowerCase());return n.length?n:void 0}GetSkeletonActionByPath(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton;if(null==e)return;let n=e.filter(e=>e.path.toLowerCase()==t.toLowerCase());return n.length?n:void 0}NotifyWatchersOfChange(){console.log("Binding file changed"),this.m_vecBindingSetWatchers.forEach(t=>{t()}),this.AutosaveBinding()}SetActionForInputModeType(t,e,n,i,o){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForInputModeType: Invalid action set specified");class s{constructor(t,e){this.mode=t,this.sourceIdx=e}}let r=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,n)=>{e.path==t&&r.push(new s(e,n))}),r.length<=e)return void console.warn("Invalid mode index (",e,") for path ",t);let l=r[e].sourceIdx;if(l>=0){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[l];if(t.inputs&&t.inputs.has(n)&&t.inputs.get(n).output==i)return void console.log("Trying to set new action to old action for type",n," action is ",i);if(o.length>0&&!o.find(e=>e==t.mode))return void console.log("Trying to set invalid input type of ",n," for current mode ",t.mode);t.inputs||(t.inputs=d.m.map()),"none"==i?t.inputs.has(n)&&t.inputs.delete(n):t.inputs.has(n)?t.inputs.get(n).output=i:t.inputs.set(n,{output:i}),this.NotifyWatchersOfChange()}}SetParameterForInputModeType(t,e,n,i,o){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetParameterForInputModeType: Invalid action set specified");let s=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,n)=>{e.path==t&&s.push(n)}),s.length<=e)return void console.warn("Invalid mode index (",e,") for path ",t);let r=s[e];if(r>=0){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[r];if(!t.inputs)return void console.log("SetParameterForInputModeType: Trying to set parameter for missing input type of ",n," for current mode ",t.mode);t.parameters||(t.parameters=d.m.map()),t.parameters.get(i)!=o&&(null==o?t.parameters.delete(i):t.parameters.set(i,o),this.NotifyWatchersOfChange())}}GetParameterForInputModeType(t,e,n,i){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return console.error("SetParameterForInputModeType: Invalid action set specified"),null;let o=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,n)=>{e.path==t&&o.push(n)}),o.length<=e)return console.warn("Invalid mode index (",e,") for path ",t),null;let s=o[e];if(s>=0){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[s];return t.inputs?t.parameters&&t.parameters.has(i)?t.parameters.get(i):null:(console.log("GetParameterForInputModeType: Trying to get parameter for missing input type of ",n," for current mode ",t.mode),null)}return null}AddActionSetIfRequired(){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet)){let t=new A;t.sources=[],this.m_ModifiedBindingSet.set(this.m_sSelectedActionSet,t)}}AddInputModeForSource(t,e){this.AddActionSetIfRequired();let n=new b;return n.mode=e,n.path=t,n.inputs=d.m.map(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.push(n),this.NotifyWatchersOfChange(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter(e=>e.path.toLowerCase()==t.toLowerCase()).length-1}DeleteInputModeForSource(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("AddInputModeForType: Invalid action set specified");let n=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,i)=>{e.path.toLowerCase()==t.toLowerCase()&&n.push(i)}),n.length<=e)return void console.warn("Invalid mode index (",e,") for path ",t);let i=n[e];-1!=i?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.splice(i,1),this.NotifyWatchersOfChange()):console.error("DeleteInputModeForSource: Mode not found for source")}SetInputModeForInputSource(t,e,n){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForInputModeType: Invalid action set specified");let i=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,n)=>{e.path.toLowerCase()==t.toLowerCase()&&i.push(n)}),i.length<=e)return void console.warn("Invalid mode index (",e,") for path ",t);let o=i[e];if(-1!=o){let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[o];if(e.path==t){if(e.mode==n)return void console.log("Trying to set new input mode to old mode!");let i=JSON.parse(JSON.stringify(e)),s=new b;switch(s.mode=n,s.path=t,s.inputs=d.m.map(),n){case"button":case"toggle_button":switch(i.mode){case"complex_button":i.inputs.single&&(s.inputs.set("single",i.inputs.single),s.inputs.set("click",i.inputs.single)),i.inputs.long&&s.inputs.set("long",i.inputs.long),i.inputs.press&&s.inputs.set("press",i.inputs.press),i.inputs.double&&s.inputs.set("double",i.inputs.double),i.inputs.touch&&s.inputs.set("touch",i.inputs.touch);break;case"button":case"toggle_button":case"trackpad":case"trigger":i.inputs.click&&s.inputs.set("click",i.inputs.click),i.inputs.touch&&s.inputs.set("touch",i.inputs.touch)}break;case"complex_button":switch(i.mode){case"toggle_button":case"button":i.inputs.click&&s.inputs.set("single",i.inputs.click);break;case"trackpad":case"trigger":i.inputs.click&&s.inputs.set("single",i.inputs.click)}break;case"trackpad":switch(i.mode){case"complex_button":i.inputs.single&&s.inputs.set("click",i.inputs.single);break;case"toggle_button":case"button":case"trigger":i.inputs.click&&s.inputs.set("click",i.inputs.click),i.inputs.touch&&s.inputs.set("touch",i.inputs.touch)}break;case"trigger":switch(i.mode){case"complex_button":i.inputs.single&&s.inputs.set("click",i.inputs.single);break;case"toggle_button":case"trackpad":case"button":i.inputs.click&&s.inputs.set("click",i.inputs.click),i.inputs.touch&&s.inputs.set("touch",i.inputs.touch)}}return this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[o]=s,void this.NotifyWatchersOfChange()}}else console.error("SetActionForInputModeType: trying to change a mode for a source that we don't have already")}ClearModesForInputPath(t){this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet)?this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter(e=>e.path.toLowerCase()!=t.toLowerCase()):console.error("ClearModesForInputPath: Invalid action set specified")}SetInputPathForPose(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForPose: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.findIndex(e=>e.path.toLowerCase()==t.path.toLowerCase()&&e.output.toLowerCase()==t.output.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].output=t.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].path!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].path=e,this.NotifyWatchersOfChange()):console.log("Trying to set new pose action path to old action path!")}SetPoseForInputPath(t,e){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForPose: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.findIndex(e=>e.path.toLowerCase()==t.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].path=t),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].output!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[n].output=e,this.NotifyWatchersOfChange()):console.log("Trying to set new pose action path to old action path!")}GetFirstInputSourceOfType(t){let e=this.SelectedControllerTypeInfo;if(null!=e)for(let n of Object.keys(e.input_source)){if(e.input_source[n].type==t)return n}}AddDefaultPose(t,e){if(this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array),null==this.SelectedControllerTypeInfo)return;let n=this.GetFirstInputSourceOfType("pose");if(!n)return;let i=new class{};i.output=t,i.path=n,this.SetInputPathForPose(i,n)}SetInputPathForHaptics(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputPathForHaptics: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.findIndex(e=>e.path.toLowerCase()==t.path.toLowerCase()&&e.output.toLowerCase()==t.output.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.push(new f)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].output=t.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].path!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].path=e,this.NotifyWatchersOfChange()):console.log("Trying to set new haptics action path to old action path!")}SetHapticsForInputPath(t,e){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetHapticsForInputPath: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.findIndex(e=>e.path.toLowerCase()==t.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].path=t),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].output!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[n].output=e,this.NotifyWatchersOfChange()):console.log("Trying to set new haptic action path to old action path!")}AddDefaultHaptics(t,e){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let n=this.GetFirstInputSourceOfType("haptic");if(!n)return;let i=e+n;let o=new class{};o.output=t,o.path=i,this.SetInputPathForHaptics(o,i)}SetInputPathForSkeleton(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputPathForSkeleton: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.findIndex(e=>e.path.toLowerCase()==t.path.toLowerCase()&&e.output.toLowerCase()==t.output.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.push(new y)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].output=t.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].path!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].path=e,this.NotifyWatchersOfChange()):console.log("Trying to set new skeleton action path to old action path!")}SetSkeletonForInputPath(t,e){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetSkeletonForInputPath: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.findIndex(e=>e.path.toLowerCase()==t.toLowerCase());-1==n&&(n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].path=t),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].output!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[n].output=e,this.NotifyWatchersOfChange()):console.log("Trying to set new skeleton action path to old action path!")}AddDefaultSkeleton(t,e){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let n=this.GetFirstInputSourceOfType("skeleton");if(!n)return;let i=e+n;let o=new class{};o.output=t,o.path=i,this.SetInputPathForSkeleton(o,i)}SetActionForChord(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForChord: Invalid action set specified");let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);-1!=n?this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].output!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].output=e,this.NotifyWatchersOfChange()):console.log("Trying to set new chord action to old action!"):console.error("SetActionForChord: Invalid chord  specified ",t)}DeleteChord(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("DeleteChordForSource: Invalid action set specified");let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);-1!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.splice(e,1),this.NotifyWatchersOfChange()):console.error("DeleteChordForSource: Invalid chord  specified ",t)}AddChord(){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords=new Array);this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.push(new O);this.NotifyWatchersOfChange()}DeleteSourceFromChord(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("DeleteSourceFromChord: Invalid action set specified");let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);if(-1!=n){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs.findIndex(t=>t[0]==e);-1!=t&&(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs.splice(t,1),this.NotifyWatchersOfChange())}else console.error("DeleteSourceFromChord: Invalid chord  specified ",t)}SetInputTypeForChord(t,e,n){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputsForChord: Invalid action set specified");let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);if(-1!=i){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs.findIndex(t=>t[0]==e);if(-1==t)return void console.log("Invalid bounds for new input chord, trying to add type without source");if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[t][1]==n)return void console.log("Trying to set new chord inputs to old inputs!");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[t][1]=n,this.NotifyWatchersOfChange()}else console.error("SetInputsForChord: Invalid chord  specified ",t)}SetInputSourceForChord(t,e,n){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputsForChord: Invalid action set specified");let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);if(-1!=i){let t=this.GetActionBinding(e,this.SelectedActionSet);if(!t)return void console.log("Failed to find action binding for path");let o="click";if(t.length&&(o=this.GetBooleanInputOptionsForMode(t[0].mode)[0]),null==n)this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs=new Array),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs.push([e,o]);else{let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs.findIndex(t=>t[0]==n);if(-1==t)return void console.log("Trying to set replace chord input path when we didn't have that path!");if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[t][0]==e)return void console.log("Trying to set new chord inputs to old inputs!");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[t][0]=e,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs[t][1]=o}this.NotifyWatchersOfChange()}else console.error("SetInputsForChord: Invalid chord  specified ",t)}LoadActionManifest(){return Object(r.a)(this,void 0,void 0,(function*(){return new Promise((t,e)=>{I(this.m_SelectedApp.key).then(e=>{null==e.error?(this.m_SelectedAppActions=e,null==this.m_sLoadedBindingURI&&e.current_binding_url.hasOwnProperty(this.m_sSelectedControllerType)&&(this.m_sLoadedBindingURI=e.current_binding_url[this.m_sSelectedControllerType])):(this.m_SelectedAppActions=void 0,this.m_sLoadedBindingURI=void 0),t()})})}))}get SelectedBindingURL(){return null!=this.m_sSelectedControllerType&&null!=this.m_SelectedAppActions&&null!=this.m_SelectedAppActions.current_binding_url&&this.m_SelectedAppActions.current_binding_url.hasOwnProperty(this.m_sSelectedControllerType)?this.m_SelectedAppActions.current_binding_url[this.m_sSelectedControllerType]:void 0}get LoadedBindingURL(){return this.m_sLoadedBindingURI}get SelectedBindingIsLegacy(){return!this.m_SelectedAppActions||this.m_SelectedAppActions.legacy}get IsSecondaryController(){if(!this.m_sSelectedControllerType)return!1;let t=g.a.FindRootPathForControllerType(this.m_sSelectedControllerType);return"/user/treadmill"==t||"/user/gamepad"==t||"/user/stylus"==t}ReloadControllerConfiguration(){return Object(r.a)(this,void 0,void 0,(function*(){if(!(this.m_SelectedAppActions&&this.m_sLoadedBindingURI&&this.SelectedApp&&this.SelectedControllerTypeInfo))return;let t=yield k(this.m_SelectedApp.key,this.SelectedControllerTypeInfo.controller_type,this.m_sLoadedBindingURI);this.OnBindingConfigLoaded(t)}))}UpdateTrackerBindings(){return Object(r.a)(this,void 0,void 0,(function*(){let t=yield this.GetTrackerBindings();this.m_TrackerBindingSetup=t}))}get TrackerBindings(){return null==this.m_TrackerBindingSetup&&this.UpdateTrackerBindings(),this.m_TrackerBindingSetup}GetTrackerBindings(){return Object(r.a)(this,void 0,void 0,(function*(){return new Promise((function(t,e){c.a.get("/input/gettrackerbindings.json").then(e=>{t(e.data)}).catch(t=>{e(t)})}))}))}GetTrackerBinding(t){for(let e of this.m_TrackerBindingSetup.trackers)if(e.device_path_string==t)return e;return null}SetTrackerBinding(t,e,n){let i={device_path:t,role:e,controller_role:n},o=JSON.stringify(i);console.log("Saving tracker binding "+t),c.a.post("/input/settrackerbinding.action",o).then(t=>{console.log("SetTrackerBinding response: ",t.data),this.UpdateTrackerBindings()}).catch(t=>{})}PulseHaptics(t){let e={path_handle:t},n=JSON.stringify(e);c.a.post("/input/pulsehaptics.action",n).then(t=>{console.log("PulseHaptics response: ",t.data)}).catch(t=>{})}get KnownControllerTypes(){let t=[];return g.a.KnownControllerTypes.forEach(e=>{t.push(e)}),t}PreserveCurrentBindingForUpgrade(){let t=S.a.CurrentBinding;return t&&"autosave"==t.type?this.SaveCurrentBinding(Object(p.c)("#PreservedAutosaveName"),"","personal"):Promise.resolve(null)}GetDefaultBindingNameForSaveType(t){let e=P.SelectedControllerTypeInfo,n=g.a.LocalizeControllerString(e,e?e.controller_type:"");switch(t){default:case"autosave":return Object(p.c)("#BindingUI_SaveDefaultName",this.m_SelectedApp.name,n);case"personal":return Object(p.c)("#BindingUI_SaveDefaultName_Personal",this.m_SelectedApp.name,n);case"public":return Object(p.c)("#BindingUI_SaveDefaultName_Public",g.a.CurrentUserPersonaName)}}AutosaveBinding(){this.m_sName||(this.m_sName=this.GetDefaultBindingNameForSaveType("autosave")),this.SaveCurrentBinding(this.m_sName,this.m_sDescription,"autosave").then(t=>{P.SetBindingURL(t.uri)})}SaveCurrentBinding(t,e,n){return Object(r.a)(this,void 0,void 0,(function*(){if(this.HasUnboundActions)return console.log("Aborting save: Missing at least one required action"),new Promise((t,e)=>{e()});this.m_sName=t,this.m_sDescription=e;let i={app_key:this.SelectedApp,controller_type:this.SelectedControllerTypeInfo.controller_type,save_type:n};i.binding={name:t,description:e,action_manifest_version:this.m_SelectedAppActions.version,category:this.SelectedBindingIsLegacy?"legacy":"steamvr_input",controller_type:this.SelectedControllerTypeInfo.controller_type,bindings:this.m_ModifiedBindingSet,options:this.m_ModifiedOptions,alias_info:this.m_ModifiedAliases,simulated_actions:Array.from(this.m_ModifiedSimulatedActions.values()),app_key:this.SelectedApp};let o=JSON.stringify(i);return console.log("Saving binding "+t+" for app "+this.SelectedApp),new Promise((t,e)=>{let i=new M(n,t,e);this.m_OutstandingSaveBindingCalls.push(i),c.a.post("/input/savebinding.action",o).then(t=>{t.data.error?(console.log("SaveCurrentBinding failed:",t.data.error),e(t.data.error)):console.log("SaveCurrentBinding Successful")}).catch(t=>{e(t)})})}))}PublishBindingToWorkshop(t){return Object(r.a)(this,void 0,void 0,(function*(){let e={app_key:this.SelectedApp,description:t};e.binding={bindings:this.m_ModifiedBindingSet,controller_type:this.SelectedControllerTypeInfo.controller_type};let n=JSON.stringify(e);yield new Promise((function(t,e){c.a.post("/input/submitworkshopbinding.action",n).then(e=>{console.log("PublishBindingToWorkshop response: ",e),t()}).catch(t=>{e(t)})}))}))}OnWebSocketOpen(t){console.log("Websocket connected"),this.m_eWebSocketState=s.eWebSocketState_Connected,this.WebSocketSend("input_open"),this.m_timerWebSocket&&clearTimeout(this.m_timerWebSocket),window.addEventListener("beforeunload",()=>{this.WebSocketSend("input_close")})}OnWebSocketClose(t){console.log("Websocket closed ",t),this.m_eWebSocketState=s.eWebSocketState_Disconnected,this.OpenWebSocketToHost()}WebSocketSend(t){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(t)}OnWorkshopUploadComplete(t){if(console.log("OnWorkshopUploadComplete: ",t),t.app_key!=this.SelectedApp)return void console.log("Ignoring binding load for an app we aren't viewing");if(this.m_OutstandingSaveBindingCalls.length<=0)return void console.log("Got workshop upload result without pending resolve");let e=this.m_OutstandingSaveBindingCalls.shift();t.success?(e.resolve(t),this.LoadActionManifest()):e.reject(t)}OnPendingFileSaved(t){console.log("OnPendingFileSaved: ",t),t.app_key==this.SelectedApp||console.log("Ignoring pending file saved for an app we aren't viewing")}get SaveNoticeText(){if(this.m_OutstandingSaveBindingCalls.length>0){let t=!1;return this.m_OutstandingSaveBindingCalls.forEach(e=>{"personal"!=e.SaveType&&"public"!=e.SaveType||(t=!0)}),t?"#SaveNotice_Uploading":"#SaveNotice_Saving"}}OnBindingConfigLoaded(t){if(console.log("OnBindingConfigLoaded: ",t," selected action set:",this.m_sSelectedActionSet),t.app_key!=this.SelectedApp)return void console.log("Ignoring binding load for an app we aren't viewing");if(t.uri!=this.m_sLoadedBindingURI)return void console.log(`Ignoring binding load for an config url ${t.uri} we aren't viewing ${this.m_sLoadedBindingURI}`);this.m_ControllerWatchers.clear(),this.m_LoadedBinding=t,this.m_ModifiedBindingSet=d.m.map();let e=Object(p.c)("#unknown_application"),n=m.a.GetApp(P.SelectedApp);if(n&&(e=n.name),this.m_sName="",this.m_sDescription="",t.binding_config&&(t.binding_config.hasOwnProperty("name")&&(this.m_sName=t.binding_config.name),t.binding_config.hasOwnProperty("description")&&(this.m_sDescription=t.binding_config.description)),""==this.m_sName){let t=P.SelectedControllerTypeInfo,n=g.a.LocalizeControllerString(t,t?t.controller_type:"");this.m_sName=Object(p.c)("#BindingUI_SaveDefaultName",e,n)}t.binding_config&&t.binding_config.bindings&&(Object.keys(t.binding_config.bindings).forEach(e=>{let n=new A;n.chords=t.binding_config.bindings[e].chords,n.poses=t.binding_config.bindings[e].poses,n.haptics=t.binding_config.bindings[e].haptics,n.skeleton=t.binding_config.bindings[e].skeleton,n.sources=new Array,t.binding_config.bindings[e].sources.forEach(t=>{let e=new b;e.mode=t.mode,e.path=t.path,e.inputs=d.m.map(),t.hasOwnProperty("inputs")&&Object.keys(t.inputs).forEach(n=>{e.inputs.set(n,t.inputs[n])}),null!=t.parameters&&Object.keys(t.parameters).length>0&&(e.parameters=d.m.map(),t.hasOwnProperty("parameters")&&Object.keys(t.parameters).forEach(n=>{e.parameters.set(n,t.parameters[n])})),n.sources.push(e)}),this.m_ModifiedBindingSet.set(e,n)}),this.m_ModifiedOptions.clear(),t.binding_config.options&&(Object.keys(t.binding_config.options).forEach(e=>{this.m_ModifiedOptions.set(e,t.binding_config.options[e])}),this.ManifestOptions.forEach(t=>{this.m_ModifiedOptions.has(t.name)||this.m_ModifiedOptions.set(t.name,t.default)})),this.m_ModifiedAliases.clear(),t.binding_config.alias_info&&Object.keys(t.binding_config.alias_info).forEach(e=>{this.m_ModifiedAliases.set(e,t.binding_config.alias_info[e])}),this.m_ModifiedSimulatedActions.clear(),t.binding_config.simulated_actions&&t.binding_config.simulated_actions.forEach(t=>{let e=this.ComputeSimulatedActionPathFromId(t.id);this.m_ModifiedSimulatedActions.set(e,t),t.id>=this.m_nNextSimulatedActionId&&(this.m_nNextSimulatedActionId=t.id+1)})),this.m_vecBindingSetWatchers.forEach(t=>{t()})}QueryBindingList(t,e){return null!=this.m_OutstandingQueryResolve&&console.warn("About to start second binding list query when one is already pending",this.m_OutstandingQueryResolve),new Promise((n,i)=>{this.m_OutstandingQueryResolve=n,c.a.get(`/input/queryworkshopbindings.json?app_key=${t}&controller_type=${e}`).then(t=>{console.log("QueryBindingList: ajax request successful")}).catch(t=>{i(t)})})}DeleteBinding(t){null!=this.m_OutstandingDeleteResolve&&console.warn("About to start second binding delete when one is already pending",this.m_OutstandingDeleteResolve);let e={url:t},n=JSON.stringify(e);return new Promise((e,i)=>{this.m_OutstandingDeleteResolve=e,this.m_sOutstandingDeleteURL=t,c.a.post("/input/deleteconfig.action",n).then(t=>{console.log("Delete ajax request successful")}).catch(t=>{i(t)})})}OnBindingDeleteComplete(t){null!=this.m_OutstandingDeleteResolve?t.url==this.m_sOutstandingDeleteURL&&(this.m_sOutstandingDeleteURL=void 0,this.m_OutstandingDeleteResolve(t),this.m_OutstandingDeleteResolve=void 0,console.log("OnDeleteComplete: ",t)):console.warn("Missing outstanding query resolve for binding delete")}OnBindingLoadFailed(t){console.log("OnBindingLoadFailed: "+t.app_key+" "+t.controller_type+" "+t.error),m.a.UpdateApplications().then(()=>{if(!m.a.ShouldShowBindingFailureForApp(t.app_key))return;if(!this.ShouldShowBindingFailureForControllerType(t.controller_type))return;if(!S.a.ShouldShowBindingFailure())return;this.m_rKnownFailedBindingUris.push(t.uri),this.SetSelectedApp(t.app_key),this.SetSelectedController(t.controller_type);let e=m.a.GetApp(t.app_key),n=g.a.GetControllerTypeInfo(t.controller_type);if(!n)return;let i=g.a.LocalizeControllerString(n,t.controller_type);S.a.ShowBindingList(Object(p.c)(t.error,e?e.name:Object(p.c)("#unknown_application"),i)),h.a.IsAvailable()&&h.a.ShowBindingUI(!1)})}ShouldShowBindingFailureForControllerType(t){if(null==t||""==t)return!1;let e=g.a.GetControllerTypeInfo(t);return!!e&&!!e.should_show_binding_errors}HasBindingUriFailedToLoad(t){return-1!=this.m_rKnownFailedBindingUris.indexOf(t)}OnQueryResults(t){console.log("OnQueryResults: ",t),null!=this.m_OutstandingQueryResolve?(this.m_OutstandingQueryResolve(t),this.m_OutstandingQueryResolve=void 0):console.warn("Missing outstanding query resolve for binding query")}SelectConfig(t,e,n){if(this.m_sLoadedBindingURI=n,console.log("Selecting config "+n+" for app "+t),this.SelectedBindingURL==n)return console.debug("Selecting the config we already have set",n),new Promise((t,e)=>{t()});let i={app_key:t,controller_type:e,url:n},o=JSON.stringify(i);return null!=this.m_OutstandingSelectConfigResolve&&console.warn("About to start second select config when one is already pending",this.m_OutstandingSelectConfigResolve),new Promise((t,e)=>{this.m_OutstandingSelectConfigResolve=t,c.a.post("/input/selectconfig.action",o).then(t=>{console.log("selectconfig ajax request successful")}).catch(t=>{e(t)})})}OnSelectConfigComplete(t){null!=this.m_OutstandingSelectConfigResolve?(this.m_OutstandingSelectConfigResolve(),this.m_OutstandingSelectConfigResolve=void 0,console.log("OnSelectConfigComplete: ",t)):t.error_to_show?S.a.ShowBindingList(t.error_to_show):console.warn("Missing outstanding query resolve for select config")}OnTrackersBindingChanged(t){this.GetTrackerBindings().then(t=>{this.m_TrackerBindingSetup=t})}OnActionManifestReloaded(t){t.app_key==this.SelectedApp&&this.ReloadCurrentApp()}OnActionManifestLoadFailed(t){S.a.ShowActionManifestLoadFailed(t.app_key,t.error,t.error_param,t.path)}OnShowActionOrigins(t){S.a.ShowActionOrigins(t.app_key,t.action_set,t.origin_to_highlight)}SetBindingURL(t){this.m_sLoadedBindingURI=t}OnActionBindingsReloaded(t){this.RefreshInputState()}GetControllerWatcherForSourceFromControllerType(t,e,n,o){let s=""+t.controller_type+e+n+o;if(!this.m_ControllerWatchers.has(s)){let r="";if("controller_handed"==t.input_bindingui_mode)switch(e){case i.eButtonSide_Left:r="/user/hand/left";break;case i.eButtonSide_Right:r="/user/hand/right"}else{let e=g.a.ConnectedDevices.find(e=>e.controller_type==t.controller_type);e&&e.root_path?r=e.root_path:console.log("Unable to find device path for controller type ",t)}this.m_ControllerWatchers.set(s,new j(r,t,e,n,o))}return this.m_ControllerWatchers.get(s)}OnWebSocketMessage(t){let e=JSON.parse(t.data);if("jsonid"in e&&"vr_input_get_notifications"==e.jsonid)for(let t in e.notifications){let n=e.notifications[t];switch(n.type){case"pending_file_saved":this.OnPendingFileSaved(n);break;case"workshop_upload_complete":this.OnWorkshopUploadComplete(n);break;case"query_results":this.OnQueryResults(n);break;case"action_bindings_reloaded":this.OnActionBindingsReloaded(n);break;case"delete_binding_complete":this.OnBindingDeleteComplete(n);break;case"binding_load_failed":this.OnBindingLoadFailed(n);break;case"select_config_complete":this.OnSelectConfigComplete(n);break;case"trackers_binding_changed":this.OnTrackersBindingChanged(n);break;case"action_manifest_reloaded":this.OnActionManifestReloaded(n);break;case"action_manifest_load_failed":this.OnActionManifestLoadFailed(n);break;case"show_action_origins":this.OnShowActionOrigins(n);break;case"refresh_input_state":this.RefreshInputState();break;case"binding_subscription_changed":this.m_nBindingSubscriptionChangedCanary++}}}get BindingConfig(){return null==this.m_ModifiedBindingSet?"":JSON.stringify(this.m_ModifiedBindingSet,null,"\t")}get BindingSubscriptionChangedCanary(){return this.m_nBindingSubscriptionChangedCanary}}Object(r.b)([d.m],T.prototype,"m_eWebSocketState",void 0),Object(r.b)([d.m],T.prototype,"m_sLoadedBindingURI",void 0),Object(r.b)([d.m],T.prototype,"m_LoadedBinding",void 0),Object(r.b)([d.m],T.prototype,"m_ModifiedBindingSet",void 0),Object(r.b)([d.m],T.prototype,"m_ModifiedOptions",void 0),Object(r.b)([d.m],T.prototype,"m_ModifiedAliases",void 0),Object(r.b)([d.m],T.prototype,"m_sName",void 0),Object(r.b)([d.m],T.prototype,"m_sDescription",void 0),Object(r.b)([d.m],T.prototype,"m_SelectedApp",void 0),Object(r.b)([d.m],T.prototype,"m_SelectedAppActions",void 0),Object(r.b)([d.m],T.prototype,"m_sSelectedActionSet",void 0),Object(r.b)([d.m],T.prototype,"m_sSelectedControllerType",void 0),Object(r.b)([d.m],T.prototype,"m_TrackerBindingSetup",void 0),Object(r.b)([d.m],T.prototype,"m_OutstandingSaveBindingCalls",void 0),Object(r.b)([d.m],T.prototype,"m_ModifiedSimulatedActions",void 0),Object(r.b)([d.m],T.prototype,"m_nBindingSubscriptionChangedCanary",void 0),Object(r.b)([l.bind],T.prototype,"OpenWebSocketToHost",null),Object(r.b)([d.f],T.prototype,"SteamVRUnavailable",null),Object(r.b)([d.f],T.prototype,"ActionSets",null),Object(r.b)([d.f],T.prototype,"ManifestOptions",null),Object(r.b)([d.f],T.prototype,"SecondaryControllerOptions",null),Object(r.b)([d.d],T.prototype,"SetOptionValue",null),Object(r.b)([d.d],T.prototype,"AddSimulatedAction",null),Object(r.b)([d.d],T.prototype,"DeleteSimulatedActionByPath",null),Object(r.b)([d.f],T.prototype,"SelectedApp",null),Object(r.b)([d.f],T.prototype,"SelectedAppActions",null),Object(r.b)([d.f],T.prototype,"CurrentAppCanAccessPrivateInputs",null),Object(r.b)([d.f],T.prototype,"SelectedControllerTypeInfo",null),Object(r.b)([d.f],T.prototype,"CurrentBindingSaveType",null),Object(r.b)([d.f],T.prototype,"CurrentBindingActionManifestVersion",null),Object(r.b)([d.f],T.prototype,"SelectedActionSet",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetDetails",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetActions",null),Object(r.b)([l.bind],T.prototype,"GetSelectedAppDefaultBinding",null),Object(r.b)([l.bind],T.prototype,"GetActionByName",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetPoses",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetHaptics",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetSkeletons",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetChords",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetChordCount",null),Object(r.b)([d.f],T.prototype,"SelectedActionSetSources",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasPoses",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasBoundPoses",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasHaptics",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasBoundHaptics",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasSkeletons",null),Object(r.b)([d.f],T.prototype,"BSelectedActionSetHasBoundSkeletons",null),Object(r.b)([d.d],T.prototype,"SetSelectedApp",null),Object(r.b)([d.d],T.prototype,"SetSelectedController",null),Object(r.b)([d.d],T.prototype,"SetSelectedActionSet",null),Object(r.b)([l.bind],T.prototype,"LocalizeStringForSelectedControllerType",null),Object(r.b)([l.bind],T.prototype,"LocalizePathNameForSelectedControllerType",null),Object(r.b)([d.f],T.prototype,"SelectedControllerTypeLocalizedName",null),Object(r.b)([d.d],T.prototype,"RegisterBindingWatcher",null),Object(r.b)([d.d],T.prototype,"UnregisterBindingWatcher",null),Object(r.b)([d.d],T.prototype,"GetActionBinding",null),Object(r.b)([l.bind],T.prototype,"GetInputModesForSourceType",null),Object(r.b)([l.bind],T.prototype,"GetBooleanInputOptionsForMode",null),Object(r.b)([l.bind],T.prototype,"GetActionBindingsOfType",null),Object(r.b)([d.f],T.prototype,"GetBooleanActionBindings",null),Object(r.b)([d.f],T.prototype,"GetVector1ActionBindings",null),Object(r.b)([d.f],T.prototype,"GetLiteralVector1ActionBindings",null),Object(r.b)([d.f],T.prototype,"GetVector2ActionBindings",null),Object(r.b)([d.f],T.prototype,"GetVector3ActionBindings",null),Object(r.b)([d.f],T.prototype,"GetPoseActionBindings",null),Object(r.b)([d.f],T.prototype,"GetHapticsActionBindings",null),Object(r.b)([d.f],T.prototype,"GetSkeletonActionBindings",null),Object(r.b)([d.f],T.prototype,"ConfigName",null),Object(r.b)([d.f],T.prototype,"ConfigDescription",null),Object(r.b)([l.bind],T.prototype,"GetPoseAction",null),Object(r.b)([l.bind],T.prototype,"GetPoseActionByPath",null),Object(r.b)([l.bind],T.prototype,"GetHapticsAction",null),Object(r.b)([l.bind],T.prototype,"GetHapticsActionByPath",null),Object(r.b)([l.bind],T.prototype,"GetSkeletonAction",null),Object(r.b)([l.bind],T.prototype,"GetSkeletonActionByPath",null),Object(r.b)([l.bind],T.prototype,"NotifyWatchersOfChange",null),Object(r.b)([d.d],T.prototype,"SetActionForInputModeType",null),Object(r.b)([d.d],T.prototype,"SetParameterForInputModeType",null),Object(r.b)([l.bind],T.prototype,"AddActionSetIfRequired",null),Object(r.b)([d.d],T.prototype,"AddInputModeForSource",null),Object(r.b)([d.d],T.prototype,"DeleteInputModeForSource",null),Object(r.b)([d.d],T.prototype,"SetInputModeForInputSource",null),Object(r.b)([d.d],T.prototype,"ClearModesForInputPath",null),Object(r.b)([d.d],T.prototype,"SetInputPathForPose",null),Object(r.b)([d.d],T.prototype,"SetPoseForInputPath",null),Object(r.b)([d.d],T.prototype,"AddDefaultPose",null),Object(r.b)([d.d],T.prototype,"SetInputPathForHaptics",null),Object(r.b)([d.d],T.prototype,"SetHapticsForInputPath",null),Object(r.b)([d.d],T.prototype,"AddDefaultHaptics",null),Object(r.b)([d.d],T.prototype,"SetInputPathForSkeleton",null),Object(r.b)([d.d],T.prototype,"SetSkeletonForInputPath",null),Object(r.b)([d.d],T.prototype,"AddDefaultSkeleton",null),Object(r.b)([d.d],T.prototype,"SetActionForChord",null),Object(r.b)([d.d],T.prototype,"DeleteChord",null),Object(r.b)([d.d],T.prototype,"AddChord",null),Object(r.b)([d.d],T.prototype,"DeleteSourceFromChord",null),Object(r.b)([d.d],T.prototype,"SetInputTypeForChord",null),Object(r.b)([d.d],T.prototype,"SetInputSourceForChord",null),Object(r.b)([d.d],T.prototype,"LoadActionManifest",null),Object(r.b)([d.f],T.prototype,"SelectedBindingURL",null),Object(r.b)([d.f],T.prototype,"LoadedBindingURL",null),Object(r.b)([d.f],T.prototype,"SelectedBindingIsLegacy",null),Object(r.b)([d.f],T.prototype,"IsSecondaryController",null),Object(r.b)([d.f],T.prototype,"TrackerBindings",null),Object(r.b)([d.d],T.prototype,"GetTrackerBindings",null),Object(r.b)([l.bind],T.prototype,"SetTrackerBinding",null),Object(r.b)([l.bind],T.prototype,"PulseHaptics",null),Object(r.b)([d.f],T.prototype,"KnownControllerTypes",null),Object(r.b)([l.bind],T.prototype,"AutosaveBinding",null),Object(r.b)([l.bind],T.prototype,"OnWebSocketOpen",null),Object(r.b)([l.bind],T.prototype,"OnWebSocketClose",null),Object(r.b)([l.bind],T.prototype,"WebSocketSend",null),Object(r.b)([l.bind],T.prototype,"OnWorkshopUploadComplete",null),Object(r.b)([l.bind],T.prototype,"OnPendingFileSaved",null),Object(r.b)([d.f],T.prototype,"SaveNoticeText",null),Object(r.b)([l.bind],T.prototype,"QueryBindingList",null),Object(r.b)([l.bind],T.prototype,"DeleteBinding",null),Object(r.b)([l.bind],T.prototype,"OnBindingDeleteComplete",null),Object(r.b)([l.bind],T.prototype,"OnBindingLoadFailed",null),Object(r.b)([l.bind],T.prototype,"ShouldShowBindingFailureForControllerType",null),Object(r.b)([l.bind],T.prototype,"HasBindingUriFailedToLoad",null),Object(r.b)([l.bind],T.prototype,"OnQueryResults",null),Object(r.b)([l.bind],T.prototype,"SelectConfig",null),Object(r.b)([l.bind],T.prototype,"OnSelectConfigComplete",null),Object(r.b)([l.bind],T.prototype,"OnTrackersBindingChanged",null),Object(r.b)([l.bind],T.prototype,"OnActionManifestReloaded",null),Object(r.b)([l.bind],T.prototype,"OnActionManifestLoadFailed",null),Object(r.b)([l.bind],T.prototype,"OnShowActionOrigins",null),Object(r.b)([l.bind],T.prototype,"SetBindingURL",null),Object(r.b)([l.bind],T.prototype,"OnActionBindingsReloaded",null),Object(r.b)([l.bind],T.prototype,"GetControllerWatcherForSourceFromControllerType",null),Object(r.b)([l.bind],T.prototype,"OnWebSocketMessage",null),Object(r.b)([d.f],T.prototype,"BindingConfig",null),Object(r.b)([d.f],T.prototype,"BindingSubscriptionChangedCanary",null);const P=new T;window.controllerBindingStore=P},"Q+Z6":function(t,e,n){"use strict";n.d(e,"e",(function(){return p})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return S})),n.d(e,"d",(function(){return f}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA"),a=n("EUJ1"),c=n("Gmup"),d=n("7uy8");const p=16,u=.2,h=5,S=.02,m="change_route",g="app_config_changed",b="workshop_state_changed";class _{constructor(){this.m_wsWebSocketToServer=void 0,this.m_mailbox=new a.CVRMailbox,this.showInternalSettings=!1,this.workshopStateChangedCanary=1,this.onRestartRequired=null,this.pendingChanges=new Map,this.route=[],this.m_mapSettingsLastWriteInfo=new Map,this.m_bIsSettingApp=!1,this.m_bInitStarted=!1,this.GetAppList=function(){return new Promise((function(t,e){r.a.get("/app/list.json").then(e=>{t(e.data.apps)}).catch(t=>{e(t)})}))},this.GetSettingsUGC=function(){return new Promise((function(t,e){r.a.get("/settings_getugc").then(e=>{t(e.data)}).catch(t=>{e(t)})}))},this.ReloadSettingsSchema=function(){return new Promise((function(t,e){r.a.get("/settings_reloadschema").then(e=>{t(e.data)}).catch(t=>{e(t)})}))},this.GetSettingsInfo=function(){return new Promise((function(t,e){r.a.get("/settings_getinfo").then(e=>{t(e.data)}).catch(t=>{e(t)})}))}}OpenWebSocketToHost(){return new Promise((t,e)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",e=>{this.OnWebSocketOpen(e),t()}),this.m_wsWebSocketToServer.addEventListener("message",this.OnWebSocketMessage),this.m_wsWebSocketToServer.addEventListener("close",this.OnWebSocketClose)})}Init(t){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.m_bInitStarted){if(this.m_bInitStarted=!0,this.m_bIsSettingApp=t,this.connected=!1,this.settings=new Map,this.m_bIsSettingApp&&(window.addEventListener("hashchange",this.onHashChanged),this.onHashChanged()),Object(l.e)(()=>{let t=[];if(0!=this.pendingChanges.size){for(const[e,n]of this.pendingChanges.entries())t.push({name:e,value:n});this.pendingChanges.clear(),r.a.post("/settings_set.action",t).then(t=>{}).catch(e=>{console.log("Failed to save settings! This usually happens when type is set incorrectly on one of the keys in the schema. ",t)})}},{delay:300}),VRHTML.IsAvailable()&&VRHTML.RegisterForDisplayModeNotSupportedEvents(this.SetRestartRequired),!this.m_mailbox.connected)try{yield this.m_mailbox.Init(VRHTML.Environment()==a.VRHTMLEnvironment.Overlay?"settings/overlay":"settings/desktop"),this.m_mailbox.RegisterHandler(b,this.OnWorkshopStateChangedMessage),this.m_mailbox.RegisterHandler(m,this.OnChangeRouteMessage),this.m_mailbox.RegisterHandler(g,this.OnAppConfigChangedMessage)}catch(t){console.log("Failed to open settings mailbox:"+t)}yield this.OpenWebSocketToHost()}}))}OnWorkshopStateChangedMessage(t){this.workshopStateChangedCanary++}OnChangeRouteMessage(t){this.setRoute(t.page,t.section)}OnAppConfigChangedMessage(t){return Object(i.a)(this,void 0,void 0,(function*(){const e=yield this.GetAppList();let n;for(let i=0;i<this.apps.length;i++)e[i].key==t.app&&(n=e[i]);if(n){for(let e=0;e<this.apps.length;e++)if(this.apps[e].key==t.app)return!this.apps[e].is_autolaunch&&n.is_autolaunch&&this.SetRestartRequired(),void(this.apps[e]=Object.assign(Object.assign(Object.assign({},this.apps[e]),{current_scene_process:!1}),n));this.apps.push(n)}else for(let e=0;e<this.apps.length;e++)if(this.apps[e].key==t.app){this.apps.splice(e,1);break}}))}onHashChanged(){if(!this.m_bIsSettingApp)return;const t=window.location.hash;0===t.indexOf("#")?this.route=t.substring(1).split("/"):this.route=[]}get routePage(){return this.route.length>=1?this.route[0]:null}get routePageSection(){return this.route.length>=2?this.route[1]:null}setRoutePage(t){this.setRoute(t)}setRoutePageSection(t){this.setRoute(this.routePage,t)}setRoute(t,e){this.m_bIsSettingApp&&(t=t||"",this.route=e?[t,e]:[t],window.location.hash=this.route.join("/"))}SetDashboardFadeSupression(t,e){this.m_mailbox.connected&&this.m_mailbox.SendMessage(c.a.k_sDashboardMailboxName,{type:c.a.k_sSetDashboardFadeSupressionMessage,suppress_dashboard_fade:e,for_id:t})}SetDashboardForceBoundsVisible(t,e,n){this.m_mailbox.connected&&this.m_mailbox.SendMessage(c.a.k_sDashboardMailboxName,{type:c.a.k_sSetDashboardForceBoundsVisible,force_bounds_visible:n,for_overlay_key:t,for_id:e})}SetRestartRequired(){this.onRestartRequired&&this.onRestartRequired()}OnWebSocketOpen(t){this.connected=!0,this.WebSocketSend("settings_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("settings_close")}),f.GetSettingsInfo().then(t=>{this.systemInfo=t}),f.GetAppList().then(t=>{this.apps=t})}OnWebSocketClose(t){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(t){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(t)}OnWebSocketMessage(t){let e=JSON.parse(t.data);switch(e.jsonid){case"vr_settings":this.OnVRSettings(e);break;case"vr_settings_schema":this.OnVRSettingsSchema(e);break;case"vr_audio_devices":this.OnVRAudioDevices(e);break;case"vr_app_list":this.OnVRAppList(e);break;default:e.jsonid?console.log("Received unhandled event: "+e.jsonid):console.log("Received unknown message: ",e)}}OnVRSettings(t){for(let e in t.values){const n=t.values[e];if(this.settings.get(e)!=n||this.m_mapSettingsLastWriteInfo.has(e)){if(this.settingsSchema){const t=this.GetSettingSchema(e);t&&t.requires_restart&&this.SetRestartRequired()}this.SetSettingValueFromServer(e,n)}}}SetSettingValueFromServer(t,e){const n=1e3*_.SERVER_SETTING_MERGE_DEFER_DURATION;if(this.m_mapSettingsLastWriteInfo.has(t)){let i=this.m_mapSettingsLastWriteInfo.get(t);if((new Date).getTime()-i.nLastUserUpdateTime<n)return window.clearTimeout(i.nPendingServerValueUpdateTimeout),void(i.nPendingServerValueUpdateTimeout=window.setTimeout(()=>{this.SetSettingValueFromServer(t,e)},n));window.clearTimeout(i.nPendingServerValueUpdateTimeout),this.m_mapSettingsLastWriteInfo.delete(t)}this.settings.set(t,e)}UpdateLastUserWriteTimeForSetting(t){const e=(new Date).getTime();this.m_mapSettingsLastWriteInfo.has(t)?this.m_mapSettingsLastWriteInfo.get(t).nLastUserUpdateTime=e:this.m_mapSettingsLastWriteInfo.set(t,{nLastUserUpdateTime:e,nPendingServerValueUpdateTimeout:0})}OnVRSettingsSchema(t){null==this.settingsSchema&&(console.log("Got vr settings schema"),this.settingsSchema=t.schema,this.showInternalSettings=t.is_steamvr_main)}OnVRAudioDevices(t){console.log("Got audio devices"),this.audioDevices=t}OnVRAppList(t){this.apps=t.apps}SettingNameMatches(t,e){if(e.endsWith("*")){let n=e.length-1;return t.substr(0,n)==e.substr(0,n)}return t==e}GetSettingSchema(t){for(let e of this.settingsSchema)if(e.values)for(let n of e.values)if(this.SettingNameMatches(t,n.name))return n;return null}ResetSettingsValue(t){this.SetSettingsValue(t,null)}ResetSettingsValues(...t){t.forEach(this.ResetSettingsValue)}SetSettingsValue(t,e){let n=this.GetSettingSchema(t);null!=n?(null!=e&&("int"==n.type?e=parseInt(e):"float"==n.type?e=parseFloat(e):"string"==n.type?e=""+e:"bool"==n.type&&(e=!!e)),n.requires_restart&&this.SetRestartRequired(),this.SetSettingsStringValueWithoutSchema(t,e)):console.log("Tried to set setting "+t+" but it's not in the schema! Aborting")}SetSettingsStringValueWithoutSchema(t,e){if(VRHTML.IsAvailable()){const n=t.split("/");if(4!=n.length||""!=n[0]||"settings"!=n[1])throw new Error("bad settings path "+t);VRHTML.VRSettings.Set(n[2],n[3],e),this.settings.set(t,VRHTML.VRSettings.Get(n[2],n[3]))}else null!=e&&this.settings.set(t,e),this.pendingChanges.set(t,e);this.UpdateLastUserWriteTimeForSetting(t)}GetSettingsValue(t){return Object(i.a)(this,void 0,void 0,(function*(){return new Promise((function(e,n){r.a.get("/settings_get",{params:{name:t}}).then(t=>{e(t.data)}).catch(t=>{n(null)})}))}))}ResetAppSettings(t){return r.a.post("/app/resetsettings",{app:t}).then(e=>this.GetAppSettings(t)).catch(t=>{})}SetAppSettings(t,e){let n=Object.assign(Object.assign({},e),{app:t});r.a.post("/app/setsettings",n);for(let t=0;t<this.apps.length;t++)if(this.apps[t].key==n.app){!this.apps[t].is_autolaunch&&e.is_autolaunch&&this.SetRestartRequired(),this.apps[t]=Object.assign(Object.assign({},this.apps[t]),e);break}}GetAppSettings(t){return Object(i.a)(this,void 0,void 0,(function*(){return new Promise((function(e,n){r.a.get("/app/getsettings",{params:{app:t}}).then(t=>{e(t.data)}).catch(t=>{n(null)})}))}))}get NumSupersamplingSteps(){return Math.floor((h-u+.5*S)/S)}SliderposToSupersample(t){return t>h?h:t<u?u:t}get showAdvancedSettings(){return this.settings.get(d.j)}set showAdvancedSettings(t){this.SetSettingsValue(d.j,t)}showBindingCallouts(t){let e={type:"request_binding_callouts",app_key:t};this.m_mailbox.SendMessage("binding_callouts",e)}}_.SERVER_SETTING_MERGE_DEFER_DURATION=1,Object(i.b)([l.m],_.prototype,"connected",void 0),Object(i.b)([l.m],_.prototype,"settingsSchema",void 0),Object(i.b)([l.m],_.prototype,"settings",void 0),Object(i.b)([l.m],_.prototype,"systemInfo",void 0),Object(i.b)([l.m],_.prototype,"audioDevices",void 0),Object(i.b)([l.m],_.prototype,"apps",void 0),Object(i.b)([l.m],_.prototype,"showInternalSettings",void 0),Object(i.b)([l.m],_.prototype,"workshopStateChangedCanary",void 0),Object(i.b)([l.m],_.prototype,"pendingChanges",void 0),Object(i.b)([l.m],_.prototype,"route",void 0),Object(i.b)([o.bind],_.prototype,"OpenWebSocketToHost",null),Object(i.b)([o.bind],_.prototype,"OnWorkshopStateChangedMessage",null),Object(i.b)([o.bind],_.prototype,"OnChangeRouteMessage",null),Object(i.b)([o.bind],_.prototype,"OnAppConfigChangedMessage",null),Object(i.b)([l.d.bound],_.prototype,"onHashChanged",null),Object(i.b)([l.f],_.prototype,"routePage",null),Object(i.b)([l.f],_.prototype,"routePageSection",null),Object(i.b)([l.d],_.prototype,"setRoutePage",null),Object(i.b)([l.d],_.prototype,"setRoutePageSection",null),Object(i.b)([l.d],_.prototype,"setRoute",null),Object(i.b)([o.bind],_.prototype,"SetDashboardFadeSupression",null),Object(i.b)([o.bind],_.prototype,"SetDashboardForceBoundsVisible",null),Object(i.b)([o.bind],_.prototype,"SetRestartRequired",null),Object(i.b)([o.bind],_.prototype,"OnWebSocketOpen",null),Object(i.b)([o.bind],_.prototype,"OnWebSocketClose",null),Object(i.b)([o.bind],_.prototype,"WebSocketSend",null),Object(i.b)([o.bind],_.prototype,"OnWebSocketMessage",null),Object(i.b)([l.d],_.prototype,"OnVRSettings",null),Object(i.b)([l.d],_.prototype,"SetSettingValueFromServer",null),Object(i.b)([l.d],_.prototype,"OnVRSettingsSchema",null),Object(i.b)([l.d.bound],_.prototype,"ResetSettingsValue",null),Object(i.b)([l.d],_.prototype,"ResetSettingsValues",null),Object(i.b)([l.d],_.prototype,"SetSettingsValue",null),Object(i.b)([l.d],_.prototype,"SetSettingsStringValueWithoutSchema",null),Object(i.b)([l.f],_.prototype,"NumSupersamplingSteps",null);const f=new _;window.VRSettingsState=f},Z0gP:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA");class a{constructor(){this.m_wsWebSocketToServer=void 0,this.IdentifyController=function(t){return t?new Promise((function(e,n){r.a.get("/identify_controller.action?serial="+t).then(t=>{e()}).catch(t=>{n(t)})})):null},this.GetUSBDeviceList=function(){return new Promise((function(t,e){r.a.get("/usb_topology.action").then(e=>{t(e.data)}).catch(t=>{e(t)})}))},this.ToggleRoomOverview=function(t){return new Promise((function(e,n){r.a.get("/toggle_room_overview_feed.action?enabled="+(t?"1":"0")).then(t=>{e()}).catch(t=>{n(t)})}))}}OpenWebSocketToHost(){return new Promise((t,e)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",e=>{this.OnWebSocketOpen(e),t()}),this.m_wsWebSocketToServer.addEventListener("message",this.OnWebSocketMessage),this.m_wsWebSocketToServer.addEventListener("close",this.OnWebSocketClose)})}Init(){return Object(i.a)(this,void 0,void 0,(function*(){this.connected=!1,this.framerate=[],this.status={jsonid:"",startup_info:"",status_string:"",is_main:!1,is_perforce:!1,hostname:"",states:[]},this.roomoverview={jsonid:"",collision:[],playarea:[],devices:[],bounds_visible:!1,compositor_available:!1},yield this.OpenWebSocketToHost()}))}OnWebSocketOpen(t){this.connected=!0,this.WebSocketSend("websocket_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("websocket_close")})}OnWebSocketClose(t){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(t){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(t)}OnWebSocketMessage(t){let e=JSON.parse(t.data);switch(e.jsonid){case"vr_system_status":this.OnSystemStatusMessage(e);break;case"vr_framerate":this.OnFramerateMessage(e);break;case"vr_notifications":this.OnNotificationsMessage(e);break;case"vr_room_overview":this.OnRoomOverviewMessage(e);break;default:e.jsonid?console.log("Received unhandled event: "+e.jsonid):console.log("Received unknown message: ",e)}}OnSystemStatusMessage(t){this.status=t}OnFramerateMessage(t){for(this.framerate.unshift(t);this.framerate.length>60;)this.framerate.pop()}OnNotificationsMessage(t){let e=t.notifications.map((t,e)=>({title:t.sTitle,description:t.sDescription,timestamp:t.sTimeStamp}));this.notifications=e}OnRoomOverviewMessage(t){this.roomoverview=t}LaunchApplication(t){return new Promise((function(e,n){r.a.get("/steamvr_launch_application.action?param1="+t).then(t=>{e()}).catch(t=>{n(t)})}))}TEMP_RegisterPollingWebsocketMessage(t,e){setInterval(()=>{r.a.get(t).then(t=>{this.OnWebSocketMessage({data:JSON.stringify(t.data)})}).catch(t=>{})},e)}}Object(i.b)([l.m],a.prototype,"status",void 0),Object(i.b)([l.m],a.prototype,"framerate",void 0),Object(i.b)([l.m],a.prototype,"notifications",void 0),Object(i.b)([l.m],a.prototype,"roomoverview",void 0),Object(i.b)([l.m],a.prototype,"connected",void 0),Object(i.b)([o.bind],a.prototype,"OpenWebSocketToHost",null),Object(i.b)([o.bind],a.prototype,"OnWebSocketOpen",null),Object(i.b)([o.bind],a.prototype,"OnWebSocketClose",null),Object(i.b)([o.bind],a.prototype,"WebSocketSend",null),Object(i.b)([o.bind],a.prototype,"OnWebSocketMessage",null),Object(i.b)([o.bind],a.prototype,"TEMP_RegisterPollingWebsocketMessage",null);const c=new a;window.VRSystemState=c},dGfu:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("mrSG"),o=n("7wIv"),s=n("2vnA");class r{constructor(){this.m_wsWebSocketToServer=void 0,this.vecMessageBuffer=s.m.array()}OpenWebSocketToHost(){return new Promise((t,e)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",e=>{this.OnWebSocketOpen(e),t()}),this.m_wsWebSocketToServer.addEventListener("message",t=>{this.OnWebSocketMessage(t)}),this.m_wsWebSocketToServer.addEventListener("close",t=>{this.OnWebSocketClose(t)})})}Init(){return Object(i.a)(this,void 0,void 0,(function*(){this.connected||(this.vecMessages=[],Object(s.e)(()=>{this.vecMessages=this.vecMessages.concat(this.vecMessageBuffer.splice(0,this.vecMessageBuffer.length)).map((t,e)=>({item:t,index:e})).sort((t,e)=>t.item.nTimestamp-e.item.nTimestamp||t.index-e.index).map(({item:t})=>t)},{delay:300}),yield this.OpenWebSocketToHost())}))}OnWebSocketOpen(t){this.connected=!0,this.WebSocketSend("console_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("console_close")})}OnWebSocketClose(t){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(t){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(t)}OnWebSocketMessage(t){let e=JSON.parse(t.data);this.OnConsoleMessage(e)}OnConsoleMessage(t){let e=t.sMessage.indexOf("-");t.sTimestamp=t.sMessage.substr(0,e),t.sMessage=t.sMessage.substr(e+1),this.vecMessageBuffer.push(t)}}Object(i.b)([s.m],r.prototype,"connected",void 0),Object(i.b)([s.m],r.prototype,"vecMessages",void 0),Object(i.b)([o.bind],r.prototype,"OpenWebSocketToHost",null),Object(i.b)([o.bind],r.prototype,"OnWebSocketOpen",null),Object(i.b)([o.bind],r.prototype,"OnWebSocketClose",null),Object(i.b)([o.bind],r.prototype,"WebSocketSend",null),Object(i.b)([o.bind],r.prototype,"OnWebSocketMessage",null);const l=new r;window.VRConsoleState=l},dO2U:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA");class a{constructor(t){this.m_communityData=void 0,this.m_bLoadingData=!1,this.m_sSteamID=void 0,this.m_dateLastUpdate=void 0,this.m_sSteamID=t,t.length>0&&this.EnsureCommunityDataLoaded()}get community_data_ready(){return void 0!==this.m_communityData}get avatar_url(){return this.m_communityData&&this.m_communityData.avatar_url}get persona_name(){return this.m_communityData&&this.m_communityData.persona_name}get player_level(){return this.m_communityData&&this.m_communityData.level}get player_level_class(){return this.m_communityData&&this.m_communityData.level_class}get player_badge(){return this.m_communityData&&this.m_communityData.favorite_badge}get player_in_game(){return this.m_communityData&&this.m_communityData.in_game}EnsureCommunityDataLoaded(){if(void 0===this.m_communityData&&!this.m_bLoadingData){this.m_bLoadingData=!0;let t="https://steamcommunity.com/";r.a.get(t+"miniprofile/s"+this.m_sSteamID+"/json").then(t=>{let e=t.data;e&&e.avatar_url&&(this.m_communityData=e,this.m_dateLastUpdate=new Date),this.m_bLoadingData=!1}).catch(t=>{console.log(t),this.m_bLoadingData=!1})}}}Object(i.b)([l.m],a.prototype,"m_communityData",void 0),Object(i.b)([o.bind],a.prototype,"EnsureCommunityDataLoaded",null);class c{constructor(){this.m_SteamCommunityUsers=l.m.map()}GetUserInformation(t){return this.m_SteamCommunityUsers.has(t)||this.RequestUserInformation(t),this.m_SteamCommunityUsers.get(t)}RequestUserInformation(t){this.m_SteamCommunityUsers.hasOwnProperty(t)||this.m_SteamCommunityUsers.set(t,new a(t))}}Object(i.b)([l.m],c.prototype,"m_SteamCommunityUsers",void 0),Object(i.b)([o.bind],c.prototype,"GetUserInformation",null),Object(i.b)([o.bind],c.prototype,"RequestUserInformation",null);const d=new c;window.steamcommunity=d},hcOo:function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return r}));n("q1tI");function i(t){let e=window.location.search.substring(1).split("&");for(let n=0;n<e.length;n++){let i=e[n].split("=");if(decodeURIComponent(i[0]).toUpperCase()==t.toUpperCase())return decodeURIComponent(i[1])}return""}function o(...t){return t.filter(t=>null!=t&&("string"==typeof t||t[1])).map(t=>"string"==typeof t?t:t[0]).join(" ")}function s(t,e){let n=e;for(;n.parentElement&&!t.some(t=>n.matches(t));)n=n.parentElement;return n}function r(t){let e=[],n=t.parentElement;for(;n;){const t=n.scrollWidth>n.clientWidth,i=n.scrollHeight>n.clientHeight;(t||i)&&e.push(n),n=n.parentElement}return e}},lbBr:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i,o=n("mrSG"),s=n("q1tI"),r=n("i8i4"),l=n("7wIv"),a=n("hcOo"),c=n("GxMB"),d=n("2vnA"),p=n("EUJ1"),u=n("okNM");let h=i=class extends s.Component{constructor(t){super(t),this.m_elemModalContainer=null,this.m_elemModalPortal=null,this.m_ref=s.createRef(),this.state={elemBoundingParent:window.document.body,bInDOM:!1},this.m_elemModalPortal=document.createElement("div"),this.m_elemModalPortal.classList.add(i.ELEM_CLASS)}get modalContainer(){return this.m_ref.current?(null===this.m_elemModalContainer&&(this.m_elemModalContainer=Object(a.b)(["body","vsg-app","vsg-mountable","vsg-panel",...this.allowableParentSelectors],this.m_ref.current)),this.m_elemModalContainer):null}get allowableParentSelectors(){return this.props.allowableParentSelectors?this.props.allowableParentSelectors:[]}componentDidMount(){this.modalContainer.appendChild(this.m_elemModalPortal),window.addEventListener("keydown",this.onWindowKeyDown),this.setState({elemBoundingParent:Object(a.b)(["body","vsg-panel",...this.allowableParentSelectors],this.m_ref.current),bInDOM:!0}),i.modalStack.push(this)}componentWillUnmount(){this.modalContainer.removeChild(this.m_elemModalPortal),window.removeEventListener("keydown",this.onWindowKeyDown),i.modalStack.splice(i.modalStack.indexOf(this))}onWindowKeyDown(t){"Escape"==t.key&&this.props.onDismissRequested&&this.dismiss()}onBackdropClick(){this.props.onDismissRequested&&this.dismiss()}dismiss(){c.a.currentDropdown||i.modalStack.indexOf(this)<i.modalStack.length-1||this.props.onDismissRequested()}render(){if(!this.props.children||!this.m_elemModalPortal)return null;const t=i.modalStack.indexOf(this),e=i.modalStack.length-t-1,n=VRHTML.Environment()==p.VRHTMLEnvironment.Overlay&&e>0,o=this.state.elemBoundingParent.getBoundingClientRect();let l=Object.assign({},this.props);return delete l.onDismissRequested,delete l.backdropClassName,delete l.allowableParentSelectors,s.createElement(s.Fragment,null,s.createElement("div",{className:"ModalAnchor",ref:this.m_ref}),r.createPortal(s.createElement(s.Fragment,null,s.createElement("div",{className:"ModalBackdrop "+(this.props.backdropClassName?this.props.backdropClassName:""),style:{zIndex:3e3+2*t},onClick:this.onBackdropClick}),s.createElement("div",Object.assign({},l,{className:Object(a.a)("Modal",this.props.className,["FadedForModal",n]),style:{maxWidth:o.width-2*i.MODAL_BOUNDS_MARGIN,maxHeight:o.height-2*i.MODAL_BOUNDS_MARGIN,zIndex:3e3+2*t+1}}),this.state.bInDOM&&this.props.children)),this.m_elemModalPortal))}};h.modalStack=d.m.array([]),h.ELEM_CLASS="v-modal-portal",h.MODAL_BOUNDS_MARGIN=10,Object(o.b)([l.bind],h.prototype,"onWindowKeyDown",null),Object(o.b)([l.bind],h.prototype,"onBackdropClick",null),Object(o.b)([l.bind],h.prototype,"dismiss",null),h=i=Object(o.b)([u.a],h)},nAcY:function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return o})),function(t){t[t.ButtonEnter=0]="ButtonEnter",t[t.ButtonLeave=1]="ButtonLeave",t[t.Snap=2]="Snap",t[t.Sliding=3]="Sliding"}(i||(i={}));class o{constructor(){}static get Instance(){return o.s_Instance||(o.s_Instance=new o),o.s_Instance}triggerHaptic(t){let e=0,n=0,o=0;switch(t){case i.ButtonEnter:e=0,n=1,o=.16;break;case i.ButtonLeave:e=0,n=1,o=.08;break;case i.Snap:e=0,n=1,o=.16;break;case i.Sliding:e=0,n=1,o=.06}o>0&&VRHTML.VROverlay.TriggerLaserMouseHapticVibration(VRHTML.VROverlay.ThisOverlayHandle(),e,n,o)}}o.s_Instance=null},pYJh:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return S}));var i,o=n("mrSG"),s=n("7wIv"),r=n("2vnA"),l=n("EUJ1"),a=n.n(l),c=n("GXif"),d=n("MYgy"),p=n("Kysl"),u=n("tUsp");!function(t){t[t.None=0]="None",t[t.List=1]="List",t[t.ViewBinding=2]="ViewBinding",t[t.EditBinding=3]="EditBinding",t[t.AppSelect=4]="AppSelect",t[t.Debugger=5]="Debugger",t[t.TrackerEdit=6]="TrackerEdit"}(i||(i={}));class h{constructor(){this.m_State=i.None,this.m_bLoading=!1,this.m_rBindingList=void 0,this.m_bShowBindingListError=!1,this.m_sBindingListError=void 0,this.m_timeoutLoading=void 0,this.m_pathUpdateTimer=void 0,this.m_bShowManifestError=!1,this.m_sManifestError=void 0,this.m_sManifestErrorPath=void 0,this.m_bStandaloneSettingsPage=!1,this.m_bDesktopMode=!1}Init(){window.addEventListener("popstate",this.OnPopState),history.pushState({direction:"back"},"back"),history.pushState({direction:"current"},"current"),history.pushState({direction:"forward"},"forward"),history.back();let t="bindingui/"+l.VRHTMLEnvironment[a.a.Environment()];this.m_mailbox=new l.CVRMailbox,this.m_mailbox.Init(t),this.m_mailbox.RegisterHandler("show_tracker_ui",this.OnShowTrackerUI),this.m_mailbox.RegisterHandler("show_app_select",this.OnShowAppSelect),this.m_mailbox.RegisterHandler("show_app_binding",this.OnShowAppBinding),Object(r.e)(this.UpdateWindowTitle)}ShowOverlayInDashboard(){this.IsRunningInDashboard&&a.a.VROverlay.ShowDashboard("system.vrwebhelper.controllerbinding")}OnShowTrackerUI(t){this.m_bStandaloneSettingsPage=!0,this.ShowTrackerEdit(),this.ShowOverlayInDashboard()}OnShowAppSelect(t){this.m_bStandaloneSettingsPage=!1,this.ShowAppSelect()}OnShowAppBinding(t){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,p.a.UpdateApplications().then(()=>{if(a.a.Environment()==l.VRHTMLEnvironment.Overlay&&this.ShowOverlayInDashboard(),!p.a.GetApp(t.app_key))return console.log("Warning: Could not find app key: "+t.app_key+" showing app select."),void this.ShowAppSelect();d.a.SetSelectedApp(t.app_key,!0),d.a.ReloadCurrentApp().then(()=>{if(t.controller_type)return d.a.SetSelectedController(t.controller_type,!0),void d.a.ReloadControllerConfiguration().then(()=>{t.action_set&&d.a.SetSelectedActionSet(t.action_set),this.Loading=!1,this.EditCurrentBinding()});this.Loading=!1,this.ShowBindingList()})})}OnTrackerBack(){this.m_bStandaloneSettingsPage?(this.ReturnToSettingsUI(),this.ShowAppSelect()):this.ShowBindingList()}SetStandaloneSettingsPage(t){this.m_bStandaloneSettingsPage=t}get ShouldShowTrackerBackButton(){return!this.m_bStandaloneSettingsPage||!this.m_bDesktopMode}SetDesktopMode(t){this.m_bDesktopMode=t}get DesktopMode(){return this.m_bDesktopMode}SetBindingListError(t){this.m_bShowBindingListError=null!=t,this.m_sBindingListError=t}get ShowBindingListError(){return this.m_bShowBindingListError}get BindingListError(){return this.m_sBindingListError}OnPopState(t){let e="";t.state&&t.state.direction&&(e=t.state.direction),"back"==e?(this.m_bStandaloneSettingsPage&&(this.SetStandaloneSettingsPage(!1),this.ReturnToSettingsUI()),this.GoBackPage(),history.forward()):"forward"==e&&(history.back(),this.GoForwardPage())}GoBackPage(){switch(this.m_State){default:case i.None:case i.AppSelect:break;case i.Debugger:case i.List:this.ShowAppSelect();break;case i.TrackerEdit:case i.EditBinding:case i.ViewBinding:this.ShowBindingList()}}GoForwardPage(){switch(this.m_State){default:case i.None:case i.AppSelect:this.ShowBindingList();break;case i.List:this.CurrentBinding.url==d.a.LoadedBindingURL?this.EditCurrentBinding():this.ViewCurrentBinding();break;case i.EditBinding:case i.ViewBinding:case i.TrackerEdit:}}get GetUIState(){return this.m_State}get BindingQueryResults(){return this.m_rBindingList}get Loading(){return this.m_bLoading}set Loading(t){this.m_bLoading=t,t?(this.m_timeoutLoading&&clearTimeout(this.m_timeoutLoading),this.m_timeoutLoading=window.setTimeout(()=>{this.Loading=!1},1e4)):this.m_timeoutLoading&&clearTimeout(this.m_timeoutLoading)}IsSafeToResetControllerType(t,e){return this.m_State==i.AppSelect||this.m_State==i.None||"TrackedDeviceClass_HMD"==t&&"TrackedDeviceClass_Controller"==e&&this.m_State!=i.TrackerEdit}EditCurrentBinding(){this.m_State=i.EditBinding}ViewCurrentBinding(){this.m_State=i.ViewBinding}ShowBindingList(t){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,this.RefreshBindingList().then(()=>{this.SetBindingListError(t),this.Loading=!1,this.m_State=i.List}).catch(()=>{this.Loading=!1})}get CurrentBinding(){if(this.BindingQueryResults)return S.BindingQueryResults.find(t=>t.url==d.a.SelectedBindingURL)}ReturnToSettingsUI(){this.ShowAppSelect(),this.IsRunningInDashboard&&a.a.ShowSettingsUI()}ShowAppSelect(){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,p.a.UpdateApplications().then(()=>{this.Loading=!1,this.m_State=i.AppSelect}).catch(()=>{this.Loading=!1})}UpdatePathsTimeout(){try{u.a.UpdatePaths().then(()=>{this.m_State==i.Debugger?this.m_pathUpdateTimer=window.setTimeout(this.UpdatePathsTimeout,500):this.m_pathUpdateTimer=void 0})}catch(t){console.log("Stopping debugger timer because",t)}}ShowDebugger(){this.Loading=!0,p.a.UpdateApplications().then(()=>{this.Loading=!1;let t=p.a.GetApp(d.a.SelectedApp);t&&t.client_container_handle&&u.a.AddSubscribedContainer(t.client_container_handle),this.m_State=i.Debugger,this.m_pathUpdateTimer=window.setTimeout(this.UpdatePathsTimeout,500)}).catch(()=>{this.Loading=!1})}ShowTrackerEdit(){this.m_State=i.TrackerEdit}ShouldShowBindingFailure(){return this.m_State!=i.TrackerEdit}RefreshBindingList(){return Object(o.a)(this,void 0,void 0,(function*(){this.Loading=!0,yield new Promise((t,e)=>{let n=d.a.SelectedControllerTypeInfo;d.a.QueryBindingList(d.a.SelectedApp,n?n.controller_type:"").then(e=>{e.success&&(this.m_rBindingList=e.results,this.Loading=!1,t())}).catch(()=>{this.Loading=!1})})}))}get IsRunningInDashboard(){return a.a.Environment()==l.VRHTMLEnvironment.Overlay}ShowActionManifestLoadFailed(t,e,n,i){let o=p.a.GetApp(t);this.m_sManifestError=Object(c.c)(e,o?o.name:t,n),this.m_sManifestErrorPath=i,this.m_bShowManifestError=!0,this.ShowAppSelect()}ManifestLoadErrorClose(){this.m_sManifestError=void 0,this.m_sManifestErrorPath=void 0,this.m_bShowManifestError=!1}get ShowManifestError(){return this.m_bShowManifestError}get ManifestError(){return this.m_sManifestError}get ManifestErrorPath(){return this.m_sManifestErrorPath}ShowActionOrigins(t,e,n){p.a.UpdateApplications().then(()=>{d.a.SetSelectedApp(t),e&&d.a.SetSelectedActionSet(e),S.ViewCurrentBinding(),a.a.ShowBindingUI(!this.IsRunningInDashboard)})}UpdateWindowTitle(){setTimeout(()=>{switch(this.GetUIState){case i.AppSelect:case i.Debugger:case i.EditBinding:case i.List:case i.None:case i.ViewBinding:document.title=Object(c.c)("#BindingUI_WindowTitle_ControllerBinding");break;case i.TrackerEdit:document.title=Object(c.c)("#BindingUI_WindowTitle_ManageTrackers")}},0)}}Object(o.b)([r.m],h.prototype,"m_State",void 0),Object(o.b)([r.m],h.prototype,"m_bLoading",void 0),Object(o.b)([r.m],h.prototype,"m_rBindingList",void 0),Object(o.b)([r.m],h.prototype,"m_bShowBindingListError",void 0),Object(o.b)([r.m],h.prototype,"m_sBindingListError",void 0),Object(o.b)([r.m],h.prototype,"m_bShowManifestError",void 0),Object(o.b)([r.m],h.prototype,"m_sManifestError",void 0),Object(o.b)([r.m],h.prototype,"m_sManifestErrorPath",void 0),Object(o.b)([r.m],h.prototype,"m_bDesktopMode",void 0),Object(o.b)([s.bind],h.prototype,"OnShowTrackerUI",null),Object(o.b)([s.bind],h.prototype,"OnShowAppSelect",null),Object(o.b)([s.bind],h.prototype,"OnShowAppBinding",null),Object(o.b)([s.bind],h.prototype,"OnTrackerBack",null),Object(o.b)([r.f],h.prototype,"ShouldShowTrackerBackButton",null),Object(o.b)([r.f],h.prototype,"DesktopMode",null),Object(o.b)([s.bind],h.prototype,"SetBindingListError",null),Object(o.b)([r.f],h.prototype,"ShowBindingListError",null),Object(o.b)([r.f],h.prototype,"BindingListError",null),Object(o.b)([s.bind],h.prototype,"OnPopState",null),Object(o.b)([s.bind],h.prototype,"GoBackPage",null),Object(o.b)([s.bind],h.prototype,"GoForwardPage",null),Object(o.b)([r.f],h.prototype,"GetUIState",null),Object(o.b)([r.f],h.prototype,"BindingQueryResults",null),Object(o.b)([r.f],h.prototype,"Loading",null),Object(o.b)([s.bind],h.prototype,"IsSafeToResetControllerType",null),Object(o.b)([s.bind],h.prototype,"EditCurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ViewCurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ShowBindingList",null),Object(o.b)([r.f],h.prototype,"CurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ReturnToSettingsUI",null),Object(o.b)([s.bind],h.prototype,"ShowAppSelect",null),Object(o.b)([s.bind],h.prototype,"UpdatePathsTimeout",null),Object(o.b)([s.bind],h.prototype,"ShowDebugger",null),Object(o.b)([s.bind],h.prototype,"ShowTrackerEdit",null),Object(o.b)([s.bind],h.prototype,"RefreshBindingList",null),Object(o.b)([r.f],h.prototype,"IsRunningInDashboard",null),Object(o.b)([r.d],h.prototype,"ShowActionManifestLoadFailed",null),Object(o.b)([r.d],h.prototype,"ManifestLoadErrorClose",null),Object(o.b)([r.f],h.prototype,"ShowManifestError",null),Object(o.b)([r.f],h.prototype,"ManifestError",null),Object(o.b)([r.f],h.prototype,"ManifestErrorPath",null),Object(o.b)([r.d],h.prototype,"ShowActionOrigins",null),Object(o.b)([s.bind],h.prototype,"UpdateWindowTitle",null);const S=new h;window.inputUI=S},tUsp:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("mrSG"),o=n("7wIv"),s=n("vDqi"),r=n.n(s),l=n("2vnA");class a{constructor(){this.contents=l.m.map()}}Object(i.b)([l.m],a.prototype,"contents",void 0);class c{constructor(){this.m_Containers=l.m.map()}Init(){return Object(i.a)(this,void 0,void 0,(function*(){this.AddSubscribedContainer("25769803776"),yield this.UpdatePaths()}))}AddSubscribedContainer(t){if(!this.m_Containers.has(t)){let e=new a;e.handle=t,this.m_Containers.set(t,e)}}UpdateContainer(t,e){this.AddSubscribedContainer(t);let n=this.m_Containers.get(t);n.contents.clear(),e.entries.forEach(t=>{null!=t.path&&n.contents.set(t.path,t)})}QueryContainer(t){return Object(i.a)(this,void 0,void 0,(function*(){return new Promise((function(e,n){r.a.get("/properties.json?container="+t).then(n=>{e([t,n.data])}).catch(e=>{n([t,e])})}))}))}UpdatePaths(){return Object(i.a)(this,void 0,void 0,(function*(){let t=[];this.m_Containers.forEach(e=>{t.push(this.QueryContainer(e.handle))});try{(yield Promise.all(t)).forEach(t=>{2!=t.length?console.log("Failed to update container. ",t.length,"entries in array"):"string"==typeof t[1]?console.log("Failed to update container ",t[0],":",t[1]):this.UpdateContainer(t[0],t[1])})}catch(t){throw console.log(t),t}}))}GetAllActions(t){if(!this.m_Containers.has(t))return;let e=[];return this.m_Containers.get(t).contents.forEach(t=>{"k_unActionPropertyTag"==t.type&&null!=t.path&&e.push(t.path)}),e}GetActionValue(t,e){if(!this.m_Containers.has(t))return;let n=this.m_Containers.get(t);if(!n.contents.has(e))return;let i=n.contents.get(e);return"k_unActionPropertyTag"==i.type?i.value:void 0}GetAllInputValues(t){if(!this.m_Containers.has(t))return;let e=[];return this.m_Containers.get(t).contents.forEach(t=>{"k_unInputValuePropertyTag"==t.type&&null!=t.path&&e.push(t.path)}),e}GetInputValue(t,e){if(!this.m_Containers.has(t))return;let n=this.m_Containers.get(t);if(!n.contents.has(e))return;let i=n.contents.get(e);if("k_unInputValuePropertyTag"!=i.type)return;let o=i.value;return o.length<1?void 0:o[0]}GetScalarInputValue(t,e){let n=this.GetInputValue(t,e);return null==n||"scalar"!=n.type?0:n.value}GetBooleanInputValue(t,e){let n=this.GetInputValue(t,e);return null!=n&&"boolean"==n.type&&n.value}}Object(i.b)([l.m],c.prototype,"m_Containers",void 0),Object(i.b)([o.bind],c.prototype,"AddSubscribedContainer",null),Object(i.b)([l.d],c.prototype,"UpdateContainer",null),Object(i.b)([o.bind],c.prototype,"GetAllActions",null),Object(i.b)([o.bind],c.prototype,"GetActionValue",null),Object(i.b)([o.bind],c.prototype,"GetAllInputValues",null),Object(i.b)([o.bind],c.prototype,"GetInputValue",null),Object(i.b)([o.bind],c.prototype,"GetScalarInputValue",null),Object(i.b)([o.bind],c.prototype,"GetBooleanInputValue",null);const d=new c;window.paths=d},uFkT:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n("mrSG"),o=n("2vnA"),s=n("vDqi"),r=n.n(s),l=n("7wIv"),a=n("GXif"),c=n("EUJ1");class d{constructor(){this.m_InputState=void 0,this.m_KnownControllerTypes=o.m.map(),this.m_mailbox=new c.CVRMailbox,this.m_bUpdateInputStateOnControllerTypChange=!1}Init(t){return this.m_mailbox.Init("input_state"),this.m_mailbox.RegisterHandler("controller_type_changed",this.OnControllerTypeChanged),null!=t&&(this.m_bUpdateInputStateOnControllerTypChange=t),this.GetInputState()}OnControllerTypeChanged(t){this.UpdateControllerTypes(t.controller_types),this.m_InputState.controller_types=t.controller_types,this.m_bUpdateInputStateOnControllerTypChange&&this.GetInputState()}get ConnectedDevices(){return null==this.m_InputState?Array():this.m_InputState.devices.filter(t=>"TrackedDeviceClass_Controller"==t.class||"TrackedDeviceClass_HMD"==t.class||"TrackedDeviceClass_GenericTracker"==t.class)}get ControllerTypes(){return this.m_InputState.controller_types}get ShouldSendSystemButtonToAllApps(){return this.m_InputState.send_system_button_to_all_apps}get ShowHiddenInputs(){return this.m_InputState.show_hidden_inputs}get IsSteamAvailable(){return!this.m_InputState||this.m_InputState.is_steam_available}get BDevMode(){return this.m_InputState.dev_mode}get IsValid(){return null!=this.m_InputState}get CurrentUserPersonaName(){return this.m_InputState.current_user_persona_name?this.m_InputState.current_user_persona_name:null}GetControllerTypeInfo(t){return this.m_InputState.controller_types.find(e=>e.controller_type==t)}GetDeviceInfo(t){for(let e of this.m_InputState.devices)if(e.root_path==t||e.device_path==t)return e;return null}LocalizeControllerString(t,e){let n=Object(a.c)("#"+e);return n!="#"+e?n:t&&this.m_InputState&&this.m_InputState.localization.hasOwnProperty(t.resource_root)&&this.m_InputState.localization[t.resource_root].hasOwnProperty(e.toLowerCase())?this.m_InputState.localization[t.resource_root][e.toLowerCase()]:e}LocalizeDriverString(t,e){let n=Object(a.c)("#"+e);return n!="#"+e?n:this.m_InputState&&this.m_InputState.localization.hasOwnProperty(t)&&this.m_InputState.localization[t].hasOwnProperty(e.toLowerCase())?this.m_InputState.localization[t][e.toLowerCase()]:e}UpdateControllerTypes(t){this.m_KnownControllerTypes.clear();for(let e of t)this.m_KnownControllerTypes.set(e.controller_type,e)}GetInputState(){return Object(i.a)(this,void 0,void 0,(function*(){yield new Promise((function(t,e){r.a.get("/input/getstate.json").then(e=>{t(e.data)}).catch(t=>{e(t)})})).then(t=>{for(let e of t.controller_types)e.controller_type=e.controller_type.toLowerCase();for(let e of t.devices)e.controller_type=e.controller_type.toLowerCase();this.UpdateControllerTypes(t.controller_types),this.m_InputState=t})}))}get KnownControllerTypes(){return this.m_KnownControllerTypes}FindDeviceClassForControllerType(t){let e=this.GetControllerTypeInfo(t);return null==e?void 0:e.device_class}FindRootPathForControllerType(t){for(let e of this.m_InputState.devices)if(e.controller_type==t)return e.root_path;return null}}Object(i.b)([o.m],d.prototype,"m_InputState",void 0),Object(i.b)([o.m],d.prototype,"m_KnownControllerTypes",void 0),Object(i.b)([l.bind],d.prototype,"OnControllerTypeChanged",null),Object(i.b)([o.f],d.prototype,"ConnectedDevices",null),Object(i.b)([o.f],d.prototype,"ControllerTypes",null),Object(i.b)([o.f],d.prototype,"ShouldSendSystemButtonToAllApps",null),Object(i.b)([o.f],d.prototype,"ShowHiddenInputs",null),Object(i.b)([o.f],d.prototype,"IsSteamAvailable",null),Object(i.b)([o.f],d.prototype,"BDevMode",null),Object(i.b)([o.f],d.prototype,"IsValid",null),Object(i.b)([o.f],d.prototype,"CurrentUserPersonaName",null),Object(i.b)([l.bind],d.prototype,"GetControllerTypeInfo",null),Object(i.b)([l.bind],d.prototype,"LocalizeControllerString",null),Object(i.b)([l.bind],d.prototype,"LocalizeDriverString",null),Object(i.b)([o.d],d.prototype,"UpdateControllerTypes",null),Object(i.b)([o.d],d.prototype,"GetInputState",null),Object(i.b)([o.f],d.prototype,"KnownControllerTypes",null),Object(i.b)([l.bind],d.prototype,"FindDeviceClassForControllerType",null);const p=new d;window.inputState=p}}]);
//# sourceMappingURL=vrwebui_shared.js.map?v=c85f8ba72441b7c59817