/*!
 * (c) Valve Corporation. Use is governed by the terms of the Steam Subscriber Agreement http://store.steampowered.com/subscriber_agreement/. 
 * 
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"6YgL":function(t,e,i){"use strict";i.d(e,"a",(function(){return c})),i.d(e,"b",(function(){return a}));var n=i("mrSG"),o=i("q1tI"),s=i("7wIv"),r=i("CzjV"),l=i("EUJ1");class c extends o.Component{onClick(t){VRHTML.Environment()==l.VRHTMLEnvironment.Overlay&&(a.temporarilySuppressSoundEffect(),r.b.Instance.playSound(r.a.PanoramaButtonClick)),this.props.onClick&&this.props.onClick(t)}render(){return o.cloneElement(o.createElement("div",this.props,this.props.children),{onClick:this.onClick})}}Object(n.b)([s.bind],c.prototype,"onClick",null);class a extends o.Component{static temporarilySuppressSoundEffect(){window.clearTimeout(this.s_nPlaySoundEffectTimeout),this.s_nPlaySoundEffectTimeout=0,window.clearTimeout(this.s_nSuppressingSoundEffectsTimeout),this.s_nSuppressingSoundEffectsTimeout=window.setTimeout(this.endSoundEffectSuppression,this.k_nSoundEffectSuppressionPeriod)}static get suppressingSoundEffect(){return this.s_nSuppressingSoundEffectsTimeout>0}onClick(t){a.suppressingSoundEffect||(window.clearTimeout(a.s_nPlaySoundEffectTimeout),a.s_nPlaySoundEffectTimeout=window.setTimeout(a.playSoundEffect,a.k_nSoundEffectDelay)),this.props.onClick&&this.props.onClick(t)}static endSoundEffectSuppression(){window.clearTimeout(this.s_nSuppressingSoundEffectsTimeout),this.s_nSuppressingSoundEffectsTimeout=0}static playSoundEffect(){VRHTML.Environment()===l.VRHTMLEnvironment.Overlay&&r.b.Instance.playSound(r.a.PanoramaSurfaceClick)}render(){return o.cloneElement(o.createElement("div",this.props,this.props.children),{onClick:this.onClick})}}a.k_nSoundEffectSuppressionPeriod=4,a.k_nSoundEffectDelay=2,a.s_nSuppressingSoundEffectsTimeout=0,a.s_nPlaySoundEffectTimeout=0,Object(n.b)([s.bind],a.prototype,"onClick",null),Object(n.b)([s.bind],a,"endSoundEffectSuppression",null),Object(n.b)([s.bind],a,"playSoundEffect",null)},"7uy8":function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));const n="openvr.tool.steamvr_environments"},CzjV:function(t,e,i){"use strict";var n;i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return o})),function(t){t[t.PanoramaButtonClick=0]="PanoramaButtonClick",t[t.PanoramaSurfaceClick=1]="PanoramaSurfaceClick",t[t.VolumePreview=2]="VolumePreview"}(n||(n={}));class o{constructor(){this.m_mapSoundElems=new Map}static get Instance(){return o.s_Instance||(o.s_Instance=new o),o.s_Instance}getSoundEffectPath(t){switch(t){case n.PanoramaButtonClick:return"/dashboard/sounds/activation.wav";case n.PanoramaSurfaceClick:return"/dashboard/sounds/activation_change_fail.wav";case n.VolumePreview:return"/dashboard/sounds/volume_change.wav"}}playSound(t){if(!this.m_mapSoundElems.has(t)){let e=document.createElement("audio");e.src=this.getSoundEffectPath(t),this.m_mapSoundElems.set(t,e)}const e=this.m_mapSoundElems.get(t);e.pause(),e.currentTime=0,e.play()}}o.s_Instance=null},DwIg:function(t,e,i){"use strict";i.d(e,"b",(function(){return c})),i.d(e,"a",(function(){return a}));var n=i("mrSG"),o=i("q1tI"),s=i("PShe"),r=i.n(s),l=(i("Wmp0"),i("7wIv"));class c{constructor(t,e,i){this.sValue=t,this.sLocalized=e,this.sRequiredLocalized=i}}class a extends o.Component{constructor(t){super(t),this.state={sSelectedOption:this.props.sValueSelectedItem,bVisible:!1}}componentWillMount(){null!=this.props.bShowOptionsOnStart&&this.setState({bVisible:this.props.bShowOptionsOnStart})}componentWillReceiveProps(t){null!=t.bShowOptionsOnStart&&t.bShowOptionsOnStart!=this.props.bShowOptionsOnStart&&this.setState({bVisible:t.bShowOptionsOnStart})}Show(t){this.setState({bVisible:!0}),t.stopPropagation()}Hide(t){this.setState({bVisible:!1}),t&&t.stopPropagation()}OnOptionChanged(t,e){this.setState({sSelectedOption:e}),this.props.fnOptionSelected(e),this.Hide(t)}render(){let t=this.props.vecOptions.map((t,e)=>{if("-"==t.sValue)return o.createElement("div",{key:e,className:"InlineSeparator"});if("-blank"==t.sValue)return o.createElement("div",{key:e,className:"InlineBlankSeparator"},t.sLocalized);if("-nonitem"==t.sValue)return o.createElement("div",{key:e,className:"InlineNonItemSeparator"},t.sLocalized);if("-subHeader"==t.sValue)return o.createElement("div",{key:e,className:"InlineSubHeaderSeparator"},t.sLocalized);{let i,n="InlineDropdownItem";return this.props.sValueSelectedItem==t.sValue&&(n+=" Selected"),null!=t.sRequiredLocalized&&(i=o.createElement("span",{className:"BindingLabelActionRequirement"},t.sRequiredLocalized)),o.createElement("div",{key:e,className:n,onClick:e=>{this.OnOptionChanged(e,t.sValue)}},t.sLocalized,i)}}),e="InlineDropdownLabel "+(null==this.props.sHeaderClass?"":this.props.sHeaderClass),i="InlineOptionsDropDownRodal "+(null==this.props.sModalClass?"":this.props.sModalClass);let n=this.props.sLocalizedSelectedItem;!n&&this.state.sSelectedOption&&this.props.vecOptions.forEach(t=>{t.sValue==this.state.sSelectedOption&&(n=t.sLocalized)});let s=this.props.bReadOnly?()=>{}:this.Show;return o.createElement("div",{className:e,onClick:s},n&&o.createElement("div",{className:this.props.sMainButtonClass},n),o.createElement(r.a,{visible:this.state.bVisible,onClose:this.Hide,customStyles:{width:"60%",height:"fit-content",maxHeight:"90%",display:"flex"},showCloseButton:!1,animation:"fade",className:i,closeOnEsc:!0},this.state.bVisible&&o.createElement("div",{className:"FlexColumn InlineDropdownModalWrapper"},this.props.sModalTitleString&&o.createElement("div",{className:"Label ModalHeader"},this.props.sModalTitleString),o.createElement("div",{className:"FlexColumn InlineDropdownItemWrapper"},t))))}}Object(n.b)([l.bind],a.prototype,"Show",null),Object(n.b)([l.bind],a.prototype,"Hide",null),Object(n.b)([l.bind],a.prototype,"OnOptionChanged",null)},GXif:function(t,e,i){"use strict";i.d(e,"a",(function(){return s})),i.d(e,"c",(function(){return r})),i.d(e,"b",(function(){return c}));i("q1tI");var n=i("vDqi"),o=i.n(n);class s{constructor(){this.m_mapTokens=new Map,this.m_mapFallbackTokens=new Map}InitFromObjects(t,e,i,n){this.m_mapTokens.clear();let o=[e,t,n,i];for(let t in o){let e=o[t];for(let t in e){let i=e[t];for(let t in i){let e=t.toLowerCase();this.m_mapTokens.has(e)||this.m_mapTokens.set(e,i[t])}}}}LocalizeString(t){if(!t||0==t.length||"#"!=t.charAt(0))return"";let e=this.m_mapTokens.get(t.substring(1).toLowerCase());return void 0===e?"":e}LocalizeStringFromFallback(t){if(!t||0==t.length||"#"!=t.charAt(0))return"";let e=this.m_mapFallbackTokens.get(t.substring(1).toLowerCase());return void 0===e?"":e}static GetLocale(){const t=navigator.languages[0];try{const e=VRHTML.IsAvailable()?VRHTML.GetSystemLocale():null;if(null==e)return t;s.s_Date.toLocaleTimeString(e);return e}catch(e){return t}}}function r(t,...e){let i=l.LocalizeString(t);return i?(e.length>0&&(i=i.replace(/%(\d+)\$s/g,(function(t,i){return void 0!==e[i-1]?String(e[i-1]):t}))),i):t}s.s_Date=new Date;const l=new s;function c(t,e){null==e&&(e=function(){let t=new Map([["en","english"],["de","german"],["fr","french"],["it","italian"],["ko","korean"],["es-419","latam"],["es","spanish"],["zh-CN","schinese"],["zh-TW","tchinese"],["ru","russian"],["th","thai"],["ja","japanese"],["pt","portuguese"],["pl","polish"],["da","danish"],["nl","dutch"],["fi","finnish"],["no","norwegian"],["sv","swedish"],["hu","hungarian"],["cs","czech"],["ro","romanian"],["tr","turkish"],["pt-BR","brazilian"],["bg","bulgarian"],["el","greek"],["uk","ukranian"],["vi","vietnamese"]]);for(let e of navigator.languages){let i=e.split("-");if(t.has(e))return t.get(e);if(t.has(i[0]))return t.get(i[0])}return"english"}());let i=[],n=(t,e,i)=>{let n,s=Date.now().toString();return n="webhelper"==t?`/dashboard/localization/${t}_${e}.json?t=${s}`:`localization/${t}_${e}.json?t=${s}`,o.a.get(n).then(t=>{i(t.data)}).catch(()=>{})},s=[],r=[],c=[],a=[];for(let o of t)i.push(n(o,e,t=>{s.push(t)})),"english"!=e&&i.push(n(o,"english",t=>{c.push(t)}));for(let t of["webhelper"])i.push(n(t,e,t=>{r.push(t)})),"english"!=e&&i.push(n(t,"english",t=>{a.push(t)}));return Promise.all(i).then(()=>{l.InitFromObjects(s,r,c,a)})}window.LocalizationManager=l},Kysl:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i("mrSG"),o=i("7wIv"),s=i("vDqi"),r=i.n(s),l=i("2vnA");class c{constructor(){this.m_Applications=l.m.map()}Init(){return Object(n.a)(this,void 0,void 0,(function*(){yield this.UpdateApplications()}))}SetApplicationMap(t){this.m_Applications.clear(),t.apps.forEach(t=>{this.m_Applications.set(t.key,t)})}UpdateApplications(){return Object(n.a)(this,void 0,void 0,(function*(){yield this.QueryApplications().then(t=>{this.SetApplicationMap(t)})}))}QueryApplications(){return new Promise((function(t,e){r.a.get("/app/list.json").then(e=>{t(e.data)}).catch(t=>{e(t)})}))}GetAppImageURL(t){let e="/app/image?app_key="+t;return VRHTML.IsAvailable()&&(e+="&version="+VRHTML.SteamVRVersion()),e}GetApp(t){return this.m_Applications.has(t)?this.m_Applications.get(t):void 0}GetRecentApps(){let t=[];return this.m_Applications.forEach(e=>{e.is_internal||t.push(e)}),t.sort((t,e)=>t.last_launch<e.last_launch?1:t.last_launch>e.last_launch?-1:t.name<e.name?1:t.name>e.name?-1:0),t}GetCurrentSceneProcess(){let t=void 0;return this.m_Applications.forEach(e=>{e.current_scene_process&&!e.is_internal&&(t=e)}),t}IsAppAllowedPrivateInputs(t){return"openvr.component.vrcompositor"==t}ShouldShowBindingFailureForApp(t){if(null==t||""==t)return!1;if("openvr.component.vrcompositor"==t)return!0;if(null==this.GetApp(t))return!1;let e=this.GetCurrentSceneProcess();return null!=e&&e.key==t}}Object(n.b)([l.m],c.prototype,"m_Applications",void 0),Object(n.b)([l.d],c.prototype,"SetApplicationMap",null),Object(n.b)([o.bind],c.prototype,"QueryApplications",null),Object(n.b)([o.bind],c.prototype,"GetAppImageURL",null),Object(n.b)([o.bind],c.prototype,"GetApp",null),Object(n.b)([o.bind],c.prototype,"GetRecentApps",null),Object(n.b)([o.bind],c.prototype,"GetCurrentSceneProcess",null),Object(n.b)([o.bind],c.prototype,"IsAppAllowedPrivateInputs",null),Object(n.b)([o.bind],c.prototype,"ShouldShowBindingFailureForApp",null);const a=new c;window.applications=a},MYgy:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return o})),i.d(e,"g",(function(){return v})),i.d(e,"f",(function(){return w})),i.d(e,"d",(function(){return k})),i.d(e,"e",(function(){return B})),i.d(e,"a",(function(){return P}));var n,o,s,r=i("mrSG"),l=i("7wIv"),c=i("vDqi"),a=i.n(c),d=i("2vnA"),p=i("GXif"),u=i("EUJ1"),h=i.n(u),S=i("pYJh"),m=i("Kysl"),g=i("uFkT");class b{}Object(r.b)([d.m],b.prototype,"path",void 0),Object(r.b)([d.m],b.prototype,"mode",void 0),Object(r.b)([d.m],b.prototype,"parameters",void 0),Object(r.b)([d.m],b.prototype,"inputs",void 0);class _{}Object(r.b)([d.m],_.prototype,"path",void 0),Object(r.b)([d.m],_.prototype,"output",void 0);class f{}Object(r.b)([d.m],f.prototype,"path",void 0),Object(r.b)([d.m],f.prototype,"output",void 0);class y{}Object(r.b)([d.m],y.prototype,"path",void 0),Object(r.b)([d.m],y.prototype,"output",void 0);class A{}Object(r.b)([d.m],A.prototype,"output",void 0),Object(r.b)([d.m],A.prototype,"inputs",void 0);class O{}Object(r.b)([d.m],O.prototype,"chords",void 0),Object(r.b)([d.m],O.prototype,"poses",void 0),Object(r.b)([d.m],O.prototype,"haptics",void 0),Object(r.b)([d.m],O.prototype,"sources",void 0),Object(r.b)([d.m],O.prototype,"skeleton",void 0),function(t){t[t.eButtonSide_None=0]="eButtonSide_None",t[t.eButtonSide_Left=1]="eButtonSide_Left",t[t.eButtonSide_Right=2]="eButtonSide_Right"}(n||(n={})),function(t){t.eTrackPadInvert_None="",t.eTrackPadInvert_X="x",t.eTrackPadInvert_Y="y",t.eTrackPadInvert_XY="xy"}(o||(o={}));class v{constructor(){this.vecRequired=[],this.vecSuggested=[]}}class C{}Object(r.b)([d.m],C.prototype,"device_path_string",void 0),Object(r.b)([d.m],C.prototype,"device_path_handle",void 0),Object(r.b)([d.m],C.prototype,"role",void 0),Object(r.b)([d.m],C.prototype,"controller_role",void 0);class I{}function w(t){return new Promise((function(e,i){a.a.get("/input/getactions.json?app_key="+t).then(i=>{console.log("Loaded action manifest for ",t),e(i.data)}).catch(t=>{i(t)})}))}function k(t,e,i,n){return new Promise((function(o,s){a.a.get("/input/loadbindingfromurl.json?binding_url="+encodeURI(i)+"&controller_type="+encodeURI(e)+"&app_key="+encodeURI(t)+(n?"&mailbox="+encodeURI(n):"")).then(t=>{o()}).catch(t=>{s(t)})}))}Object(r.b)([d.m],I.prototype,"trackers",void 0),Object(r.b)([d.m],I.prototype,"valid_roles",void 0);class B{constructor(t,e){this.x=t,this.y=e,this.toString.bind(this)}toString(){return this.x+","+this.y}}class j{constructor(t,e,i,n,o){this.m_BindingUISource=void 0,this.m_ControllerProfile=void 0,this.m_sDeviceInputPath=void 0,this.m_eButtonSide=void 0,this.m_sInputPath=void 0,this.m_sActionSet=void 0,this.m_BindingStoreObserverDisposer=void 0,this.m_iNewSourceEntry=-1,this.m_sDeviceInputPath=t,this.m_ControllerProfile=e,this.m_eButtonSide=i,this.m_sInputPath=n,this.m_sActionSet=o,this.m_BindingStoreObserverDisposer=Object(d.n)(P,t=>{"m_LoadedBinding"==t.name&&this.UpdateBindingSource()}),this.UpdateBindingSource(),P.RegisterBindingWatcher(this.UpdateBindingSource.bind(this))}cancelWatcher(){this.m_BindingStoreObserverDisposer(),P.UnregisterBindingWatcher(this.UpdateBindingSource)}UpdateBindingSource(){this.m_BindingUISource=P.GetActionBinding(this.GetFullInputPath,this.m_sActionSet)}get GetFullInputPath(){let t=this.m_sDeviceInputPath+this.m_sInputPath;return t=t.replace(/([^:]\/)\/+/g,"$1")}GetSVGEndPoint(){return new B(this.m_ControllerProfile.input_source[this.m_sInputPath].binding_image_point[0],this.m_ControllerProfile.input_source[this.m_sInputPath].binding_image_point[1])}get GetButtonSide(){return this.m_eButtonSide}get GetNumModes(){return this.m_BindingUISource?this.m_BindingUISource.length:0}GetActionForInputType(t,e){if(this.m_BindingUISource&&this.m_BindingUISource[t].inputs&&this.m_BindingUISource[t].inputs.has(e)){let i=this.m_BindingUISource[t].inputs.get(e).output,n=P.GetActionByName(i);if(!n){let t=P.GetSimulatedActionByPath(i);t&&(n=P.CreateActionDefinitionForSimulatedAction(t))}let o=P.GetAliasInfo(i);return n&&o&&o.alias_name&&((n=Object.assign({},n)).localized_name=o.alias_name),n}}GetClickAction(t){return this.GetActionForInputType(t,"click")}GetTouchAction(t){return this.GetActionForInputType(t,"touch")}GetPositionAction(t){return this.GetActionForInputType(t,"position")}GetHeldAction(t){return this.GetActionForInputType(t,"held")}GetLongAction(t){return this.GetActionForInputType(t,"long")}GetSingleAction(t){return this.GetActionForInputType(t,"single")}GetDoubleAction(t){return this.GetActionForInputType(t,"double")}GetNorthAction(t){return this.GetActionForInputType(t,"north")}GetEastAction(t){return this.GetActionForInputType(t,"east")}GetSouthAction(t){return this.GetActionForInputType(t,"south")}GetWestAction(t){return this.GetActionForInputType(t,"west")}GetCenterAction(t){return this.GetActionForInputType(t,"center")}GetScrollAction(t){return this.GetActionForInputType(t,"scroll")}GetPullAction(t){return this.GetActionForInputType(t,"pull")}GetForceAction(t){return this.GetActionForInputType(t,"force")}GetGrabAction(t){return this.GetActionForInputType(t,"grab")}GetValueAction(t){return this.GetActionForInputType(t,"value")}get GetControllerInputName(){return g.a.LocalizeDriverString(this.m_ControllerProfile.resource_root,this.m_sInputPath)}get GetModes(){return this.m_BindingUISource?this.m_BindingUISource:[]}GetMode(t){return this.m_BindingUISource&&t>=0&&t<this.m_BindingUISource.length?this.m_BindingUISource[t].mode:"none"}get GetInputSourceType(){return this.m_ControllerProfile.input_source[this.m_sInputPath].type}get GetInputSource(){return this.m_ControllerProfile.input_source[this.m_sInputPath]}get GetInputSourceClickSupport(){return!(this.m_ControllerProfile.input_source[this.m_sInputPath].force&&!this.m_ControllerProfile.input_source[this.m_sInputPath].click)&&(("knuckles"!=this.m_ControllerProfile.controller_type||"/input/trackpad"!=this.m_sInputPath)&&(!(!this.m_ControllerProfile.input_source[this.m_sInputPath].click&&!this.m_ControllerProfile.input_source[this.m_sInputPath].touch)&&(this.m_ControllerProfile.input_source[this.m_sInputPath].click||this.m_ControllerProfile.input_source[this.m_sInputPath].touch)))}get GetInputSourceTouchSupport(){return!(!this.m_ControllerProfile.input_source[this.m_sInputPath].touch&&!this.m_ControllerProfile.input_source[this.m_sInputPath].proximity)&&(this.m_ControllerProfile.input_source[this.m_sInputPath].touch||this.m_ControllerProfile.input_source[this.m_sInputPath].proximity)}get GetInputSourceForceSupport(){return!!this.m_ControllerProfile.input_source[this.m_sInputPath].force&&this.m_ControllerProfile.input_source[this.m_sInputPath].force}get GetInputSourceDefaultDeadzone(){return this.m_ControllerProfile.input_source[this.m_sInputPath].default_dead_zone_pct?this.m_ControllerProfile.input_source[this.m_sInputPath].default_dead_zone_pct:0}SetInputMode(t,e){!this.m_BindingUISource||e<0||e>=this.m_BindingUISource.length?console.error("SetInputMode: Invalid mode index for new mode"):(this.ClearNewModeIfSet(e),P.SetInputModeForInputSource(this.GetFullInputPath,e,t))}AddInputMode(t){this.m_iNewSourceEntry=P.AddInputModeForSource(this.GetFullInputPath,t)}DeleteInputMode(t){!this.m_BindingUISource||t<0||t>=this.m_BindingUISource.length?console.error("SetInputMode: Invalid mode index for new mode"):P.DeleteInputModeForSource(this.GetFullInputPath,t)}ClearNewModeIfSet(t){-1!=this.m_iNewSourceEntry&&this.m_iNewSourceEntry==t&&(this.m_iNewSourceEntry=-1)}BHasModeSelectionPending(t){return-1!=this.m_iNewSourceEntry&&this.m_iNewSourceEntry==t}SetClickAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"click",e,["button","trackpad","joystick","trigger","toggle_button","complex_button"])}SetTouchAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"touch",e,["button","trackpad","joystick","trigger","toggle_button","complex_button"])}SetHeldAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"held",e,["button","complex_button"])}SetLongAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"long",e,["button","complex_button"])}SetSingleAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"single",e,["button","complex_button"])}SetDoubleAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"double",e,["button","complex_button"])}SetPositionAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"position",e,["trackpad","joystick"])}SetNorthAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"north",e,["dpad","dpad_click","dpad_touch"])}SetEastAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"east",e,["dpad","dpad_click","dpad_touch"])}SetSouthAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"south",e,["dpad","dpad_click","dpad_touch"])}SetWestAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"west",e,["dpad","dpad_click","dpad_touch"])}SetCenterAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"center",e,["dpad","dpad_click","dpad_touch"])}SetScrollAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"scroll",e,["scroll"])}SetPullAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"pull",e,["trigger"])}SetForceAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"force",e,["force_sensor"])}SetGrabAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"grab",e,["grab"])}SetValueAction(t,e){P.SetActionForInputModeType(this.GetFullInputPath,t,"value",e,["scalar_constant"])}CopyActions(t){P.ClearModesForInputPath(this.GetFullInputPath),t.GetModes.map((t,e)=>{P.AddInputModeForSource(this.GetFullInputPath,t.mode),t.inputs.forEach((t,i)=>{P.SetActionForInputModeType(this.GetFullInputPath,e,i,t.output,[])})})}BindingsMatch(t){let e=t.GetModes;if(this.GetModes.length!=e.length)return!1;for(let t=0;t<e.length;t++){let i=e[t],n=this.GetModes.filter(t=>t.mode==i.mode);if(n.length>0){let t=!0;return n[0].inputs.forEach((e,n)=>{i.inputs.has(n)&&i.inputs.get(n).output==e.output||(t=!1)}),t}return!1}return!0}SetClickParameter(t,e,i){P.SetParameterForInputModeType(this.GetFullInputPath,t,"click",e,i)}SetTouchParameter(t,e,i){P.SetParameterForInputModeType(this.GetFullInputPath,t,"touch",e,i)}SetParameter(t,e,i,n){P.SetParameterForInputModeType(this.GetFullInputPath,t,e,i,n)}GetClickParameter(t,e){return P.GetParameterForInputModeType(this.GetFullInputPath,t,"click",e)}GetTouchParameter(t,e){return P.GetParameterForInputModeType(this.GetFullInputPath,t,"touch",e)}GetParameter(t,e,i){return P.GetParameterForInputModeType(this.GetFullInputPath,t,e,i)}GetTrackpadInvertState(t){switch(P.GetParameterForInputModeType(this.GetFullInputPath,t,"trackpad","invert")){case"x":return o.eTrackPadInvert_X;case"y":return o.eTrackPadInvert_Y;case"xy":return o.eTrackPadInvert_XY;default:return o.eTrackPadInvert_None}}SetTrackpadInvertState(t,e){let i="";switch(e){case o.eTrackPadInvert_X:i="x";break;case o.eTrackPadInvert_Y:i="y";break;case o.eTrackPadInvert_XY:i="xy"}P.SetParameterForInputModeType(this.GetFullInputPath,t,"trackpad","invert",i)}}Object(r.b)([d.m],j.prototype,"m_BindingUISource",void 0),Object(r.b)([d.m],j.prototype,"m_ControllerProfile",void 0),Object(r.b)([d.m],j.prototype,"m_sDeviceInputPath",void 0),Object(r.b)([d.m],j.prototype,"m_eButtonSide",void 0),Object(r.b)([d.m],j.prototype,"m_sInputPath",void 0),Object(r.b)([d.m],j.prototype,"m_sActionSet",void 0),Object(r.b)([l.bind],j.prototype,"cancelWatcher",null),Object(r.b)([d.d],j.prototype,"UpdateBindingSource",null),Object(r.b)([d.f],j.prototype,"GetFullInputPath",null),Object(r.b)([l.bind],j.prototype,"GetSVGEndPoint",null),Object(r.b)([d.f],j.prototype,"GetButtonSide",null),Object(r.b)([d.f],j.prototype,"GetNumModes",null),Object(r.b)([l.bind],j.prototype,"GetActionForInputType",null),Object(r.b)([l.bind],j.prototype,"GetClickAction",null),Object(r.b)([l.bind],j.prototype,"GetTouchAction",null),Object(r.b)([l.bind],j.prototype,"GetPositionAction",null),Object(r.b)([l.bind],j.prototype,"GetHeldAction",null),Object(r.b)([l.bind],j.prototype,"GetLongAction",null),Object(r.b)([l.bind],j.prototype,"GetSingleAction",null),Object(r.b)([l.bind],j.prototype,"GetDoubleAction",null),Object(r.b)([l.bind],j.prototype,"GetNorthAction",null),Object(r.b)([l.bind],j.prototype,"GetEastAction",null),Object(r.b)([l.bind],j.prototype,"GetSouthAction",null),Object(r.b)([l.bind],j.prototype,"GetWestAction",null),Object(r.b)([l.bind],j.prototype,"GetCenterAction",null),Object(r.b)([l.bind],j.prototype,"GetScrollAction",null),Object(r.b)([l.bind],j.prototype,"GetPullAction",null),Object(r.b)([l.bind],j.prototype,"GetForceAction",null),Object(r.b)([l.bind],j.prototype,"GetGrabAction",null),Object(r.b)([l.bind],j.prototype,"GetValueAction",null),Object(r.b)([d.f],j.prototype,"GetControllerInputName",null),Object(r.b)([d.f],j.prototype,"GetModes",null),Object(r.b)([l.bind],j.prototype,"GetMode",null),Object(r.b)([d.f],j.prototype,"GetInputSourceType",null),Object(r.b)([d.f],j.prototype,"GetInputSource",null),Object(r.b)([d.f],j.prototype,"GetInputSourceClickSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceTouchSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceForceSupport",null),Object(r.b)([d.f],j.prototype,"GetInputSourceDefaultDeadzone",null),Object(r.b)([d.d],j.prototype,"SetInputMode",null),Object(r.b)([d.d],j.prototype,"AddInputMode",null),Object(r.b)([d.d],j.prototype,"DeleteInputMode",null),Object(r.b)([l.bind],j.prototype,"ClearNewModeIfSet",null),Object(r.b)([l.bind],j.prototype,"BHasModeSelectionPending",null),Object(r.b)([d.d],j.prototype,"SetClickAction",null),Object(r.b)([d.d],j.prototype,"SetTouchAction",null),Object(r.b)([d.d],j.prototype,"SetHeldAction",null),Object(r.b)([d.d],j.prototype,"SetLongAction",null),Object(r.b)([d.d],j.prototype,"SetSingleAction",null),Object(r.b)([d.d],j.prototype,"SetDoubleAction",null),Object(r.b)([d.d],j.prototype,"SetPositionAction",null),Object(r.b)([d.d],j.prototype,"SetNorthAction",null),Object(r.b)([d.d],j.prototype,"SetEastAction",null),Object(r.b)([d.d],j.prototype,"SetSouthAction",null),Object(r.b)([d.d],j.prototype,"SetWestAction",null),Object(r.b)([d.d],j.prototype,"SetCenterAction",null),Object(r.b)([d.d],j.prototype,"SetScrollAction",null),Object(r.b)([d.d],j.prototype,"SetPullAction",null),Object(r.b)([d.d],j.prototype,"SetForceAction",null),Object(r.b)([d.d],j.prototype,"SetGrabAction",null),Object(r.b)([d.d],j.prototype,"SetValueAction",null),Object(r.b)([d.d],j.prototype,"CopyActions",null),Object(r.b)([l.bind],j.prototype,"BindingsMatch",null),Object(r.b)([d.d],j.prototype,"SetClickParameter",null),Object(r.b)([d.d],j.prototype,"SetTouchParameter",null),Object(r.b)([d.d],j.prototype,"SetParameter",null),Object(r.b)([d.d],j.prototype,"GetClickParameter",null),Object(r.b)([d.d],j.prototype,"GetTouchParameter",null),Object(r.b)([d.d],j.prototype,"GetParameter",null),Object(r.b)([l.bind],j.prototype,"GetTrackpadInvertState",null),Object(r.b)([d.d],j.prototype,"SetTrackpadInvertState",null);class T{constructor(t,e,i){this.m_sSaveType=t,this.m_OutstandingSaveBindingResolve=e,this.m_OutstandingSaveBindingReject=i}resolve(t){this.m_OutstandingSaveBindingResolve(t)}reject(t){this.m_OutstandingSaveBindingReject(t)}get SaveType(){return this.m_sSaveType}}Object(r.b)([l.bind],T.prototype,"resolve",null),Object(r.b)([l.bind],T.prototype,"reject",null),function(t){t[t.eWebSocketState_Unknown=0]="eWebSocketState_Unknown",t[t.eWebSocketState_Disconnected=1]="eWebSocketState_Disconnected",t[t.eWebSocketState_Connecting=2]="eWebSocketState_Connecting",t[t.eWebSocketState_Connected=3]="eWebSocketState_Connected"}(s||(s={}));class M{constructor(){this.m_wsWebSocketToServer=void 0,this.m_eWebSocketState=s.eWebSocketState_Unknown,this.m_timerWebSocket=void 0,this.m_dateStartTime=new Date,this.m_sLoadedBindingURI=void 0,this.m_LoadedBinding=void 0,this.m_ModifiedBindingSet=d.m.map(),this.m_ModifiedOptions=d.m.map(),this.m_ModifiedAliases=d.m.map(),this.m_sName=void 0,this.m_sDescription=void 0,this.m_SelectedApp=void 0,this.m_SelectedAppActions=void 0,this.m_sSelectedActionSet=void 0,this.m_sSelectedControllerType=void 0,this.m_TrackerBindingSetup=void 0,this.m_bControllerTypeSelectedByUser=!1,this.m_OutstandingSaveBindingCalls=[],this.m_vecBindingSetWatchers=Array(),this.m_mapUnoundActions=new Map,this.m_bIsMissingRequiredActions=!1,this.m_rKnownFailedBindingUris=[],this.m_ControllerWatchers=new Map,this.m_ModifiedSimulatedActions=d.m.map(),this.m_nNextSimulatedActionId=1}OpenWebSocketToHost(){return new Promise((t,e)=>{this.m_eWebSocketState!=s.eWebSocketState_Connecting&&this.m_eWebSocketState!=s.eWebSocketState_Connected&&(this.m_wsWebSocketToServer&&delete this.m_wsWebSocketToServer,this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",e=>{this.OnWebSocketOpen(e),t()}),this.m_wsWebSocketToServer.addEventListener("message",t=>{this.OnWebSocketMessage(t)}),this.m_wsWebSocketToServer.addEventListener("close",t=>{this.OnWebSocketClose(t)}),this.m_eWebSocketState=s.eWebSocketState_Connecting),this.m_timerWebSocket||(this.m_timerWebSocket=window.setTimeout(this.OpenWebSocketToHost,1e3))})}Init(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.OpenWebSocketToHost(),yield this.RefreshInputState()}))}CountDevicesWithControllerType(t){let e=0;return g.a.ConnectedDevices.forEach(i=>{i.controller_type==t&&e++}),e}ComputeControllerTypeScore(t){let e=this.CountDevicesWithControllerType(t.controller_type),i=(h.a.IsAvailable()?h.a.VRProperties.GetStringProperty("/user/head",u.ETrackedDeviceProperty.Prop_ExpectedControllerType_String):void 0)==t.controller_type?2:1;return 1e3*(999-t.priority)+10*e+i}RefreshInputState(){return Object(r.a)(this,void 0,void 0,(function*(){let t=g.a.KnownControllerTypes.size;return g.a.GetInputState().then(()=>{this.m_SelectedApp&&t!=g.a.KnownControllerTypes.size&&this.ReloadCurrentApp();let e,i=!1,n=0;g.a.ControllerTypes.forEach(t=>{let i=this.ComputeControllerTypeScore(t);i>n&&(e=t,n=i)});let o=g.a.FindDeviceClassForControllerType(this.m_sSelectedControllerType);if(null!=e&&this.m_sSelectedControllerType!=e.controller_type&&!this.m_bControllerTypeSelectedByUser){let t=g.a.FindDeviceClassForControllerType(e.controller_type);S.a.IsSafeToResetControllerType(o,t)&&(this.m_sSelectedControllerType=e.controller_type,i=!0,null!=o&&S.a.RefreshBindingList())}i&&this.LoadControllerConfiguration()})}))}get SteamVRUnavailable(){return this.m_eWebSocketState==s.eWebSocketState_Connecting||this.m_eWebSocketState==s.eWebSocketState_Unknown?Date.now()-this.m_dateStartTime.getTime()>1e4:this.m_eWebSocketState!=s.eWebSocketState_Connected}get ActionSets(){if(null==this.m_SelectedAppActions||null==this.m_SelectedAppActions.action_sets)return[];let t=[];return this.m_SelectedAppActions.action_sets.forEach(e=>{if("hidden"!=e.usage){let i=!0;e.required_options&&e.required_options.forEach(t=>{this.GetOptionValue(t)||(i=!1)});let n=!1;e.forbidden_options&&e.forbidden_options.forEach(t=>{this.GetOptionValue(t)&&(n=!0)}),i&&!n&&t.push(e)}}),t}get ManifestOptions(){return null==this.m_SelectedAppActions||null==this.m_SelectedAppActions.action_sets||null==this.m_SelectedAppActions.options?[]:this.m_SelectedAppActions.options}get SecondaryControllerOptions(){return[{name:"returnBindingsWithLeftHand",localized_name:Object(p.c)("#SecondaryController_ReturnWithLeftHand"),type:"bool",default:!1},{name:"returnBindingsWithRightHand",localized_name:Object(p.c)("#SecondaryController_ReturnWithRightHand"),type:"bool",default:!1},{name:"returnBindingsWithHead",localized_name:Object(p.c)("#SecondaryController_ReturnWithHead"),type:"bool",default:!1}]}GetOptionDefault(t){let e=!1;return this.ManifestOptions.forEach(i=>{i.name==t&&(e=i.default)}),e}GetOptionValue(t){return this.m_ModifiedOptions.has(t)?this.m_ModifiedOptions.get(t):void 0}SetOptionValue(t,e){this.m_ModifiedOptions.set(t,e),this.NotifyWatchersOfChange()}GetAliasInfo(t){return this.m_ModifiedAliases.has(t)?this.m_ModifiedAliases.get(t):null}SetAliasName(t,e){if(this.m_ModifiedAliases.has(t)){let i=this.m_ModifiedAliases.get(t);i.alias_name=e,this.m_ModifiedAliases.set(t,i),this.NotifyWatchersOfChange()}else{let i={alias_name:e,hidden:!1};this.m_ModifiedAliases.set(t,i),this.NotifyWatchersOfChange()}}SetAliasHidden(t,e){if(this.m_ModifiedAliases.has(t)){let i=this.m_ModifiedAliases.get(t);i.hidden=e,this.m_ModifiedAliases.set(t,i),this.NotifyWatchersOfChange()}else{let i={alias_name:"",hidden:e};this.m_ModifiedAliases.set(t,i),this.NotifyWatchersOfChange()}}ComputeSimulatedActionPathFromId(t){return"/simactions/"+t}GetSimulatedActionByPath(t){return this.m_ModifiedSimulatedActions.has(t)?this.m_ModifiedSimulatedActions.get(t):void 0}SetSimulatedActionByPath(t,e){this.m_ModifiedSimulatedActions.set(t,e),this.NotifyWatchersOfChange()}AddSimulatedAction(t){let e={name:"",type:t,id:this.m_nNextSimulatedActionId++,output:""},i=this.ComputeSimulatedActionPathFromId(e.id);this.m_ModifiedSimulatedActions.set(i,e),this.NotifyWatchersOfChange()}DeleteSimulatedActionByPath(t){this.m_ModifiedSimulatedActions.delete(t),this.NotifyWatchersOfChange()}get SimulatedActions(){return Array.from(this.m_ModifiedSimulatedActions.values())}get SelectedApp(){return this.m_SelectedApp?this.m_SelectedApp.key:void 0}get SelectedAppActions(){return this.m_SelectedAppActions}get CurrentAppCanAccessPrivateInputs(){return m.a.IsAppAllowedPrivateInputs(this.m_SelectedApp.key)||g.a.ShouldSendSystemButtonToAllApps}get SelectedControllerTypeInfo(){if(g.a.IsValid&&null!=this.m_sSelectedControllerType)return g.a.GetControllerTypeInfo(this.m_sSelectedControllerType)}DeviceForControllerType(t,e){let i=g.a.GetControllerTypeInfo(t);if(!i)return;let o=!1,s=g.a.ConnectedDevices.find(s=>{if(s.controller_type==t){if(o=!0,!e)return!0;if("controller_handed"!=i.input_bindingui_mode)return!0;let t=e==n.eButtonSide_Left?"/left":"/right";if(s.root_path&&s.root_path.indexOf(t)>=0)return!0}return!1});return s||(o?g.a.ConnectedDevices.find(e=>e.controller_type==t):void 0)}get CurrentBindingSaveType(){if(null!=this.m_LoadedBinding)return"developer"==this.m_LoadedBinding.save_type&&P.SelectedBindingIsLegacy?"developer_legacy":this.m_LoadedBinding.save_type}get CurrentBindingActionManifestVersion(){return this.m_LoadedBinding&&this.m_LoadedBinding.binding_config&&this.m_LoadedBinding.binding_config.action_manifest_version?this.m_LoadedBinding.binding_config.action_manifest_version:0}get SelectedActionSet(){return this.m_sSelectedActionSet}get SelectedActionSetDetails(){if(null!=this.m_SelectedAppActions&&null!=this.m_sSelectedActionSet)return this.m_SelectedAppActions.action_sets.find(t=>t.name==this.m_sSelectedActionSet)}get SelectedActionSetActions(){return this.GetActionSetActions(this.m_sSelectedActionSet)}GetSelectedAppDefaultBinding(t){if(null!=this.m_SelectedAppActions)return this.m_SelectedAppActions.default_bindings&&this.m_SelectedAppActions.default_bindings.hasOwnProperty(t)?this.m_SelectedAppActions.default_bindings[t]:void 0}GetActionSetActions(t){if(null==this.m_SelectedAppActions||null==t)return[];let e=this.m_SelectedAppActions.action_sets.find(e=>e.name==t);return e?e.actions:[]}GetActionByName(t){if(null==this.m_SelectedApp||!this.m_SelectedAppActions.action_sets)return;let e=t.toLowerCase(),i=void 0;return this.m_SelectedAppActions.action_sets.forEach(t=>{if(!t.actions)return;let n=t.actions.find(t=>t.name.toLowerCase()==e);n&&(i=n)}),i}get UnboundActions(){this.m_bIsMissingRequiredActions=!1;for(let t of this.ActionSets){let e=[],i=[];if(!t.actions)break;for(let n of t.actions)if("optional"!=n.requirement&&!this.IsActionBound(t,n.name)){let t=this.GetAliasInfo(n.name);if(t){if(t.hidden)continue;t.alias_name&&((n=Object.assign({},n)).localized_name=t.alias_name)}"mandatory"==n.requirement?e.push(n):i.push(n)}if(e.length>0&&(this.m_bIsMissingRequiredActions=!0),this.m_mapUnoundActions.has(t.name)){let n=this.m_mapUnoundActions.get(t.name);n.vecRequired=e,n.vecSuggested=i}else this.m_mapUnoundActions.set(t.name,{vecRequired:e,vecSuggested:i})}let t=this.SelectedControllerTypeInfo;return t&&"TrackedDeviceClass_HMD"==t.device_class&&(this.m_bIsMissingRequiredActions=!1),"gamepad"==this.m_sSelectedControllerType&&(this.m_bIsMissingRequiredActions=!1),this.m_mapUnoundActions}get HasUnboundActions(){return this.UnboundActions,this.m_bIsMissingRequiredActions}IsActionBound(t,e){e=e.toLowerCase();let i=this.GetActionSetSources(t.name);if(i)for(let t of i){let i=!1;if(t.inputs.forEach(t=>{t.output.toLowerCase()==e&&(i=!0)}),i)return!0}let n=this.GetActionSetChords(t.name);if(n)for(let t of n)if(t.output&&t.output.toLowerCase()==e)return!0;let o=this.GetActionSetPoses(t.name);if(o)for(let t of o)if(t.output&&t.output.toLowerCase()==e)return!0;let s=this.GetActionSetHaptics(t.name);if(s)for(let t of s)if(t.output&&t.output.toLowerCase()==e)return!0;let r=this.GetActionSetSkeleton(t.name);if(r)for(let t of r)if(t.output&&t.output.toLowerCase()==e)return!0;return!1}GetActionSetPoses(t){return this.m_ModifiedBindingSet.has(t)?this.m_ModifiedBindingSet.get(t).poses:[]}get SelectedActionSetPoses(){return this.GetActionSetPoses(this.m_sSelectedActionSet)}GetActionSetHaptics(t){return this.m_ModifiedBindingSet.has(t)?this.m_ModifiedBindingSet.get(t).haptics:[]}get SelectedActionSetHaptics(){return this.GetActionSetHaptics(this.m_sSelectedActionSet)}GetActionSetSkeleton(t){return this.m_ModifiedBindingSet.has(t)?this.m_ModifiedBindingSet.get(t).skeleton:[]}get SelectedActionSetSkeletons(){return this.GetActionSetSkeleton(this.m_sSelectedActionSet)}GetActionSetChords(t){return this.m_ModifiedBindingSet.has(t)?this.m_ModifiedBindingSet.get(t).chords:[]}get SelectedActionSetChords(){return this.GetActionSetChords(this.m_sSelectedActionSet)}get SelectedActionSetChordCount(){let t=this.SelectedActionSetChords;return t?t.length:0}GetActionSetSources(t){if(null==this.m_ModifiedBindingSet||null==t)return;let e=this.m_ModifiedBindingSet;return e.has(t)?e.get(t).sources:void 0}get SelectedActionSetSources(){return this.GetActionSetSources(this.m_sSelectedActionSet)}get BSelectedActionSetHasPoses(){return null!=this.m_LoadedBinding&&null!=this.m_sSelectedActionSet&&null!=this.SelectedActionSetActions&&this.SelectedActionSetActions.filter(t=>"pose"==t.type).length>0}get BSelectedActionSetHasBoundPoses(){if(!this.BSelectedActionSetHasPoses||!this.SelectedActionSetPoses||null==this.SelectedActionSetActions)return!1;for(let t of this.SelectedActionSetPoses)if(t.output&&"none"!=t.output)return!0;return!1}get BSelectedActionSetHasHaptics(){return null!=this.m_LoadedBinding&&null!=this.m_sSelectedActionSet&&null!=this.SelectedActionSetActions&&this.SelectedActionSetActions.filter(t=>"vibration"==t.type).length>0}get BSelectedActionSetHasBoundHaptics(){if(!this.BSelectedActionSetHasHaptics||!this.SelectedActionSetHaptics||null==this.SelectedActionSetActions)return!1;for(let t of this.SelectedActionSetHaptics)if(t.output&&"none"!=t.output)return!0;return!1}get BSelectedActionSetHasSkeletons(){if(null==this.m_LoadedBinding||null==this.m_sSelectedActionSet||null==this.SelectedActionSetActions)return!1;if(0==this.SelectedActionSetActions.filter(t=>"skeleton"==t.type).length)return!1;return null!=this.SelectedControllerTypeInfo&&!!this.GetFirstInputSourceOfType("skeleton")}get BSelectedActionSetHasBoundSkeletons(){if(!this.BSelectedActionSetHasSkeletons||!this.SelectedActionSetSkeletons||null==this.SelectedActionSetActions)return!1;for(let t of this.SelectedActionSetSkeletons)if(t.output&&"none"!=t.output)return!0;return!1}SetSelectedApp(t,e){if(null==this.m_SelectedApp||t!=this.m_SelectedApp.key){this.m_rKnownFailedBindingUris=[],this.m_ControllerWatchers.clear();let i=m.a.GetApp(t);i&&(this.m_SelectedApp=i,e||this.ReloadCurrentApp())}}ReloadCurrentApp(){return Object(r.a)(this,void 0,void 0,(function*(){return this.m_sSelectedActionSet=void 0,new Promise((t,e)=>{this.LoadActionManifest().then(()=>{let e=this.ActionSets;e.length>0&&(null==this.m_sSelectedActionSet||!this.m_SelectedAppActions.action_sets.hasOwnProperty(this.m_sSelectedActionSet))&&(this.m_sSelectedActionSet=e[0].name);let i=this.LoadControllerConfiguration();i?i.then(e=>{t()}):t()})})}))}SetSelectedController(t,e){if(t!=this.m_sSelectedControllerType){let i=g.a.GetControllerTypeInfo(t);i&&(this.m_ControllerWatchers.clear(),this.m_sSelectedControllerType=i.controller_type,this.m_bControllerTypeSelectedByUser=!0,e||this.LoadControllerConfiguration())}}SetSelectedActionSet(t){t!=this.m_sSelectedActionSet&&(this.m_sSelectedActionSet=t)}LocalizeStringForSelectedControllerType(t){let e=this.SelectedControllerTypeInfo;return e&&e.resource_root?g.a.LocalizeDriverString(e.resource_root,t):t}LocalizePathNameForSelectedControllerType(t){let e=void 0;return["/user/hand/secondary","/user/hand/primary","/user/hand/left","/user/hand/right","/user/head"].forEach(i=>{0!=t.indexOf(i)||(e=i)}),e?Object(p.c)("#"+e)+" "+this.LocalizeStringForSelectedControllerType(t.replace(e,"")):t}get SelectedControllerTypeLocalizedName(){let t=this.SelectedControllerTypeInfo;return t?t.resource_root?g.a.LocalizeDriverString(t.resource_root,t.controller_type):t.controller_type:""}RegisterBindingWatcher(t){null==this.m_vecBindingSetWatchers.find(e=>e==t)&&this.m_vecBindingSetWatchers.push(t)}UnregisterBindingWatcher(t){let e=this.m_vecBindingSetWatchers.indexOf(t);e>=0&&this.m_vecBindingSetWatchers.splice(e,1)}GetActionBinding(t,e){if(null==this.m_ModifiedBindingSet)return;let i=this.m_ModifiedBindingSet;if(i.has(e)){let n=i.get(e).sources;if(n){let e=n.filter(e=>e.path==t);if(e)return e}}}GetInputModesForSourceType(t,e){let i=[];switch(t){case"button":i=["button","-","toggle_button","scalar_constant"];break;case"trackpad":i=["trackpad","dpad","-","scroll","radial","button","toggle_button"];break;case"trigger":i=["trigger","button","-","toggle_button","scalar_constant"];break;case"joystick":i=["joystick","dpad","-","scroll","radial","button","toggle_button"];break;case"pinch":i=["grab"];break;default:i=[]}return e&&(i.push("force_sensor"),"trigger"==t&&i.push("grab")),i}GetBooleanInputOptionsForMode(t){switch(t){case"button":case"toggle_button":return["click","touch"];case"button":return["single","double","held","long","click","touch"];case"trackpad":return["click","touch"];case"dpad_click":case"dpad_touch":case"dpad":return["west","east","north","south","center"];case"trackpad_scroll":return[];case"trigger":return["click","touch"];case"grab":return["grab"];case"force_sensor":default:return[]}}GetActionBindingsOfType(t,e){if(null==this.m_SelectedApp||null==this.m_sSelectedActionSet||null==this.m_SelectedAppActions.action_sets)return[];let i=this.SelectedActionSetDetails;if(!i)return[];if(null==i.actions)return[];let n=[];return i.actions.forEach(i=>{let o=this.m_ModifiedAliases.get(i.name);if(i.type==t&&(!o||!o.hidden||e))if(o&&o.alias_name){let t=Object.assign({},i);t.localized_name=o.alias_name,n.push(t)}else n.push(i)}),e||this.m_ModifiedSimulatedActions.forEach(e=>{if(this.GetActionTypeFromSimulatedActionType(e.type)==t){this.ComputeSimulatedActionPathFromId(e.id),e.name?e.name:(Object(p.c)("UnnamedSimAction"),e.id);n.push(this.CreateActionDefinitionForSimulatedAction(e))}}),n}GetActionTypeFromSimulatedActionType(t){switch(t){case"fake_trigger":case"fake_trackpad_click":return"boolean";default:return"unknown"}}CreateActionDefinitionForSimulatedAction(t){return{name:this.ComputeSimulatedActionPathFromId(t.id),localized_name:t.name?t.name:Object(p.c)("UnnamedSimAction")+t.id,type:this.GetActionTypeFromSimulatedActionType(t.type)}}get GetBooleanActionBindings(){return this.GetActionBindingsOfType("boolean")}get GetVector1ActionBindings(){return this.GetActionBindingsOfType("vector1")}get GetLiteralVector1ActionBindings(){return this.GetActionBindingsOfType("vector1",!0)}get GetVector2ActionBindings(){return this.GetActionBindingsOfType("vector2")}get GetVector3ActionBindings(){return this.GetActionBindingsOfType("vector3")}get GetPoseActionBindings(){return this.GetActionBindingsOfType("pose")}get GetHapticsActionBindings(){return this.GetActionBindingsOfType("vibration")}get GetSkeletonActionBindings(){return this.GetActionBindingsOfType("skeleton")}get ConfigName(){return this.m_sName}get ConfigDescription(){return this.m_sDescription}GetPoseAction(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses;if(null==e)return;let i=e.filter(e=>e.output.toLowerCase()==t.toLowerCase());return i.length?i:void 0}GetPoseActionByPath(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses;if(null==e)return;let i=e.filter(e=>e.path.toLowerCase()==t.toLowerCase());return i.length?i:void 0}GetHapticsAction(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics;if(null==e)return;let i=e.filter(e=>e.output.toLowerCase()==t.toLowerCase());return i.length?i:void 0}GetHapticsActionByPath(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics;if(null==e)return;let i=e.filter(e=>e.path.toLowerCase()==t.toLowerCase());return i.length?i:void 0}GetSkeletonAction(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton;if(null==e)return;let i=e.filter(e=>e.output.toLowerCase()==t.toLowerCase());return i.length?i:void 0}GetSkeletonActionByPath(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return;let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton;if(null==e)return;let i=e.filter(e=>e.path.toLowerCase()==t.toLowerCase());return i.length?i:void 0}NotifyWatchersOfChange(){console.log("Binding file changed"),this.m_vecBindingSetWatchers.forEach(t=>{t()}),this.AutosaveBinding()}SetActionForInputModeType(t,e,i,n,o){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForInputModeType: Invalid action set specified");class s{constructor(t,e){this.mode=t,this.sourceIdx=e}}let r=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,i)=>{e.path==t&&r.push(new s(e,i))}),r.length<=e)return void console.warn("Invalid mode index (",e,") for path ",t);let l=r[e].sourceIdx;if(l>=0){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[l];if(t.inputs&&t.inputs.has(i)&&t.inputs.get(i).output==n)return void console.log("Trying to set new action to old action for type",i," action is ",n);if(o.length>0&&!o.find(e=>e==t.mode))return void console.log("Trying to set invalid input type of ",i," for current mode ",t.mode);t.inputs||(t.inputs=d.m.map()),"none"==n?t.inputs.has(i)&&t.inputs.delete(i):t.inputs.has(i)?t.inputs.get(i).output=n:t.inputs.set(i,{output:n}),this.NotifyWatchersOfChange()}}SetParameterForInputModeType(t,e,i,n,o){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetParameterForInputModeType: Invalid action set specified");let s=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,i)=>{e.path==t&&s.push(i)}),s.length<=e)return void console.warn("Invalid mode index (",e,") for path ",t);let r=s[e];if(r>=0){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[r];if(!t.inputs)return void console.log("SetParameterForInputModeType: Trying to set parameter for missing input type of ",i," for current mode ",t.mode);t.parameters||(t.parameters=d.m.map()),t.parameters.get(n)!=o&&(null==o?t.parameters.delete(n):t.parameters.set(n,o),this.NotifyWatchersOfChange())}}GetParameterForInputModeType(t,e,i,n){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return console.error("SetParameterForInputModeType: Invalid action set specified"),null;let o=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,i)=>{e.path==t&&o.push(i)}),o.length<=e)return console.warn("Invalid mode index (",e,") for path ",t),null;let s=o[e];if(s>=0){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[s];return t.inputs?t.parameters&&t.parameters.has(n)?t.parameters.get(n):null:(console.log("GetParameterForInputModeType: Trying to get parameter for missing input type of ",i," for current mode ",t.mode),null)}return null}AddActionSetIfRequired(){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet)){let t=new O;t.sources=[],this.m_ModifiedBindingSet.set(this.m_sSelectedActionSet,t)}}AddInputModeForSource(t,e){this.AddActionSetIfRequired();let i=new b;return i.mode=e,i.path=t,i.inputs=d.m.map(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.push(i),this.NotifyWatchersOfChange(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter(e=>e.path.toLowerCase()==t.toLowerCase()).length-1}DeleteInputModeForSource(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("AddInputModeForType: Invalid action set specified");let i=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,n)=>{e.path.toLowerCase()==t.toLowerCase()&&i.push(n)}),i.length<=e)return void console.warn("Invalid mode index (",e,") for path ",t);let n=i[e];-1!=n?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.splice(n,1),this.NotifyWatchersOfChange()):console.error("DeleteInputModeForSource: Mode not found for source")}SetInputModeForInputSource(t,e,i){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForInputModeType: Invalid action set specified");let n=[];if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter((e,i)=>{e.path.toLowerCase()==t.toLowerCase()&&n.push(i)}),n.length<=e)return void console.warn("Invalid mode index (",e,") for path ",t);let o=n[e];if(-1!=o){let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[o];if(e.path==t){if(e.mode==i)return void console.log("Trying to set new input mode to old mode!");let n=JSON.parse(JSON.stringify(e)),s=new b;switch(s.mode=i,s.path=t,s.inputs=d.m.map(),i){case"button":case"toggle_button":switch(n.mode){case"complex_button":n.inputs.single&&(s.inputs.set("single",n.inputs.single),s.inputs.set("click",n.inputs.single)),n.inputs.long&&s.inputs.set("long",n.inputs.long),n.inputs.press&&s.inputs.set("press",n.inputs.press),n.inputs.double&&s.inputs.set("double",n.inputs.double),n.inputs.touch&&s.inputs.set("touch",n.inputs.touch);break;case"button":case"toggle_button":case"trackpad":case"trigger":n.inputs.click&&s.inputs.set("click",n.inputs.click),n.inputs.touch&&s.inputs.set("touch",n.inputs.touch)}break;case"complex_button":switch(n.mode){case"toggle_button":case"button":n.inputs.click&&s.inputs.set("single",n.inputs.click);break;case"trackpad":case"trigger":n.inputs.click&&s.inputs.set("single",n.inputs.click)}break;case"trackpad":switch(n.mode){case"complex_button":n.inputs.single&&s.inputs.set("click",n.inputs.single);break;case"toggle_button":case"button":case"trigger":n.inputs.click&&s.inputs.set("click",n.inputs.click),n.inputs.touch&&s.inputs.set("touch",n.inputs.touch)}break;case"trigger":switch(n.mode){case"complex_button":n.inputs.single&&s.inputs.set("click",n.inputs.single);break;case"toggle_button":case"trackpad":case"button":n.inputs.click&&s.inputs.set("click",n.inputs.click),n.inputs.touch&&s.inputs.set("touch",n.inputs.touch)}}return this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources[o]=s,void this.NotifyWatchersOfChange()}}else console.error("SetActionForInputModeType: trying to change a mode for a source that we don't have already")}ClearModesForInputPath(t){this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet)?this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).sources.filter(e=>e.path.toLowerCase()!=t.toLowerCase()):console.error("ClearModesForInputPath: Invalid action set specified")}SetInputPathForPose(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForPose: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array);let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.findIndex(e=>e.path.toLowerCase()==t.path.toLowerCase()&&e.output.toLowerCase()==t.output.toLowerCase());-1==i&&(i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[i].output=t.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[i].path!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[i].path=e,this.NotifyWatchersOfChange()):console.log("Trying to set new pose action path to old action path!")}SetPoseForInputPath(t,e){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForPose: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array);let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.findIndex(e=>e.path.toLowerCase()==t.toLowerCase());-1==i&&(i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[i].path=t),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[i].output!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses[i].output=e,this.NotifyWatchersOfChange()):console.log("Trying to set new pose action path to old action path!")}GetFirstInputSourceOfType(t){let e=this.SelectedControllerTypeInfo;if(null!=e)for(let i of Object.keys(e.input_source)){if(e.input_source[i].type==t)return i}}AddDefaultPose(t,e){if(this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).poses=new Array),null==this.SelectedControllerTypeInfo)return;let i=this.GetFirstInputSourceOfType("pose");if(!i)return;let n=new class{};n.output=t,n.path=i,this.SetInputPathForPose(n,i)}SetInputPathForHaptics(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputPathForHaptics: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.findIndex(e=>e.path.toLowerCase()==t.path.toLowerCase()&&e.output.toLowerCase()==t.output.toLowerCase());-1==i&&(i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.push(new f)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[i].output=t.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[i].path!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[i].path=e,this.NotifyWatchersOfChange()):console.log("Trying to set new haptics action path to old action path!")}SetHapticsForInputPath(t,e){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetHapticsForInputPath: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.findIndex(e=>e.path.toLowerCase()==t.toLowerCase());-1==i&&(i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[i].path=t),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[i].output!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics[i].output=e,this.NotifyWatchersOfChange()):console.log("Trying to set new haptic action path to old action path!")}AddDefaultHaptics(t,e){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).haptics=new Array);let i=this.GetFirstInputSourceOfType("haptic");if(!i)return;let n=e+i;let o=new class{};o.output=t,o.path=n,this.SetInputPathForHaptics(o,n)}SetInputPathForSkeleton(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputPathForSkeleton: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.findIndex(e=>e.path.toLowerCase()==t.path.toLowerCase()&&e.output.toLowerCase()==t.output.toLowerCase());-1==i&&(i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.push(new y)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[i].output=t.output),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[i].path!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[i].path=e,this.NotifyWatchersOfChange()):console.log("Trying to set new skeleton action path to old action path!")}SetSkeletonForInputPath(t,e){if(this.AddActionSetIfRequired(),!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetSkeletonForInputPath: Invalid action set specified");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.findIndex(e=>e.path.toLowerCase()==t.toLowerCase());-1==i&&(i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton.push(new _)-1,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[i].path=t),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[i].output!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton[i].output=e,this.NotifyWatchersOfChange()):console.log("Trying to set new skeleton action path to old action path!")}AddDefaultSkeleton(t,e){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).skeleton=new Array);let i=this.GetFirstInputSourceOfType("skeleton");if(!i)return;let n=e+i;let o=new class{};o.output=t,o.path=n,this.SetInputPathForSkeleton(o,n)}SetActionForChord(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetActionForChord: Invalid action set specified");let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);-1!=i?this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].output!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].output=e,this.NotifyWatchersOfChange()):console.log("Trying to set new chord action to old action!"):console.error("SetActionForChord: Invalid chord  specified ",t)}DeleteChord(t){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("DeleteChordForSource: Invalid action set specified");let e=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);-1!=e?(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.splice(e,1),this.NotifyWatchersOfChange()):console.error("DeleteChordForSource: Invalid chord  specified ",t)}AddChord(){this.AddActionSetIfRequired(),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords=new Array);this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.push(new A);this.NotifyWatchersOfChange()}DeleteSourceFromChord(t,e){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("DeleteSourceFromChord: Invalid action set specified");let i=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);if(-1!=i){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs.findIndex(t=>t[0]==e);-1!=t&&(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[i].inputs.splice(t,1),this.NotifyWatchersOfChange())}else console.error("DeleteSourceFromChord: Invalid chord  specified ",t)}SetInputTypeForChord(t,e,i){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputsForChord: Invalid action set specified");let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);if(-1!=n){let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs.findIndex(t=>t[0]==e);if(-1==t)return void console.log("Invalid bounds for new input chord, trying to add type without source");if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs[t][1]==i)return void console.log("Trying to set new chord inputs to old inputs!");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs[t][1]=i,this.NotifyWatchersOfChange()}else console.error("SetInputsForChord: Invalid chord  specified ",t)}SetInputSourceForChord(t,e,i){if(!this.m_ModifiedBindingSet.has(this.m_sSelectedActionSet))return void console.error("SetInputsForChord: Invalid action set specified");let n=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords.findIndex(e=>e==t);if(-1!=n){let t=this.GetActionBinding(e,this.SelectedActionSet);if(!t)return void console.log("Failed to find action binding for path");let o="click";if(t.length&&(o=this.GetBooleanInputOptionsForMode(t[0].mode)[0]),null==i)this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs||(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs=new Array),this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs.push([e,o]);else{let t=this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs.findIndex(t=>t[0]==i);if(-1==t)return void console.log("Trying to set replace chord input path when we didn't have that path!");if(this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs[t][0]==e)return void console.log("Trying to set new chord inputs to old inputs!");this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs[t][0]=e,this.m_ModifiedBindingSet.get(this.m_sSelectedActionSet).chords[n].inputs[t][1]=o}this.NotifyWatchersOfChange()}else console.error("SetInputsForChord: Invalid chord  specified ",t)}LoadActionManifest(){return Object(r.a)(this,void 0,void 0,(function*(){return new Promise((t,e)=>{w(this.m_SelectedApp.key).then(e=>{null==e.error?(this.m_SelectedAppActions=e,null==this.m_sLoadedBindingURI&&e.current_binding_url.hasOwnProperty(this.m_sSelectedControllerType)&&(this.m_sLoadedBindingURI=e.current_binding_url[this.m_sSelectedControllerType])):(this.m_SelectedAppActions=void 0,this.m_sLoadedBindingURI=void 0),t()})})}))}get SelectedBindingURL(){return null!=this.m_sSelectedControllerType&&null!=this.m_SelectedAppActions&&null!=this.m_SelectedAppActions.current_binding_url&&this.m_SelectedAppActions.current_binding_url.hasOwnProperty(this.m_sSelectedControllerType)?this.m_SelectedAppActions.current_binding_url[this.m_sSelectedControllerType]:void 0}get LoadedBindingURL(){return this.m_sLoadedBindingURI}get SelectedBindingIsLegacy(){return!this.m_SelectedAppActions||this.m_SelectedAppActions.legacy}get IsSecondaryController(){if(!this.m_sSelectedControllerType)return!1;let t=g.a.FindRootPathForControllerType(this.m_sSelectedControllerType);return"/user/treadmill"==t||"/user/gamepad"==t}LoadControllerConfiguration(){if(this.m_SelectedAppActions&&this.m_sLoadedBindingURI&&null!=this.SelectedControllerTypeInfo){if(null!=this.m_OutstandingConfigLoad&&console.warn("About to start second binding load when one is already pending",this.m_OutstandingConfigLoad),this.m_sLoadedBindingURI.length>0){return new Promise((t,e)=>{this.m_OutstandingConfigLoad=t,k(this.m_SelectedApp.key,this.SelectedControllerTypeInfo.controller_type,this.m_sLoadedBindingURI).then(t=>{console.log("LoadControllerConfiguration: ajax request successful")}).catch(t=>{e(t)})})}return new Promise((t,e)=>{t()})}return null}get TrackerBindings(){return null==this.m_TrackerBindingSetup&&this.GetTrackerBindings().then(t=>{this.m_TrackerBindingSetup=t}),this.m_TrackerBindingSetup}GetTrackerBindings(){return Object(r.a)(this,void 0,void 0,(function*(){return new Promise((function(t,e){a.a.get("/input/gettrackerbindings.json").then(e=>{t(e.data)}).catch(t=>{e(t)})}))}))}SetTrackerBinding(t,e,i){let n={device_path:t,role:e,controller_role:i},o=JSON.stringify(n);console.log("Saving tracker binding "+t),a.a.post("/input/settrackerbinding.action",o).then(t=>{console.log("SetTrackerBinding response: ",t.data),this.GetTrackerBindings()}).catch(t=>{})}PulseHaptics(t){let e={path_handle:t},i=JSON.stringify(e);a.a.post("/input/pulsehaptics.action",i).then(t=>{console.log("PulseHaptics response: ",t.data)}).catch(t=>{})}get KnownControllerTypes(){let t=[];return g.a.KnownControllerTypes.forEach(e=>{t.push(e)}),t}PreserveCurrentBindingForUpgrade(){let t=S.a.CurrentBinding;return t&&"autosave"==t.type?this.SaveCurrentBinding(Object(p.c)("#PreservedAutosaveName"),"","personal"):Promise.resolve(null)}GetDefaultBindingNameForSaveType(t){let e=P.SelectedControllerTypeInfo,i=g.a.LocalizeControllerString(e,e?e.controller_type:"");switch(t){default:case"autosave":return Object(p.c)("#BindingUI_SaveDefaultName",this.m_SelectedApp.name,i);case"personal":return Object(p.c)("#BindingUI_SaveDefaultName_Personal",this.m_SelectedApp.name,i);case"public":return Object(p.c)("#BindingUI_SaveDefaultName_Public",g.a.CurrentUserPersonaName)}}AutosaveBinding(){this.m_sName||(this.m_sName=this.GetDefaultBindingNameForSaveType("autosave")),this.SaveCurrentBinding(this.m_sName,this.m_sDescription,"autosave").then(t=>{P.SetBindingURL(t.uri)})}SaveCurrentBinding(t,e,i){return Object(r.a)(this,void 0,void 0,(function*(){if(this.HasUnboundActions)return console.log("Aborting save: Missing at least one required action"),new Promise((t,e)=>{e()});this.m_sName=t,this.m_sDescription=e;let n={app_key:this.SelectedApp,controller_type:this.SelectedControllerTypeInfo.controller_type,save_type:i};n.binding={name:t,description:e,action_manifest_version:this.m_SelectedAppActions.version,category:this.SelectedBindingIsLegacy?"legacy":"steamvr_input",controller_type:this.SelectedControllerTypeInfo.controller_type,bindings:this.m_ModifiedBindingSet,options:this.m_ModifiedOptions,alias_info:this.m_ModifiedAliases,simulated_actions:Array.from(this.m_ModifiedSimulatedActions.values()),app_key:this.SelectedApp};let o=JSON.stringify(n);return console.log("Saving binding "+t+" for app "+this.SelectedApp),new Promise((t,e)=>{let n=new T(i,t,e);this.m_OutstandingSaveBindingCalls.push(n),a.a.post("/input/savebinding.action",o).then(t=>{t.data.error?(console.log("SaveCurrentBinding failed:",t.data.error),e(t.data.error)):console.log("SaveCurrentBinding Successful")}).catch(t=>{e(t)})})}))}PublishBindingToWorkshop(t){return Object(r.a)(this,void 0,void 0,(function*(){let e={app_key:this.SelectedApp,description:t};e.binding={bindings:this.m_ModifiedBindingSet,controller_type:this.SelectedControllerTypeInfo.controller_type};let i=JSON.stringify(e);yield new Promise((function(t,e){a.a.post("/input/submitworkshopbinding.action",i).then(e=>{console.log("PublishBindingToWorkshop response: ",e),t()}).catch(t=>{e(t)})}))}))}OnWebSocketOpen(t){console.log("Websocket connected"),this.m_eWebSocketState=s.eWebSocketState_Connected,this.WebSocketSend("input_open"),this.m_timerWebSocket&&clearTimeout(this.m_timerWebSocket),window.addEventListener("beforeunload",()=>{this.WebSocketSend("input_close")})}OnWebSocketClose(t){console.log("Websocket closed ",t),this.m_eWebSocketState=s.eWebSocketState_Disconnected,this.OpenWebSocketToHost()}WebSocketSend(t){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(t)}OnWorkshopUploadComplete(t){if(console.log("OnWorkshopUploadComplete: ",t),t.app_key!=this.SelectedApp)return void console.log("Ignoring binding load for an app we aren't viewing");if(this.m_OutstandingSaveBindingCalls.length<=0)return void console.log("Got workshop upload result without pending resolve");let e=this.m_OutstandingSaveBindingCalls.shift();t.success?(e.resolve(t),this.LoadActionManifest()):e.reject(t)}OnPendingFileSaved(t){console.log("OnPendingFileSaved: ",t),t.app_key==this.SelectedApp||console.log("Ignoring pending file saved for an app we aren't viewing")}get SaveNoticeText(){if(this.m_OutstandingSaveBindingCalls.length>0){let t=!1;return this.m_OutstandingSaveBindingCalls.forEach(e=>{"personal"!=e.SaveType&&"public"!=e.SaveType||(t=!0)}),t?"#SaveNotice_Uploading":"#SaveNotice_Saving"}}OnBindingConfigLoaded(t){if(console.log("OnBindingConfigLoaded: ",t," selected action set:",this.m_sSelectedActionSet),t.app_key!=this.SelectedApp)return void console.log("Ignoring binding load for an app we aren't viewing");if(t.uri!=this.m_sLoadedBindingURI)return void console.log("Ignoring binding load for an config url we aren't viewing");this.m_ControllerWatchers.clear(),this.m_LoadedBinding=t,this.m_ModifiedBindingSet=d.m.map();let e=Object(p.c)("#unknown_application"),i=m.a.GetApp(P.SelectedApp);if(i&&(e=i.name),this.m_sName="",this.m_sDescription="",t.binding_config&&("developer"==t.type?this.SelectedBindingIsLegacy?(this.m_sName=Object(p.c)("#BindingUI_List_Legacy_Binding_Title",e),this.m_sDescription=Object(p.c)("#BindingUI_List_Legacy_Binding_Description")):(this.m_sName=Object(p.c)("#BindingUI_List_Developer_Binding_Title",e),this.m_sDescription=Object(p.c)("#BindingUI_List_Developer_Binding_Description")):(t.binding_config.hasOwnProperty("name")&&(this.m_sName=t.binding_config.name),t.binding_config.hasOwnProperty("description")&&(this.m_sDescription=t.binding_config.description))),""==this.m_sName){let t=P.SelectedControllerTypeInfo,i=g.a.LocalizeControllerString(t,t?t.controller_type:"");this.m_sName=Object(p.c)("#BindingUI_SaveDefaultName",e,i)}t.binding_config&&t.binding_config.bindings&&(Object.keys(t.binding_config.bindings).forEach(e=>{let i=new O;i.chords=t.binding_config.bindings[e].chords,i.poses=t.binding_config.bindings[e].poses,i.haptics=t.binding_config.bindings[e].haptics,i.skeleton=t.binding_config.bindings[e].skeleton,i.sources=new Array,t.binding_config.bindings[e].sources.forEach(t=>{let e=new b;e.mode=t.mode,e.path=t.path,e.inputs=d.m.map(),t.hasOwnProperty("inputs")&&Object.keys(t.inputs).forEach(i=>{e.inputs.set(i,t.inputs[i])}),null!=t.parameters&&Object.keys(t.parameters).length>0&&(e.parameters=d.m.map(),t.hasOwnProperty("parameters")&&Object.keys(t.parameters).forEach(i=>{e.parameters.set(i,t.parameters[i])})),i.sources.push(e)}),this.m_ModifiedBindingSet.set(e,i)}),this.m_ModifiedOptions.clear(),t.binding_config.options&&(Object.keys(t.binding_config.options).forEach(e=>{this.m_ModifiedOptions.set(e,t.binding_config.options[e])}),this.ManifestOptions.forEach(t=>{this.m_ModifiedOptions.has(t.name)||this.m_ModifiedOptions.set(t.name,t.default)})),this.m_ModifiedAliases.clear(),t.binding_config.alias_info&&Object.keys(t.binding_config.alias_info).forEach(e=>{this.m_ModifiedAliases.set(e,t.binding_config.alias_info[e])}),this.m_ModifiedSimulatedActions.clear(),t.binding_config.simulated_actions&&t.binding_config.simulated_actions.forEach(t=>{let e=this.ComputeSimulatedActionPathFromId(t.id);this.m_ModifiedSimulatedActions.set(e,t),t.id>=this.m_nNextSimulatedActionId&&(this.m_nNextSimulatedActionId=t.id+1)})),this.m_vecBindingSetWatchers.forEach(t=>{t()}),null!=this.m_OutstandingConfigLoad&&(this.m_OutstandingConfigLoad(t),this.m_OutstandingConfigLoad=void 0)}QueryBindingList(t,e){return null!=this.m_OutstandingQueryResolve&&console.warn("About to start second binding list query when one is already pending",this.m_OutstandingQueryResolve),new Promise((i,n)=>{this.m_OutstandingQueryResolve=i,a.a.get(`/input/queryworkshopbindings.json?app_key=${t}&controller_type=${e}`).then(t=>{console.log("QueryBindingList: ajax request successful")}).catch(t=>{n(t)})})}DeleteBinding(t){null!=this.m_OutstandingDeleteResolve&&console.warn("About to start second binding delete when one is already pending",this.m_OutstandingDeleteResolve);let e={url:t},i=JSON.stringify(e);return new Promise((e,n)=>{this.m_OutstandingDeleteResolve=e,this.m_sOutstandingDeleteURL=t,a.a.post("/input/deleteconfig.action",i).then(t=>{console.log("Delete ajax request successful")}).catch(t=>{n(t)})})}OnBindingDeleteComplete(t){null!=this.m_OutstandingDeleteResolve?t.url==this.m_sOutstandingDeleteURL&&(this.m_sOutstandingDeleteURL=void 0,this.m_OutstandingDeleteResolve(t),this.m_OutstandingDeleteResolve=void 0,console.log("OnDeleteComplete: ",t)):console.warn("Missing outstanding query resolve for binding delete")}OnBindingLoadFailed(t){console.log("OnBindingLoadFailed: "+t.app_key+" "+t.controller_type+" "+t.error),m.a.UpdateApplications().then(()=>{if(!m.a.ShouldShowBindingFailureForApp(t.app_key))return;if(!this.ShouldShowBindingFailureForControllerType(t.controller_type))return;if(!S.a.ShouldShowBindingFailure())return;this.m_rKnownFailedBindingUris.push(t.uri),this.SetSelectedApp(t.app_key),this.SetSelectedController(t.controller_type);let e=m.a.GetApp(t.app_key),i=g.a.GetControllerTypeInfo(t.controller_type);if(!i)return;let n=g.a.LocalizeControllerString(i,t.controller_type);S.a.ShowBindingList(Object(p.c)(t.error,e?e.name:Object(p.c)("#unknown_application"),n)),h.a.IsAvailable()&&h.a.ShowBindingUI(!1)})}ShouldShowBindingFailureForControllerType(t){if(null==t||""==t)return!1;let e=g.a.GetControllerTypeInfo(t);return!!e&&!!e.should_show_binding_errors}HasBindingUriFailedToLoad(t){return-1!=this.m_rKnownFailedBindingUris.indexOf(t)}OnQueryResults(t){console.log("OnQueryResults: ",t),null!=this.m_OutstandingQueryResolve?(this.m_OutstandingQueryResolve(t),this.m_OutstandingQueryResolve=void 0):console.warn("Missing outstanding query resolve for binding query")}SelectConfig(t,e,i){if(this.m_sLoadedBindingURI=i,console.log("Selecting config "+i+" for app "+t),this.SelectedBindingURL==i)return console.debug("Selecting the config we already have set",i),new Promise((t,e)=>{t()});let n={app_key:t,controller_type:e,url:i},o=JSON.stringify(n);return null!=this.m_OutstandingSelectConfigResolve&&console.warn("About to start second select config when one is already pending",this.m_OutstandingSelectConfigResolve),new Promise((t,e)=>{this.m_OutstandingSelectConfigResolve=t,a.a.post("/input/selectconfig.action",o).then(t=>{console.log("selectconfig ajax request successful")}).catch(t=>{e(t)})})}OnSelectConfigComplete(t){null!=this.m_OutstandingSelectConfigResolve?(this.m_OutstandingSelectConfigResolve(),this.m_OutstandingSelectConfigResolve=void 0,console.log("OnSelectConfigComplete: ",t)):t.error_to_show?S.a.ShowBindingList(t.error_to_show):console.warn("Missing outstanding query resolve for select config")}OnTrackersBindingChanged(t){this.GetTrackerBindings().then(t=>{this.m_TrackerBindingSetup=t})}OnActionManifestReloaded(t){t.app_key==this.SelectedApp&&this.ReloadCurrentApp()}OnActionManifestLoadFailed(t){S.a.ShowActionManifestLoadFailed(t.app_key,t.error,t.error_param,t.path)}OnShowActionOrigins(t){S.a.ShowActionOrigins(t.app_key,t.action_set,t.origin_to_highlight)}SetBindingURL(t){this.m_sLoadedBindingURI=t}OnActionBindingsReloaded(t){this.RefreshInputState()}GetControllerWatcherForSourceFromControllerType(t,e,i,o){let s=""+t.controller_type+e+i+o;if(!this.m_ControllerWatchers.has(s)){let r="";if("controller_handed"==t.input_bindingui_mode)switch(e){case n.eButtonSide_Left:r="/user/hand/left";break;case n.eButtonSide_Right:r="/user/hand/right"}else{let e=g.a.ConnectedDevices.find(e=>e.controller_type==t.controller_type);e&&e.root_path?r=e.root_path:console.log("Unable to find device path for controller type ",t)}this.m_ControllerWatchers.set(s,new j(r,t,e,i,o))}return this.m_ControllerWatchers.get(s)}OnWebSocketMessage(t){let e=JSON.parse(t.data);if("jsonid"in e&&"vr_input_get_notifications"==e.jsonid)for(let t in e.notifications){let i=e.notifications[t];switch(i.type){case"pending_file_saved":this.OnPendingFileSaved(i);break;case"workshop_upload_complete":this.OnWorkshopUploadComplete(i);break;case"binding_loaded":this.OnBindingConfigLoaded(i);break;case"query_results":this.OnQueryResults(i);break;case"action_bindings_reloaded":this.OnActionBindingsReloaded(i);break;case"delete_binding_complete":this.OnBindingDeleteComplete(i);break;case"binding_load_failed":this.OnBindingLoadFailed(i);break;case"select_config_complete":this.OnSelectConfigComplete(i);break;case"trackers_binding_changed":this.OnTrackersBindingChanged(i);break;case"action_manifest_reloaded":this.OnActionManifestReloaded(i);break;case"action_manifest_load_failed":this.OnActionManifestLoadFailed(i);break;case"show_action_origins":this.OnShowActionOrigins(i)}}}get BindingConfig(){return null==this.m_ModifiedBindingSet?"":JSON.stringify(this.m_ModifiedBindingSet,null,"\t")}}Object(r.b)([d.m],M.prototype,"m_eWebSocketState",void 0),Object(r.b)([d.m],M.prototype,"m_sLoadedBindingURI",void 0),Object(r.b)([d.m],M.prototype,"m_LoadedBinding",void 0),Object(r.b)([d.m],M.prototype,"m_ModifiedBindingSet",void 0),Object(r.b)([d.m],M.prototype,"m_ModifiedOptions",void 0),Object(r.b)([d.m],M.prototype,"m_ModifiedAliases",void 0),Object(r.b)([d.m],M.prototype,"m_sName",void 0),Object(r.b)([d.m],M.prototype,"m_sDescription",void 0),Object(r.b)([d.m],M.prototype,"m_SelectedApp",void 0),Object(r.b)([d.m],M.prototype,"m_SelectedAppActions",void 0),Object(r.b)([d.m],M.prototype,"m_sSelectedActionSet",void 0),Object(r.b)([d.m],M.prototype,"m_sSelectedControllerType",void 0),Object(r.b)([d.m],M.prototype,"m_TrackerBindingSetup",void 0),Object(r.b)([d.m],M.prototype,"m_OutstandingSaveBindingCalls",void 0),Object(r.b)([d.m],M.prototype,"m_ModifiedSimulatedActions",void 0),Object(r.b)([l.bind],M.prototype,"OpenWebSocketToHost",null),Object(r.b)([d.f],M.prototype,"SteamVRUnavailable",null),Object(r.b)([d.f],M.prototype,"ActionSets",null),Object(r.b)([d.f],M.prototype,"ManifestOptions",null),Object(r.b)([d.f],M.prototype,"SecondaryControllerOptions",null),Object(r.b)([d.d],M.prototype,"SetOptionValue",null),Object(r.b)([d.d],M.prototype,"AddSimulatedAction",null),Object(r.b)([d.d],M.prototype,"DeleteSimulatedActionByPath",null),Object(r.b)([d.f],M.prototype,"SelectedApp",null),Object(r.b)([d.f],M.prototype,"SelectedAppActions",null),Object(r.b)([d.f],M.prototype,"CurrentAppCanAccessPrivateInputs",null),Object(r.b)([d.f],M.prototype,"SelectedControllerTypeInfo",null),Object(r.b)([d.f],M.prototype,"CurrentBindingSaveType",null),Object(r.b)([d.f],M.prototype,"CurrentBindingActionManifestVersion",null),Object(r.b)([d.f],M.prototype,"SelectedActionSet",null),Object(r.b)([d.f],M.prototype,"SelectedActionSetDetails",null),Object(r.b)([d.f],M.prototype,"SelectedActionSetActions",null),Object(r.b)([l.bind],M.prototype,"GetSelectedAppDefaultBinding",null),Object(r.b)([l.bind],M.prototype,"GetActionByName",null),Object(r.b)([d.f],M.prototype,"SelectedActionSetPoses",null),Object(r.b)([d.f],M.prototype,"SelectedActionSetHaptics",null),Object(r.b)([d.f],M.prototype,"SelectedActionSetSkeletons",null),Object(r.b)([d.f],M.prototype,"SelectedActionSetChords",null),Object(r.b)([d.f],M.prototype,"SelectedActionSetChordCount",null),Object(r.b)([d.f],M.prototype,"SelectedActionSetSources",null),Object(r.b)([d.f],M.prototype,"BSelectedActionSetHasPoses",null),Object(r.b)([d.f],M.prototype,"BSelectedActionSetHasBoundPoses",null),Object(r.b)([d.f],M.prototype,"BSelectedActionSetHasHaptics",null),Object(r.b)([d.f],M.prototype,"BSelectedActionSetHasBoundHaptics",null),Object(r.b)([d.f],M.prototype,"BSelectedActionSetHasSkeletons",null),Object(r.b)([d.f],M.prototype,"BSelectedActionSetHasBoundSkeletons",null),Object(r.b)([d.d],M.prototype,"SetSelectedApp",null),Object(r.b)([d.d],M.prototype,"SetSelectedController",null),Object(r.b)([d.d],M.prototype,"SetSelectedActionSet",null),Object(r.b)([l.bind],M.prototype,"LocalizeStringForSelectedControllerType",null),Object(r.b)([l.bind],M.prototype,"LocalizePathNameForSelectedControllerType",null),Object(r.b)([d.f],M.prototype,"SelectedControllerTypeLocalizedName",null),Object(r.b)([d.d],M.prototype,"RegisterBindingWatcher",null),Object(r.b)([d.d],M.prototype,"UnregisterBindingWatcher",null),Object(r.b)([d.d],M.prototype,"GetActionBinding",null),Object(r.b)([l.bind],M.prototype,"GetInputModesForSourceType",null),Object(r.b)([l.bind],M.prototype,"GetBooleanInputOptionsForMode",null),Object(r.b)([l.bind],M.prototype,"GetActionBindingsOfType",null),Object(r.b)([d.f],M.prototype,"GetBooleanActionBindings",null),Object(r.b)([d.f],M.prototype,"GetVector1ActionBindings",null),Object(r.b)([d.f],M.prototype,"GetLiteralVector1ActionBindings",null),Object(r.b)([d.f],M.prototype,"GetVector2ActionBindings",null),Object(r.b)([d.f],M.prototype,"GetVector3ActionBindings",null),Object(r.b)([d.f],M.prototype,"GetPoseActionBindings",null),Object(r.b)([d.f],M.prototype,"GetHapticsActionBindings",null),Object(r.b)([d.f],M.prototype,"GetSkeletonActionBindings",null),Object(r.b)([d.f],M.prototype,"ConfigName",null),Object(r.b)([d.f],M.prototype,"ConfigDescription",null),Object(r.b)([l.bind],M.prototype,"GetPoseAction",null),Object(r.b)([l.bind],M.prototype,"GetPoseActionByPath",null),Object(r.b)([l.bind],M.prototype,"GetHapticsAction",null),Object(r.b)([l.bind],M.prototype,"GetHapticsActionByPath",null),Object(r.b)([l.bind],M.prototype,"GetSkeletonAction",null),Object(r.b)([l.bind],M.prototype,"GetSkeletonActionByPath",null),Object(r.b)([l.bind],M.prototype,"NotifyWatchersOfChange",null),Object(r.b)([d.d],M.prototype,"SetActionForInputModeType",null),Object(r.b)([d.d],M.prototype,"SetParameterForInputModeType",null),Object(r.b)([l.bind],M.prototype,"AddActionSetIfRequired",null),Object(r.b)([d.d],M.prototype,"AddInputModeForSource",null),Object(r.b)([d.d],M.prototype,"DeleteInputModeForSource",null),Object(r.b)([d.d],M.prototype,"SetInputModeForInputSource",null),Object(r.b)([d.d],M.prototype,"ClearModesForInputPath",null),Object(r.b)([d.d],M.prototype,"SetInputPathForPose",null),Object(r.b)([d.d],M.prototype,"SetPoseForInputPath",null),Object(r.b)([d.d],M.prototype,"AddDefaultPose",null),Object(r.b)([d.d],M.prototype,"SetInputPathForHaptics",null),Object(r.b)([d.d],M.prototype,"SetHapticsForInputPath",null),Object(r.b)([d.d],M.prototype,"AddDefaultHaptics",null),Object(r.b)([d.d],M.prototype,"SetInputPathForSkeleton",null),Object(r.b)([d.d],M.prototype,"SetSkeletonForInputPath",null),Object(r.b)([d.d],M.prototype,"AddDefaultSkeleton",null),Object(r.b)([d.d],M.prototype,"SetActionForChord",null),Object(r.b)([d.d],M.prototype,"DeleteChord",null),Object(r.b)([d.d],M.prototype,"AddChord",null),Object(r.b)([d.d],M.prototype,"DeleteSourceFromChord",null),Object(r.b)([d.d],M.prototype,"SetInputTypeForChord",null),Object(r.b)([d.d],M.prototype,"SetInputSourceForChord",null),Object(r.b)([d.d],M.prototype,"LoadActionManifest",null),Object(r.b)([d.f],M.prototype,"SelectedBindingURL",null),Object(r.b)([d.f],M.prototype,"LoadedBindingURL",null),Object(r.b)([d.f],M.prototype,"SelectedBindingIsLegacy",null),Object(r.b)([d.f],M.prototype,"IsSecondaryController",null),Object(r.b)([l.bind],M.prototype,"LoadControllerConfiguration",null),Object(r.b)([d.f],M.prototype,"TrackerBindings",null),Object(r.b)([d.d],M.prototype,"GetTrackerBindings",null),Object(r.b)([l.bind],M.prototype,"SetTrackerBinding",null),Object(r.b)([l.bind],M.prototype,"PulseHaptics",null),Object(r.b)([d.f],M.prototype,"KnownControllerTypes",null),Object(r.b)([l.bind],M.prototype,"AutosaveBinding",null),Object(r.b)([l.bind],M.prototype,"OnWebSocketOpen",null),Object(r.b)([l.bind],M.prototype,"OnWebSocketClose",null),Object(r.b)([l.bind],M.prototype,"WebSocketSend",null),Object(r.b)([l.bind],M.prototype,"OnWorkshopUploadComplete",null),Object(r.b)([l.bind],M.prototype,"OnPendingFileSaved",null),Object(r.b)([d.f],M.prototype,"SaveNoticeText",null),Object(r.b)([l.bind],M.prototype,"OnBindingConfigLoaded",null),Object(r.b)([l.bind],M.prototype,"QueryBindingList",null),Object(r.b)([l.bind],M.prototype,"DeleteBinding",null),Object(r.b)([l.bind],M.prototype,"OnBindingDeleteComplete",null),Object(r.b)([l.bind],M.prototype,"OnBindingLoadFailed",null),Object(r.b)([l.bind],M.prototype,"ShouldShowBindingFailureForControllerType",null),Object(r.b)([l.bind],M.prototype,"HasBindingUriFailedToLoad",null),Object(r.b)([l.bind],M.prototype,"OnQueryResults",null),Object(r.b)([l.bind],M.prototype,"SelectConfig",null),Object(r.b)([l.bind],M.prototype,"OnSelectConfigComplete",null),Object(r.b)([l.bind],M.prototype,"OnTrackersBindingChanged",null),Object(r.b)([l.bind],M.prototype,"OnActionManifestReloaded",null),Object(r.b)([l.bind],M.prototype,"OnActionManifestLoadFailed",null),Object(r.b)([l.bind],M.prototype,"OnShowActionOrigins",null),Object(r.b)([l.bind],M.prototype,"SetBindingURL",null),Object(r.b)([l.bind],M.prototype,"OnActionBindingsReloaded",null),Object(r.b)([l.bind],M.prototype,"GetControllerWatcherForSourceFromControllerType",null),Object(r.b)([l.bind],M.prototype,"OnWebSocketMessage",null),Object(r.b)([d.f],M.prototype,"BindingConfig",null);const P=new M;window.controllerBindingStore=P},"Q+Z6":function(t,e,i){"use strict";i.d(e,"b",(function(){return c})),i.d(e,"a",(function(){return a})),i.d(e,"c",(function(){return d})),i.d(e,"d",(function(){return u}));var n=i("mrSG"),o=i("7wIv"),s=i("vDqi"),r=i.n(s),l=i("2vnA");const c=.2,a=5,d=.02;class p{constructor(){this.m_wsWebSocketToServer=void 0,this.showInternalSettings=!1,this.pendingChanges=new Map,this.GetAppList=function(){return new Promise((function(t,e){r.a.get("/app/list.json").then(e=>{t(e.data.apps)}).catch(t=>{e(t)})}))},this.GetSettingsUGC=function(){return new Promise((function(t,e){r.a.get("/settings_getugc").then(e=>{t(e.data)}).catch(t=>{e(t)})}))},this.GetSettingsInfo=function(){return new Promise((function(t,e){r.a.get("/settings_getinfo").then(e=>{t(e.data)}).catch(t=>{e(t)})}))}}OpenWebSocketToHost(){return new Promise((t,e)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",e=>{this.OnWebSocketOpen(e),t()}),this.m_wsWebSocketToServer.addEventListener("message",this.OnWebSocketMessage),this.m_wsWebSocketToServer.addEventListener("close",this.OnWebSocketClose)})}Init(){return Object(n.a)(this,void 0,void 0,(function*(){this.connected=!1,this.settings=new Map,Object(l.e)(()=>{let t=[];if(0!=this.pendingChanges.size){for(const[e,i]of this.pendingChanges.entries())t.push({name:e,value:i});this.pendingChanges.clear(),r.a.post("/settings_set.action",t).then(t=>{}).catch(e=>{console.log("Failed to save settings! This usually happens when type is set incorrectly on one of the keys in the schema. ",t)})}},{delay:300}),yield this.OpenWebSocketToHost()}))}OnWebSocketOpen(t){this.connected=!0,this.WebSocketSend("settings_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("settings_close")}),u.GetSettingsInfo().then(t=>{this.systemInfo=t}),u.GetAppList().then(t=>{this.apps=t})}OnWebSocketClose(t){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(t){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(t)}OnWebSocketMessage(t){let e=JSON.parse(t.data);switch(e.jsonid){case"vr_settings":this.OnVRSettings(e);break;case"vr_settings_schema":this.OnVRSettingsSchema(e);break;case"vr_audio_devices":this.OnVRAudioDevices(e);break;case"vr_app_list":this.OnVRAppList(e);break;default:e.jsonid?console.log("Received unhandled event: "+e.jsonid):console.log("Received unknown message: ",e)}}OnVRSettings(t){for(let e in t.values){let i=t.values[e];this.settings.get(e)!=i&&this.settings.set(e,i)}}OnVRSettingsSchema(t){null==this.settingsSchema&&(console.log("Got vr settings schema"),this.settingsSchema=t.schema,this.showInternalSettings=t.is_steamvr_main)}OnVRAudioDevices(t){console.log("Got audio devices"),this.audioDevices=t}OnVRAppList(t){this.apps=t.apps}SettingNameMatches(t,e){if(e.endsWith("*")){let i=e.length-1;return t.substr(0,i)==e.substr(0,i)}return t==e}GetSettingSchema(t){for(let e of this.settingsSchema)if(e.values)for(let i of e.values)if(this.SettingNameMatches(t,i.name))return i;return null}SetSettingsValue(t,e){let i=this.GetSettingSchema(t);null!=i?(null!=e&&("int"==i.type?e=parseInt(e):"float"==i.type?e=parseFloat(e):"string"==i.type?e=""+e:"bool"==i.type&&(e=!!e),this.settings.set(t,e)),this.pendingChanges.set(t,e)):console.log("Tried to set setting "+t+" but it's not in the schema! Aborting")}SetSettingsStringValueWithoutSchema(t,e){this.settings.set(t,e),this.pendingChanges.set(t,e)}GetSettingsValue(t){return Object(n.a)(this,void 0,void 0,(function*(){return new Promise((function(e,i){r.a.get("/settings_get",{params:{name:t}}).then(t=>{e(t.data)}).catch(t=>{i(null)})}))}))}SetAppSettings(t,e){let i=Object.assign({},e);i.app=t,r.a.post("/app/setsettings",i).then(t=>{}).catch(t=>{})}GetAppSettings(t){return Object(n.a)(this,void 0,void 0,(function*(){return new Promise((function(e,i){r.a.get("/app/getsettings",{params:{app:t}}).then(t=>{e(t.data)}).catch(t=>{i(null)})}))}))}get NumSupersamplingSteps(){return Math.floor((a-c+.5*d)/d)}SliderposToSupersample(t){return t>a?a:t<c?c:t}}Object(n.b)([l.m],p.prototype,"connected",void 0),Object(n.b)([l.m],p.prototype,"settingsSchema",void 0),Object(n.b)([l.m],p.prototype,"settings",void 0),Object(n.b)([l.m],p.prototype,"systemInfo",void 0),Object(n.b)([l.m],p.prototype,"audioDevices",void 0),Object(n.b)([l.m],p.prototype,"apps",void 0),Object(n.b)([l.m],p.prototype,"showInternalSettings",void 0),Object(n.b)([l.m],p.prototype,"pendingChanges",void 0),Object(n.b)([o.bind],p.prototype,"OpenWebSocketToHost",null),Object(n.b)([o.bind],p.prototype,"OnWebSocketOpen",null),Object(n.b)([o.bind],p.prototype,"OnWebSocketClose",null),Object(n.b)([o.bind],p.prototype,"WebSocketSend",null),Object(n.b)([o.bind],p.prototype,"OnWebSocketMessage",null),Object(n.b)([l.d],p.prototype,"OnVRSettings",null),Object(n.b)([l.d],p.prototype,"OnVRSettingsSchema",null),Object(n.b)([l.d],p.prototype,"SetSettingsValue",null),Object(n.b)([l.d],p.prototype,"SetSettingsStringValueWithoutSchema",null),Object(n.b)([l.f],p.prototype,"NumSupersamplingSteps",null);const u=new p;window.VRSettingsState=u},Z0gP:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var n=i("mrSG"),o=i("7wIv"),s=i("vDqi"),r=i.n(s),l=i("2vnA");class c{constructor(){this.m_wsWebSocketToServer=void 0,this.IdentifyController=function(t){return t?new Promise((function(e,i){r.a.get("/identify_controller.action?serial="+t).then(t=>{e()}).catch(t=>{i(t)})})):null},this.GetUSBDeviceList=function(){return new Promise((function(t,e){r.a.get("/usb_topology.action").then(e=>{t(e.data)}).catch(t=>{e(t)})}))},this.ToggleRoomOverview=function(t){return new Promise((function(e,i){r.a.get("/toggle_room_overview_feed.action?enabled="+(t?"1":"0")).then(t=>{e()}).catch(t=>{i(t)})}))}}OpenWebSocketToHost(){return new Promise((t,e)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",e=>{this.OnWebSocketOpen(e),t()}),this.m_wsWebSocketToServer.addEventListener("message",this.OnWebSocketMessage),this.m_wsWebSocketToServer.addEventListener("close",this.OnWebSocketClose)})}Init(){return Object(n.a)(this,void 0,void 0,(function*(){this.connected=!1,this.framerate=[],this.status={jsonid:"",startup_info:"",status_string:"",is_main:!1,is_perforce:!1,hostname:"",states:[]},this.devices=[],this.roomoverview={jsonid:"",collision:[],playarea:[],devices:[],bounds_visible:!1,compositor_available:!1},yield this.OpenWebSocketToHost()}))}OnWebSocketOpen(t){this.connected=!0,this.WebSocketSend("websocket_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("websocket_close")})}OnWebSocketClose(t){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(t){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(t)}OnWebSocketMessage(t){let e=JSON.parse(t.data);switch(e.jsonid){case"vr_device_status":this.OnDeviceStatusMessage(e);break;case"vr_system_status":this.OnSystemStatusMessage(e);break;case"vr_framerate":this.OnFramerateMessage(e);break;case"vr_notifications":this.OnNotificationsMessage(e);break;case"vr_room_overview":this.OnRoomOverviewMessage(e);break;default:e.jsonid?console.log("Received unhandled event: "+e.jsonid):console.log("Received unknown message: ",e)}}OnDeviceStatusMessage(t){this.devices=t.devices}OnSystemStatusMessage(t){this.status=t}OnFramerateMessage(t){for(this.framerate.unshift(t);this.framerate.length>60;)this.framerate.pop()}OnNotificationsMessage(t){let e=t.notifications.map((t,e)=>({title:t.sTitle,description:t.sDescription,timestamp:t.sTimeStamp}));this.notifications=e}OnRoomOverviewMessage(t){this.roomoverview=t}LaunchApplication(t){return new Promise((function(e,i){r.a.get("/steamvr_launch_application.action?param1="+t).then(t=>{e()}).catch(t=>{i(t)})}))}TEMP_RegisterPollingWebsocketMessage(t,e){setInterval(()=>{r.a.get(t).then(t=>{this.OnWebSocketMessage({data:JSON.stringify(t.data)})}).catch(t=>{})},e)}}Object(n.b)([l.m],c.prototype,"devices",void 0),Object(n.b)([l.m],c.prototype,"status",void 0),Object(n.b)([l.m],c.prototype,"framerate",void 0),Object(n.b)([l.m],c.prototype,"notifications",void 0),Object(n.b)([l.m],c.prototype,"roomoverview",void 0),Object(n.b)([l.m],c.prototype,"connected",void 0),Object(n.b)([o.bind],c.prototype,"OpenWebSocketToHost",null),Object(n.b)([o.bind],c.prototype,"OnWebSocketOpen",null),Object(n.b)([o.bind],c.prototype,"OnWebSocketClose",null),Object(n.b)([o.bind],c.prototype,"WebSocketSend",null),Object(n.b)([o.bind],c.prototype,"OnWebSocketMessage",null),Object(n.b)([o.bind],c.prototype,"TEMP_RegisterPollingWebsocketMessage",null);const a=new c;window.VRSystemState=a},dGfu:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var n=i("mrSG"),o=i("7wIv"),s=i("2vnA");class r{constructor(){this.m_wsWebSocketToServer=void 0,this.vecMessageBuffer=s.m.array()}OpenWebSocketToHost(){return new Promise((t,e)=>{console.log("Connecting..."),this.m_wsWebSocketToServer=new WebSocket("ws://"+window.location.host),this.m_wsWebSocketToServer.addEventListener("open",e=>{this.OnWebSocketOpen(e),t()}),this.m_wsWebSocketToServer.addEventListener("message",t=>{this.OnWebSocketMessage(t)}),this.m_wsWebSocketToServer.addEventListener("close",t=>{this.OnWebSocketClose(t)})})}Init(){return Object(n.a)(this,void 0,void 0,(function*(){this.connected||(this.vecMessages=[],Object(s.e)(()=>{this.vecMessages=this.vecMessages.concat(this.vecMessageBuffer.splice(0,this.vecMessageBuffer.length)).map((t,e)=>({item:t,index:e})).sort((t,e)=>t.item.nTimestamp-e.item.nTimestamp||t.index-e.index).map(({item:t})=>t)},{delay:300}),yield this.OpenWebSocketToHost())}))}OnWebSocketOpen(t){this.connected=!0,this.WebSocketSend("console_open"),window.addEventListener("beforeunload",()=>{this.WebSocketSend("console_close")})}OnWebSocketClose(t){console.log("Lost connection to host..."),this.connected=!1,this.OpenWebSocketToHost()}WebSocketSend(t){null!=this.m_wsWebSocketToServer&&1==this.m_wsWebSocketToServer.readyState&&this.m_wsWebSocketToServer.send(t)}OnWebSocketMessage(t){let e=JSON.parse(t.data);this.OnConsoleMessage(e)}OnConsoleMessage(t){let e=t.sMessage.indexOf("-");t.sTimestamp=t.sMessage.substr(0,e),t.sMessage=t.sMessage.substr(e+1),this.vecMessageBuffer.push(t)}}Object(n.b)([s.m],r.prototype,"connected",void 0),Object(n.b)([s.m],r.prototype,"vecMessages",void 0),Object(n.b)([o.bind],r.prototype,"OpenWebSocketToHost",null),Object(n.b)([o.bind],r.prototype,"OnWebSocketOpen",null),Object(n.b)([o.bind],r.prototype,"OnWebSocketClose",null),Object(n.b)([o.bind],r.prototype,"WebSocketSend",null),Object(n.b)([o.bind],r.prototype,"OnWebSocketMessage",null);const l=new r;window.VRConsoleState=l},dO2U:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i("mrSG"),o=i("7wIv"),s=i("vDqi"),r=i.n(s),l=i("2vnA");class c{constructor(t){this.m_communityData=void 0,this.m_bLoadingData=!1,this.m_sSteamID=void 0,this.m_dateLastUpdate=void 0,this.m_sSteamID=t,t.length>0&&this.EnsureCommunityDataLoaded()}get community_data_ready(){return void 0!==this.m_communityData}get avatar_url(){return this.m_communityData&&this.m_communityData.avatar_url}get persona_name(){return this.m_communityData&&this.m_communityData.persona_name}get player_level(){return this.m_communityData&&this.m_communityData.level}get player_level_class(){return this.m_communityData&&this.m_communityData.level_class}get player_badge(){return this.m_communityData&&this.m_communityData.favorite_badge}get player_in_game(){return this.m_communityData&&this.m_communityData.in_game}EnsureCommunityDataLoaded(){if(void 0===this.m_communityData&&!this.m_bLoadingData){this.m_bLoadingData=!0;let t="https://steamcommunity.com/";r.a.get(t+"miniprofile/s"+this.m_sSteamID+"/json").then(t=>{let e=t.data;e&&e.avatar_url&&(this.m_communityData=e,this.m_dateLastUpdate=new Date),this.m_bLoadingData=!1}).catch(t=>{console.log(t),this.m_bLoadingData=!1})}}}Object(n.b)([l.m],c.prototype,"m_communityData",void 0),Object(n.b)([o.bind],c.prototype,"EnsureCommunityDataLoaded",null);class a{constructor(){this.m_SteamCommunityUsers=l.m.map()}GetUserInformation(t){return this.m_SteamCommunityUsers.has(t)||this.RequestUserInformation(t),this.m_SteamCommunityUsers.get(t)}RequestUserInformation(t){this.m_SteamCommunityUsers.hasOwnProperty(t)||this.m_SteamCommunityUsers.set(t,new c(t))}}Object(n.b)([l.m],a.prototype,"m_SteamCommunityUsers",void 0),Object(n.b)([o.bind],a.prototype,"GetUserInformation",null),Object(n.b)([o.bind],a.prototype,"RequestUserInformation",null);const d=new a;window.steamcommunity=d},hcOo:function(t,e,i){"use strict";function n(t){let e=window.location.search.substring(1).split("&");for(let i=0;i<e.length;i++){let n=e[i].split("=");if(decodeURIComponent(n[0]).toUpperCase()==t.toUpperCase())return decodeURIComponent(n[1])}return""}i.d(e,"a",(function(){return n}))},pYJh:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"a",(function(){return S}));var n,o=i("mrSG"),s=i("7wIv"),r=i("2vnA"),l=i("EUJ1"),c=i.n(l),a=i("GXif"),d=i("MYgy"),p=i("Kysl"),u=i("tUsp");!function(t){t[t.None=0]="None",t[t.List=1]="List",t[t.ViewBinding=2]="ViewBinding",t[t.EditBinding=3]="EditBinding",t[t.AppSelect=4]="AppSelect",t[t.Debugger=5]="Debugger",t[t.LegacyDebugger=6]="LegacyDebugger",t[t.TrackerEdit=7]="TrackerEdit",t[t.ControllerTester=8]="ControllerTester",t[t.DisplaySettings=9]="DisplaySettings"}(n||(n={}));class h{constructor(){this.m_State=n.None,this.m_bLoading=!1,this.m_rBindingList=void 0,this.m_bShowBindingListError=!1,this.m_sBindingListError=void 0,this.m_timeoutLoading=void 0,this.m_pathUpdateTimer=void 0,this.m_bShowManifestError=!1,this.m_sManifestError=void 0,this.m_sManifestErrorPath=void 0,this.m_bStandaloneSettingsPage=!1,this.m_bDesktopMode=!1}Init(){window.addEventListener("popstate",this.OnPopState),history.pushState({direction:"back"},"back"),history.pushState({direction:"current"},"current"),history.pushState({direction:"forward"},"forward"),history.back(),this.m_mailbox=new l.CVRMailbox,this.m_mailbox.Init("bindingui"),this.m_mailbox.RegisterHandler("show_tracker_ui",this.OnShowTrackerUI),this.m_mailbox.RegisterHandler("show_display_settings_ui",this.OnShowDisplaySettingsUI),this.m_mailbox.RegisterHandler("show_app_select",this.OnShowAppSelect),this.m_mailbox.RegisterHandler("show_app_binding",this.OnShowAppBinding),Object(r.e)(this.UpdateWindowTitle)}ShowOverlayInDashboard(){this.IsRunningInDashboard&&c.a.VROverlay.ShowDashboard("system.vrwebhelper.controllerbinding")}OnShowTrackerUI(t){this.m_bStandaloneSettingsPage=!0,this.ShowTrackerEdit(),this.ShowOverlayInDashboard()}OnShowDisplaySettingsUI(t){this.m_bStandaloneSettingsPage=!0,this.ShowDisplaySettings(),this.ShowOverlayInDashboard()}OnShowAppSelect(t){this.m_bStandaloneSettingsPage=!1,this.ShowAppSelect()}OnShowAppBinding(t){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,p.a.UpdateApplications().then(()=>{if(t.show_on_desktop||this.ShowOverlayInDashboard(),!p.a.GetApp(t.app_key))return console.log("Warning: Could not find app key: "+t.app_key+" showing app select."),void this.ShowAppSelect();d.a.SetSelectedApp(t.app_key,!0),d.a.ReloadCurrentApp().then(()=>{if(t.controller_type)return d.a.SetSelectedController(t.controller_type,!0),void d.a.LoadControllerConfiguration().then(()=>{t.action_set&&d.a.SetSelectedActionSet(t.action_set),this.Loading=!1,this.EditCurrentBinding()});this.Loading=!1,this.ShowBindingList()})})}OnTrackerBack(){this.m_bStandaloneSettingsPage?(this.ReturnToSettingsUI(),this.ShowAppSelect()):this.ShowBindingList()}SetStandaloneSettingsPage(t){this.m_bStandaloneSettingsPage=t}get ShouldShowTrackerBackButton(){return!this.m_bStandaloneSettingsPage||!this.m_bDesktopMode}SetDesktopMode(t){this.m_bDesktopMode=t}get DesktopMode(){return this.m_bDesktopMode}SetBindingListError(t){this.m_bShowBindingListError=null!=t,this.m_sBindingListError=t}get ShowBindingListError(){return this.m_bShowBindingListError}get BindingListError(){return this.m_sBindingListError}OnPopState(t){let e="";t.state&&t.state.direction&&(e=t.state.direction),"back"==e?(this.m_bStandaloneSettingsPage&&(this.SetStandaloneSettingsPage(!1),this.ReturnToSettingsUI()),this.GoBackPage(),history.forward()):"forward"==e&&(history.back(),this.GoForwardPage())}GoBackPage(){switch(this.m_State){default:case n.None:case n.AppSelect:break;case n.Debugger:case n.LegacyDebugger:case n.ControllerTester:case n.List:this.ShowAppSelect();break;case n.TrackerEdit:case n.EditBinding:case n.ViewBinding:case n.DisplaySettings:this.ShowBindingList()}}GoForwardPage(){switch(this.m_State){default:case n.None:case n.AppSelect:this.ShowBindingList();break;case n.List:this.CurrentBinding.url==d.a.LoadedBindingURL?this.EditCurrentBinding():this.ViewCurrentBinding();break;case n.EditBinding:case n.ViewBinding:case n.TrackerEdit:case n.DisplaySettings:}}get GetUIState(){return this.m_State}get BindingQueryResults(){return this.m_rBindingList}get Loading(){return this.m_bLoading}set Loading(t){this.m_bLoading=t,t?(this.m_timeoutLoading&&clearTimeout(this.m_timeoutLoading),this.m_timeoutLoading=window.setTimeout(()=>{this.Loading=!1},1e4)):this.m_timeoutLoading&&clearTimeout(this.m_timeoutLoading)}IsSafeToResetControllerType(t,e){return this.m_State==n.AppSelect||this.m_State==n.None||"TrackedDeviceClass_HMD"==t&&"TrackedDeviceClass_Controller"==e&&this.m_State!=n.TrackerEdit}EditCurrentBinding(){this.m_State=n.EditBinding}ViewCurrentBinding(){this.m_State=n.ViewBinding}ShowBindingList(t){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,this.RefreshBindingList().then(()=>{this.SetBindingListError(t),this.Loading=!1,this.m_State=n.List}).catch(()=>{this.Loading=!1})}get CurrentBinding(){if(this.BindingQueryResults)return S.BindingQueryResults.find(t=>t.url==d.a.SelectedBindingURL)}ReturnToSettingsUI(){this.ShowAppSelect(),this.IsRunningInDashboard&&c.a.ShowSettingsUI()}ShowAppSelect(){this.m_bStandaloneSettingsPage=!1,this.Loading=!0,p.a.UpdateApplications().then(()=>{this.Loading=!1,this.m_State=n.AppSelect}).catch(()=>{this.Loading=!1})}ShowLegacyDebug(){this.m_State=n.LegacyDebugger}ShowControllerTester(){this.m_State=n.ControllerTester}UpdatePathsTimeout(){try{u.a.UpdatePaths().then(()=>{this.m_State==n.Debugger?this.m_pathUpdateTimer=window.setTimeout(this.UpdatePathsTimeout,500):this.m_pathUpdateTimer=void 0})}catch(t){console.log("Stopping debugger timer because",t)}}ShowDebugger(){this.Loading=!0,p.a.UpdateApplications().then(()=>{this.Loading=!1;let t=p.a.GetApp(d.a.SelectedApp);t&&t.client_container_handle&&u.a.AddSubscribedContainer(t.client_container_handle),this.m_State=n.Debugger,this.m_pathUpdateTimer=window.setTimeout(this.UpdatePathsTimeout,500)}).catch(()=>{this.Loading=!1})}ShowTrackerEdit(){this.m_State=n.TrackerEdit}ShowDisplaySettings(){this.m_State=n.DisplaySettings}ShouldShowBindingFailure(){return this.m_State!=n.TrackerEdit&&this.m_State!=n.DisplaySettings}RefreshBindingList(){return Object(o.a)(this,void 0,void 0,(function*(){this.Loading=!0,yield new Promise((t,e)=>{let i=d.a.SelectedControllerTypeInfo;d.a.QueryBindingList(d.a.SelectedApp,i?i.controller_type:"").then(e=>{e.success&&(this.m_rBindingList=e.results,this.Loading=!1,t())}).catch(()=>{this.Loading=!1})})}))}get IsRunningInDashboard(){return c.a.Environment()==l.VRHTMLEnvironment.Overlay}ShowActionManifestLoadFailed(t,e,i,n){let o=p.a.GetApp(t);this.m_sManifestError=Object(a.c)(e,o?o.name:t,i),this.m_sManifestErrorPath=n,this.m_bShowManifestError=!0,this.ShowAppSelect()}ManifestLoadErrorClose(){this.m_sManifestError=void 0,this.m_sManifestErrorPath=void 0,this.m_bShowManifestError=!1}get ShowManifestError(){return this.m_bShowManifestError}get ManifestError(){return this.m_sManifestError}get ManifestErrorPath(){return this.m_sManifestErrorPath}ShowActionOrigins(t,e,i){p.a.UpdateApplications().then(()=>{d.a.SetSelectedApp(t),e&&d.a.SetSelectedActionSet(e),S.ViewCurrentBinding(),c.a.ShowBindingUI(!this.IsRunningInDashboard)})}UpdateWindowTitle(){setTimeout(()=>{switch(this.GetUIState){case n.AppSelect:document.title=Object(a.c)("#BindingUI_WindowTitle_ControllerSettings");break;case n.Debugger:case n.EditBinding:case n.List:case n.None:case n.ViewBinding:document.title=Object(a.c)("#BindingUI_WindowTitle_ControllerBinding");break;case n.TrackerEdit:document.title=Object(a.c)("#BindingUI_WindowTitle_ManageTrackers");break;case n.DisplaySettings:document.title=Object(a.c)("#BindingUI_WindowTitle_DisplaySettings")}},0)}}Object(o.b)([r.m],h.prototype,"m_State",void 0),Object(o.b)([r.m],h.prototype,"m_bLoading",void 0),Object(o.b)([r.m],h.prototype,"m_rBindingList",void 0),Object(o.b)([r.m],h.prototype,"m_bShowBindingListError",void 0),Object(o.b)([r.m],h.prototype,"m_sBindingListError",void 0),Object(o.b)([r.m],h.prototype,"m_bShowManifestError",void 0),Object(o.b)([r.m],h.prototype,"m_sManifestError",void 0),Object(o.b)([r.m],h.prototype,"m_sManifestErrorPath",void 0),Object(o.b)([r.m],h.prototype,"m_bDesktopMode",void 0),Object(o.b)([s.bind],h.prototype,"OnShowTrackerUI",null),Object(o.b)([s.bind],h.prototype,"OnShowDisplaySettingsUI",null),Object(o.b)([s.bind],h.prototype,"OnShowAppSelect",null),Object(o.b)([s.bind],h.prototype,"OnShowAppBinding",null),Object(o.b)([s.bind],h.prototype,"OnTrackerBack",null),Object(o.b)([r.f],h.prototype,"ShouldShowTrackerBackButton",null),Object(o.b)([r.f],h.prototype,"DesktopMode",null),Object(o.b)([s.bind],h.prototype,"SetBindingListError",null),Object(o.b)([r.f],h.prototype,"ShowBindingListError",null),Object(o.b)([r.f],h.prototype,"BindingListError",null),Object(o.b)([s.bind],h.prototype,"OnPopState",null),Object(o.b)([s.bind],h.prototype,"GoBackPage",null),Object(o.b)([s.bind],h.prototype,"GoForwardPage",null),Object(o.b)([r.f],h.prototype,"GetUIState",null),Object(o.b)([r.f],h.prototype,"BindingQueryResults",null),Object(o.b)([r.f],h.prototype,"Loading",null),Object(o.b)([s.bind],h.prototype,"IsSafeToResetControllerType",null),Object(o.b)([s.bind],h.prototype,"EditCurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ViewCurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ShowBindingList",null),Object(o.b)([r.f],h.prototype,"CurrentBinding",null),Object(o.b)([s.bind],h.prototype,"ReturnToSettingsUI",null),Object(o.b)([s.bind],h.prototype,"ShowAppSelect",null),Object(o.b)([s.bind],h.prototype,"ShowLegacyDebug",null),Object(o.b)([s.bind],h.prototype,"ShowControllerTester",null),Object(o.b)([s.bind],h.prototype,"UpdatePathsTimeout",null),Object(o.b)([s.bind],h.prototype,"ShowDebugger",null),Object(o.b)([s.bind],h.prototype,"ShowTrackerEdit",null),Object(o.b)([s.bind],h.prototype,"ShowDisplaySettings",null),Object(o.b)([s.bind],h.prototype,"RefreshBindingList",null),Object(o.b)([r.f],h.prototype,"IsRunningInDashboard",null),Object(o.b)([r.d],h.prototype,"ShowActionManifestLoadFailed",null),Object(o.b)([r.d],h.prototype,"ManifestLoadErrorClose",null),Object(o.b)([r.f],h.prototype,"ShowManifestError",null),Object(o.b)([r.f],h.prototype,"ManifestError",null),Object(o.b)([r.f],h.prototype,"ManifestErrorPath",null),Object(o.b)([r.d],h.prototype,"ShowActionOrigins",null),Object(o.b)([s.bind],h.prototype,"UpdateWindowTitle",null);const S=new h;window.inputUI=S},tUsp:function(t,e,i){"use strict";i.d(e,"a",(function(){return d}));var n=i("mrSG"),o=i("7wIv"),s=i("vDqi"),r=i.n(s),l=i("2vnA");class c{constructor(){this.contents=l.m.map()}}Object(n.b)([l.m],c.prototype,"contents",void 0);class a{constructor(){this.m_Containers=l.m.map()}Init(){return Object(n.a)(this,void 0,void 0,(function*(){this.AddSubscribedContainer("25769803776"),yield this.UpdatePaths()}))}AddSubscribedContainer(t){if(!this.m_Containers.has(t)){let e=new c;e.handle=t,this.m_Containers.set(t,e)}}UpdateContainer(t,e){this.AddSubscribedContainer(t);let i=this.m_Containers.get(t);i.contents.clear(),e.entries.forEach(t=>{null!=t.path&&i.contents.set(t.path,t)})}QueryContainer(t){return Object(n.a)(this,void 0,void 0,(function*(){return new Promise((function(e,i){r.a.get("/properties.json?container="+t).then(i=>{e([t,i.data])}).catch(e=>{i([t,e])})}))}))}UpdatePaths(){return Object(n.a)(this,void 0,void 0,(function*(){let t=[];this.m_Containers.forEach(e=>{t.push(this.QueryContainer(e.handle))});try{(yield Promise.all(t)).forEach(t=>{2!=t.length?console.log("Failed to update container. ",t.length,"entries in array"):"string"==typeof t[1]?console.log("Failed to update container ",t[0],":",t[1]):this.UpdateContainer(t[0],t[1])})}catch(t){throw console.log(t),t}}))}GetAllActions(t){if(!this.m_Containers.has(t))return;let e=[];return this.m_Containers.get(t).contents.forEach(t=>{"k_unActionPropertyTag"==t.type&&null!=t.path&&e.push(t.path)}),e}GetActionValue(t,e){if(!this.m_Containers.has(t))return;let i=this.m_Containers.get(t);if(!i.contents.has(e))return;let n=i.contents.get(e);return"k_unActionPropertyTag"==n.type?n.value:void 0}GetAllInputValues(t){if(!this.m_Containers.has(t))return;let e=[];return this.m_Containers.get(t).contents.forEach(t=>{"k_unInputValuePropertyTag"==t.type&&null!=t.path&&e.push(t.path)}),e}GetInputValue(t,e){if(!this.m_Containers.has(t))return;let i=this.m_Containers.get(t);if(!i.contents.has(e))return;let n=i.contents.get(e);if("k_unInputValuePropertyTag"!=n.type)return;let o=n.value;return o.length<1?void 0:o[0]}GetScalarInputValue(t,e){let i=this.GetInputValue(t,e);return null==i||"scalar"!=i.type?0:i.value}GetBooleanInputValue(t,e){let i=this.GetInputValue(t,e);return null!=i&&"boolean"==i.type&&i.value}}Object(n.b)([l.m],a.prototype,"m_Containers",void 0),Object(n.b)([o.bind],a.prototype,"AddSubscribedContainer",null),Object(n.b)([l.d],a.prototype,"UpdateContainer",null),Object(n.b)([o.bind],a.prototype,"GetAllActions",null),Object(n.b)([o.bind],a.prototype,"GetActionValue",null),Object(n.b)([o.bind],a.prototype,"GetAllInputValues",null),Object(n.b)([o.bind],a.prototype,"GetInputValue",null),Object(n.b)([o.bind],a.prototype,"GetScalarInputValue",null),Object(n.b)([o.bind],a.prototype,"GetBooleanInputValue",null);const d=new a;window.paths=d},uFkT:function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var n=i("mrSG"),o=i("2vnA"),s=i("vDqi"),r=i.n(s),l=i("7wIv"),c=i("GXif"),a=i("EUJ1");class d{constructor(){this.m_InputState=void 0,this.m_KnownControllerTypes=o.m.map(),this.m_mailbox=new a.CVRMailbox,this.m_bUpdateInputStateOnControllerTypChange=!1}Init(t){return this.m_mailbox.Init("input_state"),this.m_mailbox.RegisterHandler("controller_type_changed",this.OnControllerTypeChanged),null!=t&&(this.m_bUpdateInputStateOnControllerTypChange=t),this.GetInputState()}OnControllerTypeChanged(t){this.UpdateControllerTypes(t.controller_types),this.m_InputState.controller_types=t.controller_types,this.m_bUpdateInputStateOnControllerTypChange&&this.GetInputState()}get ConnectedDevices(){return null==this.m_InputState?Array():this.m_InputState.devices.filter(t=>"TrackedDeviceClass_Controller"==t.class||"TrackedDeviceClass_HMD"==t.class||"TrackedDeviceClass_GenericTracker"==t.class)}get ControllerTypes(){return this.m_InputState.controller_types}get ShouldSendSystemButtonToAllApps(){return this.m_InputState.send_system_button_to_all_apps}get ShowHiddenInputs(){return this.m_InputState.show_hidden_inputs}get IsSteamAvailable(){return!this.m_InputState||this.m_InputState.is_steam_available}get BDevMode(){return this.m_InputState.dev_mode}get IsValid(){return null!=this.m_InputState}get CurrentUserPersonaName(){return this.m_InputState.current_user_persona_name?this.m_InputState.current_user_persona_name:null}GetControllerTypeInfo(t){return this.m_InputState.controller_types.find(e=>e.controller_type==t)}GetDeviceInfo(t){for(let e of this.m_InputState.devices)if(e.root_path==t)return e;return null}LocalizeControllerString(t,e){let i=Object(c.c)("#"+e);return i!="#"+e?i:t&&this.m_InputState&&this.m_InputState.localization.hasOwnProperty(t.resource_root)&&this.m_InputState.localization[t.resource_root].hasOwnProperty(e.toLowerCase())?this.m_InputState.localization[t.resource_root][e.toLowerCase()]:e}LocalizeDriverString(t,e){let i=Object(c.c)("#"+e);return i!="#"+e?i:this.m_InputState&&this.m_InputState.localization.hasOwnProperty(t)&&this.m_InputState.localization[t].hasOwnProperty(e.toLowerCase())?this.m_InputState.localization[t][e.toLowerCase()]:e}UpdateControllerTypes(t){this.m_KnownControllerTypes.clear();for(let e of t)this.m_KnownControllerTypes.set(e.controller_type,e)}GetInputState(){return Object(n.a)(this,void 0,void 0,(function*(){yield new Promise((function(t,e){r.a.get("/input/getstate.json").then(e=>{t(e.data)}).catch(t=>{e(t)})})).then(t=>{console.log("GetInputState: ",t);for(let e of t.controller_types)e.controller_type=e.controller_type.toLowerCase();for(let e of t.devices)e.controller_type=e.controller_type.toLowerCase();this.UpdateControllerTypes(t.controller_types),this.m_InputState=t})}))}get KnownControllerTypes(){return this.m_KnownControllerTypes}FindDeviceClassForControllerType(t){let e=this.GetControllerTypeInfo(t);return null==e?void 0:e.device_class}FindRootPathForControllerType(t){for(let e of this.m_InputState.devices)if(e.controller_type==t)return e.root_path;return null}}Object(n.b)([o.m],d.prototype,"m_InputState",void 0),Object(n.b)([o.m],d.prototype,"m_KnownControllerTypes",void 0),Object(n.b)([l.bind],d.prototype,"OnControllerTypeChanged",null),Object(n.b)([o.f],d.prototype,"ConnectedDevices",null),Object(n.b)([o.f],d.prototype,"ControllerTypes",null),Object(n.b)([o.f],d.prototype,"ShouldSendSystemButtonToAllApps",null),Object(n.b)([o.f],d.prototype,"ShowHiddenInputs",null),Object(n.b)([o.f],d.prototype,"IsSteamAvailable",null),Object(n.b)([o.f],d.prototype,"BDevMode",null),Object(n.b)([o.f],d.prototype,"IsValid",null),Object(n.b)([o.f],d.prototype,"CurrentUserPersonaName",null),Object(n.b)([l.bind],d.prototype,"GetControllerTypeInfo",null),Object(n.b)([l.bind],d.prototype,"LocalizeControllerString",null),Object(n.b)([l.bind],d.prototype,"LocalizeDriverString",null),Object(n.b)([o.d],d.prototype,"UpdateControllerTypes",null),Object(n.b)([o.d],d.prototype,"GetInputState",null),Object(n.b)([o.f],d.prototype,"KnownControllerTypes",null),Object(n.b)([l.bind],d.prototype,"FindDeviceClassForControllerType",null);const p=new d;window.inputState=p}}]);
//# sourceMappingURL=vrwebui_shared.js.map?v=363cdf5923fccd978805